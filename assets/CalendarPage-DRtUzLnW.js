import{d as $}from"./date-DciBzR65.js";import{a as T}from"./app-ClIdqLck.js";import{Q as S}from"./QIcon-BG2ghIIa.js";import{Q as b}from"./QInput-B89gap79.js";import{Q as F}from"./QChip-C9_Xp4gH.js";import{r as y,a as A,w as R,s as _,t as u,u as a,v as x,z as k,E as N,F as g,H as C,x as I,I as O,A as V,J as w,D as B,o as H,f as U,V as P,Q as L,R as Y}from"./index--aAVYWFs.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-t--hEgTQ.js";import"./render-CwP24QWp.js";import"./QSpinner-2fzAndR8.js";import"./focus-manager-TCf0o1SP.js";import"./use-dark-BXRXnZbt.js";import"./private.use-form-BeVvGjgZ.js";import"./Ripple-BZVUJLGQ.js";const q=(s,c)=>{const m=new Date(s,c+1,0).getDate();return Array.from({length:m},(p,r)=>{const i=new Date(s,c,r+1);return{date:i,dateFormat:$.formatDate(i,"DD | ddd"),events:[]}})},Q=s=>(s.title==="DEPARTAMENTO PROVEDOR DE ACESSIBILIDADE"?s.title="DEPAC":s.title==="SANTAS CEIAS"&&(s.desc=""),s),W=s=>s.charAt(0).toUpperCase()+s.slice(1).toLowerCase(),j={class:"print-hide row q-col-gutter-sm items-center"},z={class:"col-12 col-md-4"},K={class:"col-12 col-md-4 row justify-center"},G={class:"col-12 col-md-4 row justify-end"},J={__name:"EventFilter",props:{events:{type:Array,required:!0},filters:{type:Array}},emits:["update:filteredEvents","update:filters"],setup(s,{emit:c}){const m=s,p=c,r=y({text:"",filters:[]}),i=()=>{const t=r.value.text.trim();if(t){const n=t.startsWith("!")?"Não contém":"Contém",l=t.startsWith("!")?t.slice(1).trim():t;l.match(/Lista:/)?r.value.filters.push({text:"",list:l.replace("Lista:","").trim(),contem:n}):r.value.filters.push({text:l,list:"",contem:n}),r.value.text=""}},o=t=>{r.value.filters.splice(t,1)},d=t=>t.list?`Lista: ${t.list}`:`${t.contem}: "${t.text}"`,e=(t,n)=>{if(n.list&&n.list!==t.list)return!1;if(/[,|;| ou | e ]/.test(n.text)){const l=f=>{const E=n.text.toLowerCase().split(/[,;|]|(?:\s+ou\s+)|(?:\s+e\s+)/).map(h=>h.trim());return new RegExp(`(^|\\s)(${E.join("|")})`,"i").test(f.toLowerCase())};return[t.list,t.title,t.desc,t.locale].some(l)}else{const l=f=>n.text.toLowerCase().split(" ").every(h=>new RegExp(`(^|\\s)${h}`,"i").test(f.toLowerCase()));return[t.list,t.title,t.desc,t.locale].some(l)}},v=A(()=>r.value.filters.length===0?m.events:(p("update:filters",r.value.filters),m.events.filter(t=>r.value.filters.every(n=>n.contem==="Contém"?e(t,n):!e(t,n)))));R(v,t=>{p("update:filteredEvents",t)});const D=()=>{window.print()};return m.filters.forEach(t=>{r.value.text=t.text,i()}),(t,n)=>(u(),_("div",j,[a("div",z,[x(b,{dense:"",modelValue:r.value.text,"onUpdate:modelValue":n[0]||(n[0]=l=>r.value.text=l),class:"q-mx-sm",placeholder:"Filtrar",onKeydown:N(i,["enter"])},{append:k(()=>[x(S,{name:"search",onClick:i,class:"cursor-pointer"})]),_:1},8,["modelValue"])]),a("div",K,[(u(!0),_(g,null,C(r.value.filters,(l,f)=>(u(),I(F,{key:f,label:d(l),removable:"",dense:"",class:"q-px-sm",onRemove:E=>o(f)},null,8,["label","onRemove"]))),128))]),a("div",G,[x(S,{name:"print",onClick:n[1]||(n[1]=O(l=>D(),["prevent"])),class:"cursor-pointer text-blue-grey-8 q-mx-sm",size:"sm"})])]))}},X=M(J,[["__scopeId","data-v-d66d3682"]]),Z={class:"day-row"},tt={class:"items-start text-bold",style:{"padding-left":"6px"}},et=["onClick"],st=["innerHTML"],rt=["innerHTML"],nt={__name:"EventDay",props:{day:Object},setup(s){const c=V(),m=o=>o.title.replace(/DEPARTAMENTO PROVEDOR DE ACESSIBILIDADE/,"DEPAC"),p=o=>o.title==="SANTAS CEIAS"?"":o.desc.replace(/\n/g," / "),r=o=>{const d=new Date(o);return d.getHours()<6?"":`${d.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}&nbsp;`},i=o=>{c.push({path:`/event/edit/${o.id}`})};return(o,d)=>(u(),_("tr",Z,[a("td",tt,w(s.day.dateFormat),1),a("td",null,[(u(!0),_(g,null,C(s.day.events,e=>(u(),_("div",{key:e.gid,class:"event",onClick:v=>i(e)},[a("span",{class:"text-bold",innerHTML:r(e.date)},null,8,st),a("span",null,[a("i",null,w(m(e)),1)]),B(" "+w(e.locale)+" ",1),a("span",{innerHTML:p(e)},null,8,rt)],8,et))),128)),d[0]||(d[0]=a("div",{class:"event"}," ",-1))])]))}},ot=M(nt,[["__scopeId","data-v-344b8e84"]]),at={class:"month-section"},lt=["summary"],it={colspan:"2"},ct={__name:"EventMonth",props:{month:String,days:Array},setup(s){const c=s,m=W($.formatDate(new Date(c.month),"MMMM").toUpperCase()),p=y(!1),r=()=>{const i=document.querySelector(`thead[ref="header-${c.month}"]`);if(i){const o=i.getBoundingClientRect();p.value=o.top<0}};return H(()=>{window.addEventListener("scroll",r)}),U(()=>{window.removeEventListener("scroll",r)}),(i,o)=>(u(),_("div",at,[a("table",{summary:s.month},[a("thead",{ref:`header-${s.month}`,class:P({hidden:p.value})},[a("tr",null,[a("th",it,w(L(m)),1)])],2),a("tbody",null,[(u(!0),_(g,null,C(s.days,d=>(u(),I(ot,{key:d.date,day:d},null,8,["day"]))),128))])],8,lt)]))}},dt=M(ct,[["__scopeId","data-v-9e47aa68"]]),ut={class:"page"},mt={class:"print-hide text-h5 text-bold text-center"},pt={__name:"CalendarPage",setup(s){const c=Y(),m=y((c.query.filters||"").split("/").filter(e=>e.trim()).map(e=>({text:e.startsWith("!")?e.slice(1).trim():e.trim(),list:"",contem:e.startsWith("!")?"Não contém":"Contém"}))),p=y([]),r=A(()=>[...T.agenda.items].filter(e=>!["VIAGENS MISSIONÁRIAS","BATISMOS"].includes(e.title.toUpperCase())).filter(e=>new Date(e.date).getFullYear()===Number(c.params.ano)).sort((e,v)=>new Date(e.date)-new Date(v.date))),i=e=>{p.value=e},o=e=>{},d=A(()=>{const e=new Map;p.value.forEach(D=>{const t=$.formatDate(new Date(D.date),"YYYY-MM-01 12:00");e.has(t)||e.set(t,[]),e.get(t).push(Q({...D}))});const v=new Map;return e.forEach((D,t)=>{const n=new Date(t),l=q(n.getFullYear(),n.getMonth());l.forEach(f=>{f.events=D.filter(E=>{const h=new Date(E.date);return h.getDate()===f.date.getDate()&&h.getMonth()===f.date.getMonth()&&h.getFullYear()===f.date.getFullYear()}).sort((E,h)=>new Date(E.date)-new Date(h.date))}),v.set(t,l)}),Object.fromEntries(v)});return(e,v)=>(u(),_("div",ut,[a("h2",mt," Calendário "+w(L(c).params.ano),1),x(X,{events:r.value,filters:m.value,"onUpdate:filteredEvents":i,"onUpdate:filters":o},null,8,["events","filters"]),(u(!0),_(g,null,C(d.value,(D,t)=>(u(),I(dt,{key:t,month:t,days:D},null,8,["month","days"]))),128))]))}},It=M(pt,[["__scopeId","data-v-f256055d"]]);export{It as default};
