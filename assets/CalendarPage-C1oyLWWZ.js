import{d as $}from"./date-DCWuvFfM.js";import{a as T}from"./app-BgE5kJEg.js";import{r as y,a as A,w as b,B as _,C as u,D as o,E as g,H as F,T as L,L as k,K as x,N as C,F as I,O as N,z as R,P as w,J as O,o as B,k as V,a0 as H,Y as S,Z as P}from"./index-C1mdcgXU.js";import{Q as U}from"./QInput-Bkz8ypA4.js";import{Q as Y}from"./QChip-69i3ZQ2k.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./focus-manager-CahXY3Bh.js";import"./use-dark-C_h1aEkq.js";import"./private.use-form-BH8Wq6RR.js";const q=(r,c)=>{const m=new Date(r,c+1,0).getDate();return Array.from({length:m},(p,s)=>{const i=new Date(r,c,s+1);return{date:i,dateFormat:$.formatDate(i,"DD | ddd"),events:[]}})},W=r=>(r.title==="DEPARTAMENTO PROVEDOR DE ACESSIBILIDADE"?r.title="DEPAC":r.title==="SANTAS CEIAS"&&(r.desc=""),r),Q=r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase(),j={class:"print-hide row q-col-gutter-sm items-center"},z={class:"col-12 col-md-4"},K={class:"col-12 col-md-4 row justify-center"},G={class:"col-12 col-md-4 row justify-end"},J={__name:"EventFilter",props:{events:{type:Array,required:!0},filters:{type:Array}},emits:["update:filteredEvents","update:filters"],setup(r,{emit:c}){const m=r,p=c,s=y({text:"",filters:[]}),i=()=>{const t=s.value.text.trim();if(t){const n=t.startsWith("!")?"Não contém":"Contém",l=t.startsWith("!")?t.slice(1).trim():t;l.match(/Lista:/)?s.value.filters.push({text:"",list:l.replace("Lista:","").trim(),contem:n}):s.value.filters.push({text:l,list:"",contem:n}),s.value.text=""}},a=t=>{s.value.filters.splice(t,1)},d=t=>t.list?`Lista: ${t.list}`:`${t.contem}: "${t.text}"`,e=(t,n)=>{if(n.list&&n.list!==t.list)return!1;if(/[,|;| ou | e ]/.test(n.text)){const l=f=>{const E=n.text.toLowerCase().split(/[,;|]|(?:\s+ou\s+)|(?:\s+e\s+)/).map(h=>h.trim());return new RegExp(`(^|\\s)(${E.join("|")})`,"i").test(f.toLowerCase())};return[t.list,t.title,t.desc,t.locale].some(l)}else{const l=f=>n.text.toLowerCase().split(" ").every(h=>new RegExp(`(^|\\s)${h}`,"i").test(f.toLowerCase()));return[t.list,t.title,t.desc,t.locale].some(l)}},v=A(()=>s.value.filters.length===0?m.events:(p("update:filters",s.value.filters),m.events.filter(t=>s.value.filters.every(n=>n.contem==="Contém"?e(t,n):!e(t,n)))));b(v,t=>{p("update:filteredEvents",t)});const D=()=>{window.print()};return m.filters.forEach(t=>{s.value.text=t.text,i()}),(t,n)=>(u(),_("div",j,[o("div",z,[g(U,{dense:"",modelValue:s.value.text,"onUpdate:modelValue":n[0]||(n[0]=l=>s.value.text=l),class:"q-mx-sm",placeholder:"Filtrar",onKeydown:k(i,["enter"])},{append:F(()=>[g(L,{name:"search",onClick:i,class:"cursor-pointer"})]),_:1},8,["modelValue"])]),o("div",K,[(u(!0),_(x,null,C(s.value.filters,(l,f)=>(u(),I(Y,{key:f,label:d(l),removable:"",dense:"",class:"q-px-sm",onRemove:E=>a(f)},null,8,["label","onRemove"]))),128))]),o("div",G,[g(L,{name:"print",onClick:n[1]||(n[1]=N(l=>D(),["prevent"])),class:"cursor-pointer text-blue-grey-8 q-mx-sm",size:"sm"})])]))}},Z=M(J,[["__scopeId","data-v-d66d3682"]]),X={class:"day-row"},tt={class:"items-start text-bold",style:{"padding-left":"6px"}},et=["onClick"],st=["innerHTML"],rt=["innerHTML"],nt={__name:"EventDay",setup(r){const c=R(),m=a=>a.title.replace(/DEPARTAMENTO PROVEDOR DE ACESSIBILIDADE/,"DEPAC"),p=a=>a.title==="SANTAS CEIAS"?"":a.desc.replace(/\n/g," / "),s=a=>{const d=new Date(a);return d.getHours()<6?"":`${d.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}&nbsp;`},i=a=>{c.push({path:`/event/edit/${a.id}`})};return(a,d)=>(u(),_("tr",X,[o("td",tt,w(a.day.dateFormat),1),o("td",null,[(u(!0),_(x,null,C(a.day.events,e=>(u(),_("div",{key:e.gid,class:"event",onClick:v=>i(e)},[o("span",{class:"text-bold",innerHTML:s(e.date)},null,8,st),o("span",null,[o("i",null,w(m(e)),1)]),O(" "+w(e.locale)+" ",1),o("span",{innerHTML:p(e)},null,8,rt)],8,et))),128)),d[0]||(d[0]=o("div",{class:"event"}," ",-1))])]))}},at=M(nt,[["__scopeId","data-v-31b34173"]]),ot={class:"month-section"},lt=["summary"],it={colspan:"2"},ct={__name:"EventMonth",props:{month:String,days:Array},setup(r){const c=r,m=Q($.formatDate(new Date(c.month),"MMMM").toUpperCase()),p=y(!1),s=()=>{const i=document.querySelector(`thead[ref="header-${c.month}"]`);if(i){const a=i.getBoundingClientRect();p.value=a.top<0}};return B(()=>{window.addEventListener("scroll",s)}),V(()=>{window.removeEventListener("scroll",s)}),(i,a)=>(u(),_("div",ot,[o("table",{summary:r.month},[o("thead",{ref:`header-${r.month}`,class:H({hidden:p.value})},[o("tr",null,[o("th",it,w(S(m)),1)])],2),o("tbody",null,[(u(!0),_(x,null,C(r.days,d=>(u(),I(at,{key:d.date,day:d},null,8,["day"]))),128))])],8,lt)]))}},dt=M(ct,[["__scopeId","data-v-9e47aa68"]]),ut={class:"page"},mt={class:"print-hide text-h5 text-bold text-center"},pt={__name:"CalendarPage",setup(r){const c=P(),m=y((c.query.filters||"").split("/").filter(e=>e.trim()).map(e=>({text:e.startsWith("!")?e.slice(1).trim():e.trim(),list:"",contem:e.startsWith("!")?"Não contém":"Contém"}))),p=y([]),s=A(()=>[...T.agenda.items].filter(e=>!["VIAGENS MISSIONÁRIAS","BATISMOS"].includes(e.title.toUpperCase())).filter(e=>new Date(e.date).getFullYear()===Number(c.params.ano)).sort((e,v)=>new Date(e.date)-new Date(v.date))),i=e=>{p.value=e},a=e=>{},d=A(()=>{const e=new Map;p.value.forEach(D=>{const t=$.formatDate(new Date(D.date),"YYYY-MM-01 12:00");e.has(t)||e.set(t,[]),e.get(t).push(W({...D}))});const v=new Map;return e.forEach((D,t)=>{const n=new Date(t),l=q(n.getFullYear(),n.getMonth());l.forEach(f=>{f.events=D.filter(E=>{const h=new Date(E.date);return h.getDate()===f.date.getDate()&&h.getMonth()===f.date.getMonth()&&h.getFullYear()===f.date.getFullYear()}).sort((E,h)=>new Date(E.date)-new Date(h.date))}),v.set(t,l)}),Object.fromEntries(v)});return(e,v)=>(u(),_("div",ut,[o("h2",mt," Calendário "+w(S(c).params.ano),1),g(Z,{events:s.value,filters:m.value,"onUpdate:filteredEvents":i,"onUpdate:filters":a},null,8,["events","filters"]),(u(!0),_(x,null,C(d.value,(D,t)=>(u(),I(dt,{key:t,month:t,days:D},null,8,["month","days"]))),128))]))}},xt=M(pt,[["__scopeId","data-v-f256055d"]]);export{xt as default};
