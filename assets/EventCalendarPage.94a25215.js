import{d as b}from"./date.d731b045.js";import{b as $}from"./app.e061d90f.js";import{r as M,a as y,w as F,B as u,C as v,D as l,E as A,J as I,Q as S,ac as R,K as x,ad as w,G as L,at as k,ae as g,M as N,F as T,au as P}from"./index.fb664e78.js";import{Q as O}from"./QInput.9b078dda.js";import{Q as V}from"./QChip.1e392b89.js";import{_ as C}from"./plugin-vue_export-helper.21dcd24c.js";import"./focus-manager.36e9374e.js";import"./use-dark.78468f61.js";const Y=(a,i)=>{const c=new Date(a,i+1,0).getDate();return Array.from({length:c},(p,r)=>{const d=new Date(a,i,r+1);return{date:d,dateFormat:b.formatDate(d,"DD | ddd"),events:[]}})},B=a=>(a.title==="DEPARTAMENTO PROVEDOR DE ACESSIBILIDADE"?a.title="DEPAC":a.title==="SANTAS CEIAS"&&(a.desc=""),a),U=a=>a.charAt(0).toUpperCase()+a.slice(1).toLowerCase();const W={class:"print-hide fixed-bottom z-top menu flex flex-center space-between"},q={class:"row flex-center"},Q={__name:"EventFilter",props:{events:{type:Array,required:!0},filters:{type:Array}},emits:["update:filteredEvents","update:filters"],setup(a,{emit:i}){const c=a,p=i,r=M({text:"",filters:[]}),d=y(()=>[...new Set(c.events.map(s=>s.title))].filter(s=>s.toLowerCase().includes(r.value.text.toLowerCase()))),n=()=>{const e=r.value.text.trim();if(e){const s=e.startsWith("!")?"N\xE3o cont\xE9m":"Cont\xE9m",o=e.startsWith("!")?e.slice(1).trim():e;o.match(/Lista:/)?r.value.filters.push({text:"",list:o.replace("Lista:","").trim(),contem:s}):r.value.filters.push({text:o,list:"",contem:s}),r.value.text=""}},_=e=>{r.value.filters.splice(e,1)},t=e=>`${e.contem}: "${e.text||e.list}"`,E=(e,s)=>{if(s.list&&s.list!==e.list)return!1;if(/[,|;| ou | e ]/.test(s.text)){const o=m=>{const D=s.text.toLowerCase().split(/[,;|]|(?:\s+ou\s+)|(?:\s+e\s+)/).map(f=>f.trim());return new RegExp(`(^|\\s)(${D.join("|")})`,"i").test(m.toLowerCase())};return[e.list,e.title,e.desc,e.locale].some(o)}else{const o=m=>s.text.toLowerCase().split(" ").every(f=>new RegExp(`(^|\\s)${f}`,"i").test(m.toLowerCase()));return[e.list,e.title,e.desc,e.locale].some(o)}},h=y(()=>r.value.filters.length===0?c.events:(p("update:filters",r.value.filters),c.events.filter(e=>r.value.filters.every(s=>s.contem==="Cont\xE9m"?E(e,s):!E(e,s)))));return F(h,e=>{p("update:filteredEvents",e)}),c.filters.forEach(e=>{r.value.text=e.text,n()}),(e,s)=>(u(),v(x,null,[l("div",W,[A(O,{modelValue:r.value.text,"onUpdate:modelValue":s[0]||(s[0]=o=>r.value.text=o),label:"Pesquisar",dense:"",clearable:"",onKeydown:R(n,["enter"]),suggestions:d.value,style:{width:"100%"}},{append:I(()=>[A(S,{name:"search",onClick:n,class:"cursor-pointer"})]),_:1},8,["modelValue","suggestions"])]),l("div",q,[(u(!0),v(x,null,w(r.value.filters,(o,m)=>(u(),L(V,{key:m,label:t(o),removable:"",dense:"",class:"q-px-sm",onRemove:D=>_(m)},null,8,["label","onRemove"]))),128))])],64))}};var H=C(Q,[["__scopeId","data-v-f15533e8"]]);const j={class:"day-row"},K={class:"items-start text-bold"},z=["onClick"],G=["innerHTML"],J=["innerHTML"],X={__name:"EventDay",props:{day:Object},setup(a){const i=k(),c=n=>n.title.replace(/DEPARTAMENTO PROVEDOR DE ACESSIBILIDADE/,"DEPAC"),p=n=>n.title==="SANTAS CEIAS"?"":n.desc,r=n=>{const _=new Date(n);return _.getHours()<6?"":`${_.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}&nbsp;`},d=n=>{i.push({path:`/event/edit/${n.id}`})};return(n,_)=>(u(),v("tr",j,[l("td",K,g(a.day.dateFormat),1),l("td",null,[(u(!0),v(x,null,w(a.day.events,t=>(u(),v("div",{key:t.gid,class:"event",onClick:E=>d(t)},[l("span",{class:"text-bold",innerHTML:r(t.date)},null,8,G),l("i",null,g(c(t)),1),N(": "+g(t.locale)+" ",1),l("span",{innerHTML:p(t)},null,8,J)],8,z))),128)),_[0]||(_[0]=l("div",{class:"event"},"\xA0",-1))])]))}};var Z=C(X,[["__scopeId","data-v-fb885e1e"]]);const ee={class:"month-section"},te=["summary"],se={colspan:"2"},ae={__name:"EventMonth",props:{month:String,days:Array},setup(a){const i=a,c=U(b.formatDate(new Date(i.month),"MMMM").toUpperCase());return(p,r)=>(u(),v("div",ee,[l("table",{summary:a.month},[l("thead",null,[l("tr",null,[l("th",se,g(T(c)),1)])]),l("tbody",null,[(u(!0),v(x,null,w(a.days,d=>(u(),L(Z,{key:d.date,day:d},null,8,["day"]))),128))])],8,te)]))}};var re=C(ae,[["__scopeId","data-v-491e6270"]]);const ne={class:"page"},oe={class:"text-h5 text-bold text-center"},le={__name:"EventCalendarPage",setup(a){const i=P(),c=M((i.query.filters||"").split("/").filter(t=>t.trim()).map(t=>({text:t.startsWith("!")?t.slice(1).trim():t.trim(),list:"",contem:t.startsWith("!")?"N\xE3o cont\xE9m":"Cont\xE9m"}))),p=M([]),r=y(()=>[...$.agenda.items].filter(t=>new Date(t.date).getFullYear()===Number(i.params.ano))),d=t=>{p.value=t},n=t=>{},_=y(()=>{const t=new Map;p.value.forEach(h=>{const e=b.formatDate(new Date(h.date),"YYYY-MM-01 12:00");t.has(e)||t.set(e,[]),t.get(e).push(B({...h}))});const E=new Map;return t.forEach((h,e)=>{const s=new Date(e),o=Y(s.getFullYear(),s.getMonth());o.forEach(m=>{m.events=h.filter(D=>{const f=new Date(D.date);return f.getDate()===m.date.getDate()&&f.getMonth()===m.date.getMonth()&&f.getFullYear()===m.date.getFullYear()}).sort((D,f)=>new Date(D.date)-new Date(f.date))}),E.set(e,o)}),Object.fromEntries(E)});return(t,E)=>(u(),v("div",ne,[l("h2",oe," Calend\xE1rio "+g(T(i).params.ano),1),A(H,{events:r.value,filters:c.value,"onUpdate:filteredEvents":d,"onUpdate:filters":n},null,8,["events","filters"]),(u(!0),v(x,null,w(_.value,(h,e)=>(u(),L(re,{key:e,month:e,days:h},null,8,["month","days"]))),128))]))}};var ve=C(le,[["__scopeId","data-v-6271878d"]]);export{ve as default};
