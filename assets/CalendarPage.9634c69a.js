import{d as L}from"./date.d409f60d.js";import{b as I}from"./app.5e10c4f6.js";import{x as w,f as g,w as S,H as m,P as v,L as o,K as x,J as F,a2 as T,al as k,S as C,am as M,I as A,an as R,N,ao as E,U as P,o as q,m as H,aG as O,aD as b,M as U}from"./index.6bbe9e43.js";import{Q as V}from"./QInput.f1c2052f.js";import{Q as B}from"./QChip.ce8ab151.js";import{_ as $}from"./plugin-vue_export-helper.21dcd24c.js";import"./focus-manager.3f7d304d.js";import"./use-dark.9e1163b4.js";import"./private.use-form.b9037b95.js";const Y=(a,c)=>{const d=new Date(a,c+1,0).getDate();return Array.from({length:d},(p,r)=>{const i=new Date(a,c,r+1);return{date:i,dateFormat:L.formatDate(i,"DD | ddd"),events:[]}})},W=a=>(a.title==="DEPARTAMENTO PROVEDOR DE ACESSIBILIDADE"?a.title="DEPAC":a.title==="SANTAS CEIAS"&&(a.desc=""),a),j=a=>a.charAt(0).toUpperCase()+a.slice(1).toLowerCase();const Q={class:"print-hide row q-col-gutter-sm items-center"},z={class:"col-12 col-md-4"},K={class:"col-12 col-md-4 row justify-center"},G={class:"col-12 col-md-4 row justify-end"},J={__name:"EventFilter",props:{events:{type:Array,required:!0},filters:{type:Array}},emits:["update:filteredEvents","update:filters"],setup(a,{emit:c}){const d=a,p=c,r=w({text:"",filters:[]});g(()=>[...new Set(d.events.map(s=>s.title))].filter(s=>s.toLowerCase().includes(r.value.text.toLowerCase())));const i=()=>{const e=r.value.text.trim();if(e){const s=e.startsWith("!")?"N\xE3o cont\xE9m":"Cont\xE9m",l=e.startsWith("!")?e.slice(1).trim():e;l.match(/Lista:/)?r.value.filters.push({text:"",list:l.replace("Lista:","").trim(),contem:s}):r.value.filters.push({text:l,list:"",contem:s}),r.value.text=""}},n=e=>{r.value.filters.splice(e,1)},u=e=>e.list?`Lista: ${e.list}`:`${e.contem}: "${e.text}"`,t=(e,s)=>{if(s.list&&s.list!==e.list)return!1;if(/[,|;| ou | e ]/.test(s.text)){const l=_=>{const D=s.text.toLowerCase().split(/[,;|]|(?:\s+ou\s+)|(?:\s+e\s+)/).map(f=>f.trim());return new RegExp(`(^|\\s)(${D.join("|")})`,"i").test(_.toLowerCase())};return[e.list,e.title,e.desc,e.locale].some(l)}else{const l=_=>s.text.toLowerCase().split(" ").every(f=>new RegExp(`(^|\\s)${f}`,"i").test(_.toLowerCase()));return[e.list,e.title,e.desc,e.locale].some(l)}},h=g(()=>r.value.filters.length===0?d.events:(p("update:filters",r.value.filters),d.events.filter(e=>r.value.filters.every(s=>s.contem==="Cont\xE9m"?t(e,s):!t(e,s)))));S(h,e=>{p("update:filteredEvents",e)});const y=()=>{window.print()};return d.filters.forEach(e=>{r.value.text=e.text,i()}),(e,s)=>(m(),v("div",Q,[o("div",z,[x(V,{dense:"",modelValue:r.value.text,"onUpdate:modelValue":s[0]||(s[0]=l=>r.value.text=l),class:"q-mx-sm",placeholder:"Filtrar",onKeydown:k(i,["enter"])},{append:F(()=>[x(T,{name:"search",onClick:i,class:"cursor-pointer"})]),_:1},8,["modelValue"])]),o("div",K,[(m(!0),v(C,null,M(r.value.filters,(l,_)=>(m(),A(B,{key:_,label:u(l),removable:"",dense:"",class:"q-px-sm",onRemove:D=>n(_)},null,8,["label","onRemove"]))),128))]),o("div",G,[x(T,{name:"print",onClick:s[1]||(s[1]=R(l=>y(),["prevent"])),class:"cursor-pointer text-blue-grey-8 q-mx-sm",size:"sm"})])]))}};var X=$(J,[["__scopeId","data-v-406a93bf"]]);const Z={class:"day-row"},ee={class:"items-start text-bold",style:{"padding-left":"6px"}},te=["onClick"],se=["innerHTML"],ae=["innerHTML"],re={__name:"EventDay",props:{day:Object},setup(a){const c=N(),d=n=>n.title.replace(/DEPARTAMENTO PROVEDOR DE ACESSIBILIDADE/,"DEPAC"),p=n=>n.title==="SANTAS CEIAS"?"":n.desc,r=n=>{const u=new Date(n);return u.getHours()<6?"":`${u.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}&nbsp;`},i=n=>{c.push({path:`/event/edit/${n.id}`})};return(n,u)=>(m(),v("tr",Z,[o("td",ee,E(a.day.dateFormat),1),o("td",null,[(m(!0),v(C,null,M(a.day.events,t=>(m(),v("div",{key:t.gid,class:"event",onClick:h=>i(t)},[o("span",{class:"text-bold",innerHTML:r(t.date)},null,8,se),o("span",null,[o("i",null,E(d(t)),1)]),P(" "+E(t.locale)+" ",1),o("span",{innerHTML:p(t)},null,8,ae)],8,te))),128)),u[0]||(u[0]=o("div",{class:"event"},"\xA0",-1))])]))}};var ne=$(re,[["__scopeId","data-v-dec6a0c2"]]);const oe={class:"month-section"},le=["summary"],ie={colspan:"2"},ce={__name:"EventMonth",props:{month:String,days:Array},setup(a){const c=a,d=j(L.formatDate(new Date(c.month),"MMMM").toUpperCase()),p=w(!1),r=()=>{const i=document.querySelector(`thead[ref="header-${c.month}"]`);if(i){const n=i.getBoundingClientRect();p.value=n.top<0}};return q(()=>{window.addEventListener("scroll",r)}),H(()=>{window.removeEventListener("scroll",r)}),(i,n)=>(m(),v("div",oe,[o("table",{summary:a.month},[o("thead",{ref:`header-${a.month}`,class:O({hidden:p.value})},[o("tr",null,[o("th",ie,E(b(d)),1)])],2),o("tbody",null,[(m(!0),v(C,null,M(a.days,u=>(m(),A(ne,{key:u.date,day:u},null,8,["day"]))),128))])],8,le)]))}};var de=$(ce,[["__scopeId","data-v-cad42384"]]);const ue={class:"page"},me={class:"text-h5 text-bold text-center"},pe={__name:"CalendarPage",setup(a){const c=U(),d=w((c.query.filters||"").split("/").filter(t=>t.trim()).map(t=>({text:t.startsWith("!")?t.slice(1).trim():t.trim(),list:"",contem:t.startsWith("!")?"N\xE3o cont\xE9m":"Cont\xE9m"}))),p=w([]),r=g(()=>[...I.agenda.items].filter(t=>new Date(t.date).getFullYear()===Number(c.params.ano)).sort((t,h)=>new Date(t.date)-new Date(h.date))),i=t=>{p.value=t},n=t=>{},u=g(()=>{const t=new Map;p.value.forEach(y=>{const e=L.formatDate(new Date(y.date),"YYYY-MM-01 12:00");t.has(e)||t.set(e,[]),t.get(e).push(W({...y}))});const h=new Map;return t.forEach((y,e)=>{const s=new Date(e),l=Y(s.getFullYear(),s.getMonth());l.forEach(_=>{_.events=y.filter(D=>{const f=new Date(D.date);return f.getDate()===_.date.getDate()&&f.getMonth()===_.date.getMonth()&&f.getFullYear()===_.date.getFullYear()}).sort((D,f)=>new Date(D.date)-new Date(f.date))}),h.set(e,l)}),Object.fromEntries(h)});return(t,h)=>(m(),v("div",ue,[o("h2",me," Calend\xE1rio "+E(b(c).params.ano),1),x(X,{events:r.value,filters:d.value,"onUpdate:filteredEvents":i,"onUpdate:filters":n},null,8,["events","filters"]),(m(!0),v(C,null,M(u.value,(y,e)=>(m(),A(de,{key:e,month:e,days:y},null,8,["month","days"]))),128))]))}};var ge=$(pe,[["__scopeId","data-v-178ce599"]]);export{ge as default};
