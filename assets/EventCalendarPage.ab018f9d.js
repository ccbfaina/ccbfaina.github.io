import{d as b}from"./date.c411b5c2.js";import{b as I}from"./app.2e912f62.js";import{r as $,a as w,w as S,B as u,C as h,D as o,E as x,J as k,Q as T,ac as N,N as R,K as D,ad as C,G as L,at as P,ae as y,M as q,F,au as O}from"./index.948c580c.js";import{Q as V}from"./QInput.9cb2f65c.js";import{Q as Y}from"./QChip.4d030ee1.js";import{_ as M}from"./plugin-vue_export-helper.21dcd24c.js";import"./focus-manager.8a0d831d.js";import"./use-dark.861016f4.js";const B=(r,i)=>{const c=new Date(r,i+1,0).getDate();return Array.from({length:c},(_,a)=>{const d=new Date(r,i,a+1);return{date:d,dateFormat:b.formatDate(d,"DD | ddd"),events:[]}})},U=r=>(r.title==="DEPARTAMENTO PROVEDOR DE ACESSIBILIDADE"?r.title="DEPAC":r.title==="SANTAS CEIAS"&&(r.desc=""),r),W=r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase();const Q={class:"print-hide fixed-bottom z-top menu"},H={class:"row items-center no-wrap"},j={class:"q-pl-sm q-pr-sm"},z={class:"row flex-center"},K={__name:"EventFilter",props:{events:{type:Array,required:!0},filters:{type:Array}},emits:["update:filteredEvents","update:filters"],setup(r,{emit:i}){const c=r,_=i,a=$({text:"",filters:[]}),d=w(()=>[...new Set(c.events.map(s=>s.title))].filter(s=>s.toLowerCase().includes(a.value.text.toLowerCase()))),l=()=>{const t=a.value.text.trim();if(t){const s=t.startsWith("!")?"N\xE3o cont\xE9m":"Cont\xE9m",n=t.startsWith("!")?t.slice(1).trim():t;n.match(/Lista:/)?a.value.filters.push({text:"",list:n.replace("Lista:","").trim(),contem:s}):a.value.filters.push({text:n,list:"",contem:s}),a.value.text=""}},v=t=>{a.value.filters.splice(t,1)},e=t=>`${t.contem}: "${t.text||t.list}"`,g=(t,s)=>{if(s.list&&s.list!==t.list)return!1;if(/[,|;| ou | e ]/.test(s.text)){const n=p=>{const f=s.text.toLowerCase().split(/[,;|]|(?:\s+ou\s+)|(?:\s+e\s+)/).map(A=>A.trim());return new RegExp(`(^|\\s)(${f.join("|")})`,"i").test(p.toLowerCase())};return[t.list,t.title,t.desc,t.locale].some(n)}else{const n=p=>s.text.toLowerCase().split(" ").every(A=>new RegExp(`(^|\\s)${A}`,"i").test(p.toLowerCase()));return[t.list,t.title,t.desc,t.locale].some(n)}},E=w(()=>a.value.filters.length===0?c.events:(_("update:filters",a.value.filters),c.events.filter(t=>a.value.filters.every(s=>s.contem==="Cont\xE9m"?g(t,s):!g(t,s)))));S(E,t=>{_("update:filteredEvents",t)});const m=()=>{window.print()};return c.filters.forEach(t=>{a.value.text=t.text,l()}),(t,s)=>(u(),h(D,null,[o("div",Q,[o("div",H,[x(V,{modelValue:a.value.text,"onUpdate:modelValue":s[0]||(s[0]=n=>a.value.text=n),label:"Pesquisar",dense:"",clearable:"",onKeydown:N(l,["enter"]),suggestions:d.value,style:{width:"100%"},class:"q-ml-md"},{append:k(()=>[x(T,{name:"search",onClick:l,class:"cursor-pointer"})]),_:1},8,["modelValue","suggestions"]),o("div",j,[x(T,{name:"print",onClick:s[1]||(s[1]=R(n=>m(),["prevent"])),class:"cursor-pointer text-blue-grey-8",size:"sm"})])])]),o("div",z,[(u(!0),h(D,null,C(a.value.filters,(n,p)=>(u(),L(Y,{key:p,label:e(n),removable:"",dense:"",class:"q-px-sm",onRemove:f=>v(p)},null,8,["label","onRemove"]))),128))])],64))}};var G=M(K,[["__scopeId","data-v-99f9d670"]]);const J={class:"day-row"},X={class:"items-start text-bold"},Z=["onClick"],tt=["innerHTML"],et=["innerHTML"],st={__name:"EventDay",props:{day:Object},setup(r){const i=P(),c=l=>l.title.replace(/DEPARTAMENTO PROVEDOR DE ACESSIBILIDADE/,"DEPAC"),_=l=>l.title==="SANTAS CEIAS"?"":l.desc,a=l=>{const v=new Date(l);return v.getHours()<6?"":`${v.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}&nbsp;`},d=l=>{i.push({path:`/event/edit/${l.id}`})};return(l,v)=>(u(),h("tr",J,[o("td",X,y(r.day.dateFormat),1),o("td",null,[(u(!0),h(D,null,C(r.day.events,e=>(u(),h("div",{key:e.gid,class:"event",onClick:g=>d(e)},[o("span",{class:"text-bold",innerHTML:a(e.date)},null,8,tt),o("i",null,y(c(e)),1),q(": "+y(e.locale)+" ",1),o("span",{innerHTML:_(e)},null,8,et)],8,Z))),128)),v[0]||(v[0]=o("div",{class:"event"},"\xA0",-1))])]))}};var rt=M(st,[["__scopeId","data-v-fb885e1e"]]);const at={class:"month-section"},nt=["summary"],ot={colspan:"2"},lt={__name:"EventMonth",props:{month:String,days:Array},setup(r){const i=r,c=W(b.formatDate(new Date(i.month),"MMMM").toUpperCase());return(_,a)=>(u(),h("div",at,[o("table",{summary:r.month},[o("thead",null,[o("tr",null,[o("th",ot,y(F(c)),1)])]),o("tbody",null,[(u(!0),h(D,null,C(r.days,d=>(u(),L(rt,{key:d.date,day:d},null,8,["day"]))),128))])],8,nt)]))}};var it=M(lt,[["__scopeId","data-v-491e6270"]]);const ct={class:"page"},ut={class:"text-h5 text-bold text-center"},dt={__name:"EventCalendarPage",setup(r){const i=O(),c=$((i.query.filters||"").split("/").filter(e=>e.trim()).map(e=>({text:e.startsWith("!")?e.slice(1).trim():e.trim(),list:"",contem:e.startsWith("!")?"N\xE3o cont\xE9m":"Cont\xE9m"}))),_=$([]),a=w(()=>[...I.agenda.items].filter(e=>new Date(e.date).getFullYear()===Number(i.params.ano))),d=e=>{_.value=e},l=e=>{},v=w(()=>{const e=new Map;_.value.forEach(E=>{const m=b.formatDate(new Date(E.date),"YYYY-MM-01 12:00");e.has(m)||e.set(m,[]),e.get(m).push(U({...E}))});const g=new Map;return e.forEach((E,m)=>{const t=new Date(m),s=B(t.getFullYear(),t.getMonth());s.forEach(n=>{n.events=E.filter(p=>{const f=new Date(p.date);return f.getDate()===n.date.getDate()&&f.getMonth()===n.date.getMonth()&&f.getFullYear()===n.date.getFullYear()}).sort((p,f)=>new Date(p.date)-new Date(f.date))}),g.set(m,s)}),Object.fromEntries(g)});return(e,g)=>(u(),h("div",ct,[o("h2",ut," Calend\xE1rio "+y(F(i).params.ano),1),x(G,{events:a.value,filters:c.value,"onUpdate:filteredEvents":d,"onUpdate:filters":l},null,8,["events","filters"]),(u(!0),h(D,null,C(v.value,(E,m)=>(u(),L(it,{key:m,month:m,days:E},null,8,["month","days"]))),128))]))}};var yt=M(dt,[["__scopeId","data-v-6271878d"]]);export{yt as default};
