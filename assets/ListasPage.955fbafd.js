import{K as B,V as O,F as l,B as d,C as h,D as a,ae as _,as as A,L as N,G as k,W as $,H as S,r as Q,a as z,w as I,E as b,J as E,at as H,au as W,x as F,o as K,y as Y,A as G,av as j,I as J,ad as L,ac as M,Q as X}from"./index.75525dbe.js";import{b as u,a as Z}from"./app.0f814304.js";import{T as ee}from"./Tag.e61372a0.js";import{Q as te}from"./QDate.d7161a75.js";import{_ as P}from"./plugin-vue_export-helper.21dcd24c.js";import"./use-dark.4e6164ab.js";const oe=["innerHTML"],ae={__name:"ListaTRComponent",props:{event:{type:Object,required:!0}},setup(T){const D=T,{event:n}=D;function e(t){return R(t.date)&&!["AVISOS \xC0 IRMANDADE"].includes(t.title.toUpperCase())}function c(t){return e(t)&&!["VIAGENS MISSION\xC1RIAS"].includes(t.title.toUpperCase())}function w(t){return t.replace(/(\r\n|\n|\r)/g,"<br>")}function g(t){return!(t instanceof Date)||isNaN(t.getTime())?"":["Dom","Seg","Ter","Qua","Qui","Sex","S\xE1b"][t.getDay()]||""}function r(t){return!(t instanceof Date)||isNaN(t.getTime())?"":String(t.getDate()).padStart(2,"0")}function y(t){return!(t instanceof Date)||isNaN(t.getTime())?"":String(t.getMonth()+1).padStart(2,"0")}function C(t){if(!(t instanceof Date)||isNaN(t.getTime()))return"";const x=String(t.getHours()).padStart(2,"0"),v=String(t.getMinutes()).padStart(2,"0");return`${x}:${v}`}function R(t){return t instanceof Date&&!isNaN(t.getTime())}return(t,x)=>{var v,o;return B((d(),h("tr",null,[a("td",{style:A(e(l(n))?"":"display: none;")},[a("b",null,_(r(l(n).date))+"/"+_(y(l(n).date)),1)],4),a("td",{style:A(e(l(n))?"":"display: none;")},_(g(l(n).date)),5),a("td",{style:A(c(l(n))?"":"display: none;")},_(C(l(n).date)),5),a("td",null,[N(_(l(n).locale)+" ",1),((v=l(n))==null?void 0:v.recurring)&&((o=l(n))==null?void 0:o.recurring.length)?(d(),k($,{key:0,class:"print-hide",name:"event_repeat",style:{color:"#9e9e9e"}})):S("",!0)]),l(n).desc?(d(),h("td",{key:0,innerHTML:w(l(n).desc)},null,8,oe)):S("",!0)],512)),[[O,l(n).title||l(n).locale||l(n).desc]])}}};const ne={class:"row flex-center text-grey-5"},re={class:"row flex-center"},se={__name:"DateRangeSelector",props:{from:{type:String,default:""},to:{type:String,default:""}},emits:["update"],setup(T,{emit:D}){const n=T,e=D,c=Q({from:n.from,to:n.to}),w=z(()=>`${g(c.value.from)} \xE0 ${g(c.value.to)}`),g=r=>r?r.split("-").reverse().join("/"):"";return I(()=>[n.from,n.to],([r,y])=>{c.value={from:r,to:y}}),I(c,r=>{((r==null?void 0:r.from)!==n.from||(r==null?void 0:r.to)!==n.to)&&(r!=null&&r.to?e("update",r):e("update",{from:r,to:r}))}),(r,y)=>(d(),h(E,null,[a("div",ne,_(w.value),1),a("div",re,[b(te,{modelValue:c.value,"onUpdate:modelValue":y[0]||(y[0]=C=>c.value=C),mask:"YYYY-MM-DD",range:"",minimal:""},null,8,["modelValue"])])],64))}};var ie=P(se,[["__scopeId","data-v-3f45c267"]]);const le={class:"text-center"},ce={class:"print-hide q-pa-sm"},ue={id:"lista"},de={class:"print-hide menu flex space-between"},pe={class:"search"},me=["summary"],fe={colspan:"5"},he={key:0,class:"print-hide"},_e={class:"print-only right"},ge=["href"],ye={key:1,class:"print-only"},ve={__name:"ListasPage",setup(T){var x,v;const D=H(),n=W(),e=F({search:((x=D.query.pesquisar)==null?void 0:x.toString())||"",locale:((v=D.params.local)==null?void 0:v.toString())||"",titles:[],from:u.agenda.from,to:u.agenda.to}),c=[],w=o=>{n.push({path:`/event/edit/${o.id}`})},g=()=>{try{if(u.agenda.items.length){let o=u.agenda.items.filter(s=>{try{return s.date&&s.date.getTime()>new Date(`${e.from} 00:00:00`).getTime()&&s.end&&s.end.getTime()<new Date(`${e.to} 23:59:59`).getTime()}catch{return!1}});if(!e.search&&!e.locale)return[];const i=s=>s.trim().toUpperCase().normalize("NFD").replace(/\p{Diacritic}/gu,"");let f=i(e.search),p=i(e.locale);if(/^(\*)/gi.test(e.search)&&(p="",f=f.replace(/^(\*|\/)/gi,"").trim()),p){const s=new RegExp(`^${p}`);o=o.filter(m=>i(m.list).includes(p)||s.test(i(m.locale)))}if(f){let s=null;try{s=new RegExp(f,"gi")}catch{console.log("Regex search inv\xE1lido!")}o=o.filter(m=>{var q;const V=`${(q=m.date)==null?void 0:q.toLocaleString()} ${m.title} ${m.locale} ${m.desc}`;return f.split(" ").every(U=>i(V).includes(U))||s&&s.test(V)})}c.length=0,o.forEach(s=>{c.push(s)}),e.titles=[...new Set(c.map(s=>s.title))]}}catch(o){console.error("Erro ao atualizar lista: ",o)}},r=o=>{if(o.altKey&&o.key.toLowerCase()==="a")o.preventDefault(),o.stopPropagation(),n.push("/event/edit");else if(o.altKey&&["/","*"].includes(o.key)){console.log("Entrar no input");const i=document.querySelector('input[type="text"]');i&&i.focus()}},y=o=>{e.from=o.from,e.to=o.to,g()};I(()=>u.agenda.from,()=>{e.from=u.agenda.from,e.to=u.agenda.to}),K(()=>{g(),I([()=>u.agenda.items,()=>e.search],g),window.addEventListener("keydown",r);const o=window.location.hash;setTimeout(async()=>{e.search&&c.length&&await Z(u,ee.create({description:e.search.trim(),title:e.search.replace(/[-,;]/gi,"").replace(/^\*$/,"Lista Completa").trim(),href:o}))},4e3)}),Y(()=>{window.removeEventListener("keydown",r)});const C=()=>{window.print()},R=()=>{navigator.share?navigator.share({title:"CCB",text:"Lista de Atendimento",url:location.href}).then(()=>console.log("Conte\xFAdo compartilhado com sucesso!")).catch(o=>console.error("Erro ao compartilhar:",o)):console.error("API de compartilhamento n\xE3o suportada.")},t=()=>{const f=`https://api.whatsapp.com/send/?phone=5562984972385&text=${encodeURIComponent(`\u{1F4C4} Batismo, Santa Ceia, ...

\u{1F4CD} Local: 
\u{1F557} Data: 
\u{1F935} Atender\xE1: `)}&type=phone_number&app_absent=0`;window.location.href=f};return(o,i)=>{const f=G("router-link");return d(),h(E,null,[a("div",le,[i[3]||(i[3]=a("div",{class:"print-only"},"LISTA DE ATENDIMENTO E DIVERSOS",-1)),a("div",null,_(e.locale.replace(/-$/,"").trim()),1)]),a("div",ce,[b(ie,{from:e.from,to:e.to,onUpdate:y},null,8,["from","to"])]),a("div",ue,[a("div",de,[a("div",pe,[B(a("input",{class:"z-top",type:"text","onUpdate:modelValue":i[0]||(i[0]=p=>e.search=p),placeholder:"Pesquisar...","x-webkit-speech":""},null,512),[[j,e.search]])]),l(u).state.admin?(d(),k(f,{key:0,to:"/event/edit"},{default:J(()=>[b($,{name:"add"})]),_:1})):S("",!0),l(u).state.shared?(d(),k($,{key:1,name:"share",onClick:L(R,["prevent"])})):S("",!0),l(u).state.shared?(d(),k($,{key:2,name:"quiz",onClick:L(t,["prevent"])})):S("",!0),b($,{name:"print",onClick:i[1]||(i[1]=L(p=>C(),["prevent"]))})]),(d(!0),h(E,null,M(e.titles,p=>(d(),h("div",{key:p},[a("table",{summary:String(p)},[a("thead",null,[a("tr",null,[a("th",fe,_(p),1)])]),a("tbody",null,[(d(!0),h(E,null,M(c.filter(s=>s.title===p),s=>(d(),k(ae,{key:s.id,event:s,onDblclick:m=>w(s),onContextmenu:L(m=>w(s),["right","prevent"])},null,8,["event","onDblclick","onContextmenu"]))),128))])],8,me)]))),128)),!c.length&&!e.search.startsWith("*")?(d(),h("div",he,[b(X,{class:"print-hide q-mt-lg",onClick:i[2]||(i[2]=p=>e.search=`*${e.search}`),color:"blue",flat:"",label:"Lista completa..."})])):S("",!0),a("div",_e,[a("a",{style:{color:"black"},href:l(u).state.url},_(l(u).state.url),9,ge)]),e.locale.includes("REGIONAL")?(d(),h("div",ye,i[4]||(i[4]=[a("i",null,[N(" Ora\xE7\xE3o Santa Ceia "),a("br"),a("b",null,"P\xE3o:"),N(' "Senhor, aben\xE7oa este P\xE3o que vamos comer, que \xE9 a comunh\xE3o do Corpo de Cristo." '),a("br"),a("b",null,"C\xE1lice: "),N('"Senhor, aben\xE7oa o C\xE1lice que vamos beber, que \xE9 a comunh\xE3o do Sangue de Cristo." ')],-1)]))):S("",!0)])],64)}}};var $e=P(ve,[["__scopeId","data-v-748628f3"]]);export{$e as default};
