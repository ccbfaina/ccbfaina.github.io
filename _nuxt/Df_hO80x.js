import{x as k,Z as S,$ as F,a0 as v,h as y,G as C,H}from"./BNw1CUDX.js";function M(e,o){const r=o/e*100;return 2/Math.PI*100*Math.atan(r/50)}function $(e={}){const{duration:o=2e3,throttle:r=200,hideDelay:l=500,resetDelay:d=400}=e,c=e.estimatedProgress||M,u=k(),a=v(0),n=v(!1),m=v(!1);let h=!1,p,_,D,x;const I=(t={})=>{b(),m.value=!1,T(0,t)};function T(t=0,i={}){if(u.isHydrating)return;if(t>=100)return f({force:i.force});g(),a.value=t<0?0:t;const s=i.force?0:r;s?_=setTimeout(()=>{n.value=!0,P()},s):(n.value=!0,P())}function N(){D=setTimeout(()=>{n.value=!1,x=setTimeout(()=>{a.value=0},d)},l)}function f(t={}){a.value=100,h=!0,g(),b(),t.error&&(m.value=!0),t.force?(a.value=0,n.value=!1):N()}function b(){clearTimeout(D),clearTimeout(x)}function g(){clearTimeout(_),cancelAnimationFrame(p)}function P(){h=!1;let t;function i(s){if(h)return;t??=s;const A=s-t;a.value=Math.max(0,Math.min(100,c(o,A))),p=requestAnimationFrame(i)}p=requestAnimationFrame(i)}let L=()=>{};{const t=u.hook("page:loading:start",()=>{I()}),i=u.hook("page:loading:end",()=>{f()}),s=u.hook("vue:error",()=>f());L=()=>{s(),t(),i(),g()}}return{_cleanup:L,progress:y(()=>a.value),isLoading:y(()=>n.value),error:y(()=>m.value),start:I,set:T,finish:f,clear:g}}function q(e={}){const o=k(),r=o._loadingIndicator||=$(e);return S()&&(o._loadingIndicatorDeps||=0,o._loadingIndicatorDeps++,F(()=>{o._loadingIndicatorDeps--,o._loadingIndicatorDeps===0&&(r._cleanup(),delete o._loadingIndicator)})),r}const w=C({name:"NuxtLoadingIndicator",props:{throttle:{type:Number,default:200},duration:{type:Number,default:2e3},hideDelay:{type:Number,default:500},resetDelay:{type:Number,default:400},height:{type:Number,default:3},color:{type:[String,Boolean],default:"repeating-linear-gradient(to right,#00dc82 0%,#34cdfe 50%,#0047e1 100%)"},errorColor:{type:String,default:"repeating-linear-gradient(to right,#f87171 0%,#ef4444 100%)"},estimatedProgress:{type:Function,required:!1}},setup(e,{slots:o,expose:r}){const{progress:l,isLoading:d,error:c,start:u,finish:a,clear:n}=q({duration:e.duration,throttle:e.throttle,hideDelay:e.hideDelay,resetDelay:e.resetDelay,estimatedProgress:e.estimatedProgress});return r({progress:l,isLoading:d,error:c,start:u,finish:a,clear:n}),()=>H("div",{class:"nuxt-loading-indicator",style:{position:"fixed",top:0,right:0,left:0,pointerEvents:"none",width:"auto",height:`${e.height}px`,opacity:d.value?1:0,background:c.value?e.errorColor:e.color||void 0,backgroundSize:`${100/l.value*100}% auto`,transform:`scaleX(${l.value}%)`,transformOrigin:"left",transition:"transform 0.1s, height 0.4s, opacity 0.4s",zIndex:999999}},o)}});export{w as _};
