import{L as ie}from"./DxGekH0p.js";import{_ as de,r as y,y as ce,u as ve,o as he,i as fe,j as C,z as w,c as u,A as pe,a as l,t as b,F as m,n as D,f as N,k as be,B as ge,C as ye,b as r,q as M,s as H,D as q,d as Ce,w as me,m as De,E as _e,e as Ge}from"#entry";const ke={key:1,class:"calendar-wrapper"},we={class:"calendar-header"},Me={class:"month-year"},Te={class:"calendar-table"},Se=["onClick"],xe={class:"day-content"},Ee={class:"day-number"},Ne={key:0,class:"event-indicators"},qe={class:"events-panel"},Ae={class:"events-list-container"},Ue={class:"chips-container"},Fe={key:0,class:"las la-toggle-on"},Re={key:1,class:"las la-toggle-off"},$e=["onClick"],Ye={key:0,class:"las la-toggle-on"},Be={key:1,class:"las la-toggle-off"},ze={class:"chips-container"},Le=["onClick"],Pe={key:0,class:"las la-toggle-on"},Oe={key:1,class:"las la-toggle-off"},Xe={class:"search-container"},Ie={key:0},Ve={class:"event-date-title"},Je={class:"events-list"},je={class:"sub-events-list"},He=["innerHTML"],Qe={key:1,class:"no-events-message"},Q=50,Ke={__name:"agenda",setup(We){const g=fe(),A=y(!0),T=new Date,d=y(T.getMonth()),v=y(T.getFullYear()),c=y(null),s=ce({search:"",title:"",locale:"",date:"",start:"",end:"",enabledGroups:[],disabledGroups:[],enabledCalendars:[],disabledCalendars:[]}),{$indexedDB:K}=ve(),k=y([]),U=y([]);he(async()=>{const{events:e,calendars:a}=await K.getEvents({...s,calendars:s.enabledCalendars});k.value=e.sort((t,n)=>new Date(t.date)-new Date(n.date)),U.value=a}),g.query?.regionais==="true"&&s.enabledCalendars.push("Regional Faina","Regional Goiânia","Regional Uruaçu","Regional Bom Jesus","Regional Catalão");function F(){return[]}const _=C(()=>Array.from(new Set(k.value.map(e=>e.group))).filter(e=>e).sort((e,a)=>e.localeCompare(a)));w(_,e=>{if(!(g.query.groups&&g.query.groups.length>0)&&s.enabledGroups.length===0&&s.disabledGroups.length===0){const a=F(),t=F();a.length>0||t.length>0?(s.enabledGroups=a.filter(n=>e.includes(n)),s.disabledGroups=t.filter(n=>e.includes(n))):(s.enabledGroups=e.filter(n=>n!=="Rodízios"),s.disabledGroups=e.filter(n=>n==="Rodízios"))}},{immediate:!0}),w(U,e=>{g.query.calendars&&g.query.calendars.length>0||s.enabledCalendars.length===0&&s.disabledCalendars.length===0&&(s.enabledCalendars=[...e],s.disabledCalendars=[])},{immediate:!0}),w([()=>s.enabledGroups,()=>s.disabledGroups],()=>{},{deep:!0});const W=C(()=>{const e=[...s.enabledGroups,...s.disabledGroups];return Array.from(new Set(e)).sort((t,n)=>t.localeCompare(n))}),Z=C(()=>{const e=[...s.enabledCalendars,...s.disabledCalendars];return Array.from(new Set(e)).sort((t,n)=>t.localeCompare(n))}),R=C(()=>s.enabledGroups.length===_.value.length);w(()=>k.value,()=>{const e=g.query||{};if(["search","title","locale","date","start","end"].forEach(t=>{e[t]!==void 0&&(s[t]=e[t])}),e.groups){const t=Array.isArray(e.groups)?e.groups:e.groups.split(",").filter(Boolean);s.enabledGroups=t.filter(n=>_.value.includes(n)),s.disabledGroups=_.value.filter(n=>!t.includes(n))}if(e.calendars){const t=Array.isArray(e.calendars)?e.calendars:e.calendars.split(",").filter(Boolean);console.log("Calendários da URL:",t),s.enabledCalendars=t,s.disabledCalendars=[]}A.value=!1},{immediate:!0});function ee(e){s.enabledGroups.includes(e)?(s.enabledGroups=s.enabledGroups.filter(t=>t!==e),s.disabledGroups.push(e)):(s.disabledGroups=s.disabledGroups.filter(t=>t!==e),s.enabledGroups.push(e)),s.enabledGroups.sort((t,n)=>t.localeCompare(n)),s.disabledGroups.sort((t,n)=>t.localeCompare(n))}function te(){R.value?(s.disabledGroups=[..._.value],s.enabledGroups=[]):(s.enabledGroups=[..._.value],s.disabledGroups=[])}function ae(e){s.enabledCalendars.includes(e)?(s.enabledCalendars=s.enabledCalendars.filter(t=>t!==e),s.disabledCalendars.push(e)):(s.disabledCalendars=s.disabledCalendars.filter(t=>t!==e),s.enabledCalendars.push(e)),s.enabledCalendars.sort((t,n)=>t.localeCompare(n)),s.disabledCalendars.sort((t,n)=>t.localeCompare(n))}const S=C(()=>{const e=s.search.trim();let a=ye(k.value||[],s);if(g.query.next==="true"){const n=new Date;a=a.filter(o=>new Date(o.date)>n)}return a=a.filter(n=>s.enabledGroups.includes(n.group)).filter(n=>s.enabledCalendars.includes(n.list)).filter(n=>!n.noDate),a}),$=C(()=>{let e;if(c.value){const t=c.value.date;e=S.value.filter(n=>{const o=new Date(n.date);return o.getUTCFullYear()===t.getFullYear()&&o.getUTCMonth()===t.getMonth()&&o.getUTCDate()===t.getDate()})}else e=S.value.filter(t=>{const n=new Date(t.date);return n.getUTCFullYear()===v.value&&n.getUTCMonth()===d.value});const a=new Map;for(const t of e){const o=new Date(t.date).toISOString().split("T")[0];a.has(o)||a.set(o,new Map);const h=a.get(o);h.has(t.title)||h.set(t.title,[]),h.get(t.title).push(t)}return Array.from(a.entries()).sort(([t],[n])=>new Date(t)-new Date(n))}),Y=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],se=C(()=>`${Y[d.value]} ${v.value}`),B=C(()=>{const e=[],a=new Date(v.value,d.value,1).getDay(),t=new Date(v.value,d.value+1,0).getDate(),n=new Date(v.value,d.value,0).getDate();for(let i=a-1;i>=0;i--)e.push({dayNumber:n-i,date:new Date(v.value,d.value-1,n-i),isPrevMonth:!0,isNextMonth:!1,isToday:!1,hasEvent:!1,events:[]});for(let i=1;i<=t;i++){const p=new Date(v.value,d.value,i),f=S.value.filter(ue=>{const E=new Date(ue.date);return E.getUTCDate()===i&&E.getUTCMonth()===d.value&&E.getUTCFullYear()===v.value});e.push({dayNumber:i,date:p,isPrevMonth:!1,isNextMonth:!1,isToday:p.toDateString()===T.toDateString(),hasEvent:f.length>0,events:f})}const o=42-e.length;for(let i=1;i<=o;i++)e.push({dayNumber:i,date:new Date(v.value,d.value+1,i),isPrevMonth:!1,isNextMonth:!0,isToday:!1,hasEvent:!1,events:[]});const h=[];for(;e.length>0;)h.push(e.splice(0,7));return h});function ne(e){const a=new Date(e),t=a.getUTCDate(),n=Y[a.getUTCMonth()],o=a.getUTCFullYear();return`${t} de ${n} de ${o}`}function G(e){d.value+=e,d.value<0?(d.value=11,v.value--):d.value>11&&(d.value=0,v.value++),c.value=null}function le(e){return{"prev-month-day":e.isPrevMonth||e.isNextMonth,today:e.isToday,"has-event":e.hasEvent,"selected-day":c.value&&e.date&&c.value.date&&c.value.date.toDateString()===e.date.toDateString()}}function z(e){e.isPrevMonth?(G(-1),c.value={...e,date:new Date(v.value,d.value,e.dayNumber)}):e.isNextMonth?(G(1),c.value={...e,date:new Date(v.value,d.value,e.dayNumber)}):c.value&&c.value.date.toDateString()===e.date.toDateString()?c.value=null:c.value=e}if(g.query?.data){const e=B.value[0].find(a=>a.date?.toDateString()===new Date(g.query?.data+" 03:00:00")?.toDateString());e&&z(e)}function oe(e){return c.value?e.some(a=>{const t=new Date(a.date),n=c.value.date;return t.getUTCFullYear()===n.getFullYear()&&t.getUTCMonth()===n.getMonth()&&t.getUTCDate()===n.getDate()}):!1}function re(e){const a=new Set;for(const t of e)t.group&&a.add(t.group);return[...a]}const L=["#d6b8c1","#d1c965","#cdb8d1","#aed4d7","#b3a9a5","#a9c6aa","#d39a8f","#b0a2cc","#d28fa9","#b2d29f","#d1b05e","#84c9cc","#d1be83","#92c2be","#a3b1b5","#bdc75d"],P={Reuniões:"#c4d7b9",Atendimentos:"#b4d0e3",Rodízios:"#e6b97f",Outros:"#c3bfe0"},x=y({});function O(e){if(P[e])return P[e];if(!x.value[e]){const t=Array.from(new Set(k.value.map(n=>n.group).filter(n=>n!==null))).indexOf(e);x.value[e]=L[t%L.length]}return x.value[e]}function X(e){return{backgroundColor:O(e)}}const I=y(0),V=y(0);function J(e){I.value=e.touches?e.touches[0].clientX:e.clientX}function j(e){V.value=e.changedTouches?e.changedTouches[0].clientX:e.clientX;const a=V.value-I.value;a>Q?G(-1):a<-Q&&G(1)}return(e,a)=>{const t=ie,n=Ge;return r(),u("div",null,[A.value?(r(),pe(t,{key:0})):(r(),u("div",ke,[l("div",{class:"calendar-panel",onTouchstart:J,onTouchend:j,onMousedown:J,onMouseup:j},[l("div",we,[l("i",{class:"las la-chevron-left",onClick:a[0]||(a[0]=o=>G(-1))}),l("h2",Me,b(se.value),1),l("i",{class:"las la-chevron-right",onClick:a[1]||(a[1]=o=>G(1))})]),l("table",Te,[a[3]||(a[3]=l("thead",null,[l("tr",null,[l("th",null,"Dom"),l("th",null,"Seg"),l("th",null,"Ter"),l("th",null,"Qua"),l("th",null,"Qui"),l("th",null,"Sex"),l("th",null,"Sáb")])],-1)),l("tbody",null,[(r(!0),u(m,null,D(B.value,(o,h)=>(r(),u("tr",{key:h},[(r(!0),u(m,null,D(o,i=>(r(),u("td",{key:i.date,class:M(le(i)),onClick:p=>z(i)},[l("div",xe,[l("div",Ee,b(i.dayNumber),1),i.events.length?(r(),u("div",Ne,[(r(!0),u(m,null,D(re(i.events),p=>(r(),u("span",{key:p,class:"event-indicator",style:q({backgroundColor:O(p)})},null,4))),128))])):H("",!0)])],10,Se))),128))]))),128))])])],32),l("div",qe,[l("div",Ae,[a[6]||(a[6]=l("small",{style:{opacity:"0.8"}},"Grupos:",-1)),l("div",Ue,[l("span",{class:"chip",onClick:te},[R.value?(r(),u("i",Fe)):(r(),u("i",Re)),a[4]||(a[4]=N(" Todos os Grupos ",-1))]),(r(!0),u(m,null,D(W.value,o=>(r(),u("span",{key:o,class:M(["chip",{"chip-disabled":s.disabledGroups.includes(o)}]),style:q(X(o)),onClick:h=>ee(o)},[s.enabledGroups.includes(o)?(r(),u("i",Ye)):(r(),u("i",Be)),N(" "+b(o),1)],14,$e))),128))]),a[7]||(a[7]=l("small",{style:{opacity:"0.8"}},"Agenda(s):",-1)),l("div",ze,[(r(!0),u(m,null,D(Z.value,o=>(r(),u("span",{key:o,class:M(["chip",{"chip-disabled":s.disabledCalendars.includes(o)}]),onClick:h=>ae(o)},[s.enabledCalendars.includes(o)?(r(),u("i",Pe)):(r(),u("i",Oe)),N(" "+b(o),1)],10,Le))),128))]),l("div",Xe,[be(l("input",{"onUpdate:modelValue":a[2]||(a[2]=o=>s.search=o),type:"text",placeholder:"Buscar eventos...",class:"search-input"},null,512),[[ge,s.search]]),a[5]||(a[5]=l("i",{class:"las la-search search-icon"},null,-1))]),Object.keys($.value).length?(r(),u("div",Ie,[(r(!0),u(m,null,D($.value,([o,h])=>(r(),u("div",{key:o},[l("h4",Ve,b(ne(o)),1),l("ul",Je,[(r(!0),u(m,null,D(h,([i,p])=>(r(),u("li",{key:i,class:M({"selected-event":oe(p)}),style:q(X(p[0].group))},[l("strong",null,b(i),1),l("ul",je,[(r(!0),u(m,null,D(p,f=>(r(),u("li",{key:f.id},[Ce(n,{to:{path:"/evento",query:{id:f.id}}},{default:me(()=>[l("p",null,[l("b",null,[l("i",null,b(f.formatTime)+b(f.formatTime?" - ":"")+b(f.formatDate),1)])]),l("p",null,b(f.locale),1),f.desc?(r(),u("p",{key:0,innerHTML:De(_e)(f.desc)},null,8,He)):H("",!0)]),_:2},1032,["to"])]))),128))])],6))),128))])]))),128))])):(r(),u("p",Qe,"Nenhum evento agendado."))])])]))])}}},tt=de(Ke,[["__scopeId","data-v-4ad983c4"]]);export{tt as default};
