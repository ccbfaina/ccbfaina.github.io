import{f as k,aa as S,ab as F,ac as v,j as y,J as C,K as M}from"#entry";function q(e,a){const o=a/e*100;return 2/Math.PI*100*Math.atan(o/50)}function E(e={}){const{duration:a=2e3,throttle:o=200,hideDelay:u=500,resetDelay:c=400}=e,d=e.estimatedProgress||q,l=k(),r=v(0),n=v(!1),m=v(!1);let h=!1,p,_,D,I;const T=(t={})=>{x(),m.value=!1,b(0,t)};function b(t=0,i={}){if(l.isHydrating)return;if(t>=100)return f({force:i.force});g(),r.value=t<0?0:t;const s=i.force?0:o;s?_=setTimeout(()=>{n.value=!0,P()},s):(n.value=!0,P())}function N(){D=setTimeout(()=>{n.value=!1,I=setTimeout(()=>{r.value=0},c)},u)}function f(t={}){r.value=100,h=!0,g(),x(),t.error&&(m.value=!0),t.force?(r.value=0,n.value=!1):N()}function x(){clearTimeout(D),clearTimeout(I)}function g(){clearTimeout(_),cancelAnimationFrame(p)}function P(){h=!1;let t;function i(s){if(h)return;t??=s;const A=s-t;r.value=Math.max(0,Math.min(100,d(a,A))),p=requestAnimationFrame(i)}p=requestAnimationFrame(i)}let L=()=>{};{const t=l.hook("page:loading:start",()=>{T()}),i=l.hook("page:loading:end",()=>{f()}),s=l.hook("vue:error",()=>f());L=()=>{s(),t(),i(),g()}}return{_cleanup:L,progress:y(()=>r.value),isLoading:y(()=>n.value),error:y(()=>m.value),start:T,set:b,finish:f,clear:g}}function H(e={}){const a=k(),o=a._loadingIndicator||=E(e);return S()&&(a._loadingIndicatorDeps||=0,a._loadingIndicatorDeps++,F(()=>{a._loadingIndicatorDeps--,a._loadingIndicatorDeps===0&&(o._cleanup(),delete a._loadingIndicator)})),o}const w=C({name:"NuxtLoadingIndicator",props:{throttle:{type:Number,default:200},duration:{type:Number,default:2e3},hideDelay:{type:Number,default:500},resetDelay:{type:Number,default:400},height:{type:Number,default:3},color:{type:[String,Boolean],default:"repeating-linear-gradient(to right,#00dc82 0%,#34cdfe 50%,#0047e1 100%)"},errorColor:{type:String,default:"repeating-linear-gradient(to right,#f87171 0%,#ef4444 100%)"},estimatedProgress:{type:Function,required:!1}},setup(e,{slots:a,expose:o}){const{progress:u,isLoading:c,error:d,start:l,finish:r,clear:n}=H({duration:e.duration,throttle:e.throttle,hideDelay:e.hideDelay,resetDelay:e.resetDelay,estimatedProgress:e.estimatedProgress});return o({progress:u,isLoading:c,error:d,start:l,finish:r,clear:n}),()=>M("div",{class:"nuxt-loading-indicator",style:{position:"fixed",top:0,right:0,left:0,pointerEvents:"none",width:"auto",height:`${e.height}px`,opacity:c.value?1:0,background:d.value?e.errorColor:e.color||void 0,backgroundSize:`${u.value>0?100/u.value*100:0}% auto`,transform:`scaleX(${u.value}%)`,transformOrigin:"left",transition:"transform 0.1s, height 0.4s, opacity 0.4s",zIndex:999999}},a)}});export{w as _};
