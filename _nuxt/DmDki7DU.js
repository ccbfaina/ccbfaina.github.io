import{L as lt}from"./CiEXHWot.js";import{_ as at,r as S,z as M,f as nt,j as m,i as D,A as ot,c as r,B as rt,F as y,a as e,s as _,x as i,k as b,t as p,v as h,C as E,n as k,I as U,e as I,g as it,S as T,Z as ut,q as dt,o,E as ct,m as pt,G as vt}from"./D4msPRtv.js";import{d as j}from"./D0Dr7phT.js";const ft={class:"tabs-container print-hide"},bt={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},mt=["aria-selected"],yt={class:"badge"},gt=["aria-selected"],St={class:"badge"},_t=["aria-selected"],kt={class:"tab-content"},At={id:"tab-content-lista",role:"tabpanel"},Ct={class:"text-center"},ht={key:0},Et={key:1},It={key:2},wt={key:3},Ot={key:4},Dt={id:"tab-content-filters",role:"tabpanel"},Tt={class:"content"},Rt={class:"form-inline"},Lt={class:"form-group"},xt={class:"row"},Vt={class:"form-group"},$t={class:"row"},Nt=["value"],Bt={class:"form-group"},Mt={class:"row"},Ut=["value"],jt={class:"form-group"},zt={class:"row gap-xs"},Ft={class:"form-group",style:{"text-align":"right"}},Gt=["disabled"],qt={class:"form-inline",style:{gap:"1rem","margin-top":"1rem"}},Pt={id:"tab-content-print",role:"tabpanel"},Ht={class:"a4 print-hide"},Wt={class:"settings-list"},Yt={class:"settings-list"},Zt=["onClick"],Jt={key:0,class:"print-page print-layout"},Kt={class:"table-wrapper"},Qt={colspan:"5",class:"text-center",style:{"text-transform":"uppercase"}},Xt=["onDblclick"],te={key:0,class:"nowrap"},ee={key:0},se=["innerHTML"],le={__name:"calendar",setup(ae){ut(l=>({f687fa48:A.value}));const z=it(),F=dt(),d=S("lista"),g=S(!1),A=S(1),s=M({search:"",title:"",locale:"",date:"",start:"",end:"",calendars:[]}),{$indexedDB:G}=nt(),f=S([]),c=M({}),R=S([]),q=m(()=>({fontSize:`${A.value}rem`})),L=l=>l?.replace(/-$/,"").trim(),w=l=>{if(!l)return"";const t=l.split("T")[0];return t?t.split("-").reverse().join("/"):""},x=(l,t)=>Array.from(new Set(l.map(n=>n[t]).filter(n=>typeof n=="string"&&n.trim()))),P=m(()=>x(f.value,"title")),H=m(()=>x(f.value,"locale")),W=()=>{const l=z.query||{};["search","title","locale","date","start","end"].forEach(v=>{l[v]!==void 0&&(s[v]=l[v])}),l.calendars&&(s.calendars=Array.isArray(l.calendars)?l.calendars:l.calendars.split(",").filter(Boolean));const{today:n,future:a}=T();s.start||(s.start=n),s.end||(s.end=a)},V=j(()=>{const l=Object.fromEntries(Object.entries(s).filter(([t,n])=>t==="calendars"?n.length:n!==""&&n!=null).map(([t,n])=>Array.isArray(n)?[t,n.join(",")]:[t,n]));F.replace({query:l})},2e3),Y=j(async()=>{g.value=!0;try{const{data:l}=await G.getEvents(s)||{},{events:t}=l||{};f.value=t||[];const n=Array.from(new Set(f.value.map(a=>a.title||"Sem título")));R.value=n}catch(l){console.error("Error fetching calendar events:",l)}finally{g.value=!1}},2e3),Z=()=>{V()};D(s,V,{deep:!0}),D(()=>s,()=>{s.start&&Y()},{immediate:!0,deep:!0});function C(l){if(l==="calendars")s.calendars=[];else if(l==="date"){s.date="";const{today:t,future:n}=T();s.start=t,s.end=n}else if(l==="start"||l==="end"){const{today:t,future:n}=T();s.start=t,s.end=n}else s[l]=""}const J=m(()=>{let l=0;return s.search&&l++,s.title&&l++,s.locale&&l++,s.date&&l++,s.calendars&&s.calendars.length>0&&l++,l}),K=()=>{d.value="lista",setTimeout(()=>{window.print()},1e3)},$=m(()=>{if(!f.value||!f.value.length)return[];const l=f.value.filter(n=>["ASSUNTOS MUSICAIS","AVISOS À IRMANDADE","BATISMOS","ENSAIOS REGIONAIS","NOVOS OBREIROS PARA MINISTÉRIO E CARGOS","REUNIÕES DIVERSAS","REUNIÕES PARA A MOCIDADE","REUNIÕES REGIONAIS","SANTAS CEIAS"].includes(n.title.toUpperCase())),t=new Map;for(const n of l||[]){if(!n.date)continue;const a=new Date(n.date),v=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,u=a.toLocaleDateString("pt-BR",{month:"long",year:"numeric"});t.has(v)||t.set(v,{month:u,items:[]}),t.get(v).items.push(n)}return Array.from(t.entries()).sort(([n],[a])=>n.localeCompare(a)).map(([n,{month:a,items:v}])=>({month:a,items:v.slice().sort((u,B)=>u.onDate-B.onDate)}))}),O=m(()=>{const l={};return f.value.forEach(t=>{const n=t.title||"Sem título";(l[n]||=[]).push(t)}),Object.keys(l).map(t=>({title:t}))}),Q=()=>{if(!O.value)return;const l=O.value.map(t=>t.title);l.forEach(t=>{t in c||(c[t]=!0)});for(const t in c)l.includes(t)||(c[t]=!1)};ot(()=>{W()}),D(O,Q,{immediate:!0});const X=l=>{d.value="print",c[l]=!c[l]},N=m(()=>Object.values(c).length>0&&Object.values(c).every(Boolean)),tt=l=>{for(const t in c)c[t]=l},et=m(()=>Object.values(c).filter(Boolean).length),st=l=>{const t=`https://www.google.com/calendar/event?eid=${l.htmlLink}`;window.open(t,"_blank")};return(l,t)=>{const n=lt;return o(),r("div",null,[g.value?(o(),rt(n,{key:0})):(o(),r(y,{key:1},[e("div",ft,[e("nav",bt,[e("span",{id:"tab-filters","aria-selected":d.value==="filters",role:"tab",type:"button",class:_(["tab",{active:d.value==="filters"}]),style:{position:"relative"},onClick:t[0]||(t[0]=a=>d.value="filters")},[e("span",yt,i(J.value),1),t[15]||(t[15]=e("i",{class:"la la-filter z-10"},null,-1))],10,mt),e("span",{id:"tab-print","aria-selected":d.value==="print",role:"tab",type:"button",class:_(["tab",{active:d.value==="print"}]),onClick:t[1]||(t[1]=a=>d.value="print")},[e("span",St,i(et.value),1),t[16]||(t[16]=e("i",{class:"la la-print"},null,-1))],10,gt),e("span",{id:"tab-lista","aria-selected":d.value==="lista",role:"tab",type:"button",class:_(["tab",{active:d.value==="lista"}]),onClick:t[2]||(t[2]=a=>d.value="lista")}," Calendário ",10,_t)])]),e("div",kt,[b(e("div",At,[e("div",Ct,[t[17]||(t[17]=e("div",null,"CALENDÁRIO",-1)),s.calendars.length?(o(),r("div",ht,[e("b",null,i(s.calendars.map(L).join(", ")),1)])):p("",!0),s.locale?(o(),r("span",Et,[e("b",null,i(L(s.locale)),1)])):p("",!0),s.date?(o(),r("span",It," Data: "+i(w(s.date)),1)):p("",!0),!s.date&&(s.start||s.end)?(o(),r("div",wt," Período: "+i(w(s.start))+" à "+i(w(s.end)),1)):p("",!0),s.search?(o(),r("div",Ot,i(s.search),1)):p("",!0)])],512),[[h,d.value==="lista"]]),b(e("div",Dt,[e("div",Tt,[e("div",Rt,[e("div",null,[e("div",Lt,[t[18]||(t[18]=e("label",{for:"search"},"Pesquisar",-1)),e("div",xt,[b(e("input",{id:"search","onUpdate:modelValue":t[3]||(t[3]=a=>s.search=a),type:"text",placeholder:"Buscar itens..."},null,512),[[E,s.search]]),s.search?(o(),r("button",{key:0,class:"btn-clear","aria-label":"Limpar pesquisa",type:"button",onClick:t[4]||(t[4]=a=>C("search"))}," × ")):p("",!0)])]),e("div",Vt,[t[20]||(t[20]=e("label",{for:"title"},"Título",-1)),e("div",$t,[b(e("select",{id:"title","onUpdate:modelValue":t[5]||(t[5]=a=>s.title=a)},[t[19]||(t[19]=e("option",{value:""},"Todos os títulos",-1)),(o(!0),r(y,null,k(P.value,a=>(o(),r("option",{key:a,value:a},i(a),9,Nt))),128))],512),[[U,s.title]]),s.title?(o(),r("button",{key:0,class:"btn-clear","aria-label":"Limpar título",type:"button",onClick:t[6]||(t[6]=a=>C("title"))}," × ")):p("",!0)])]),e("div",Bt,[t[22]||(t[22]=e("label",{for:"locale"},"Local",-1)),e("div",Mt,[b(e("select",{id:"locale","onUpdate:modelValue":t[7]||(t[7]=a=>s.locale=a)},[t[21]||(t[21]=e("option",{value:""},"Todos os locais",-1)),(o(!0),r(y,null,k(H.value,a=>(o(),r("option",{key:a,value:a},i(a),9,Ut))),128))],512),[[U,s.locale]]),s.locale?(o(),r("button",{key:0,class:"btn-clear","aria-label":"Limpar local",type:"button",onClick:t[8]||(t[8]=a=>C("locale"))}," × ")):p("",!0)])]),e("div",jt,[t[23]||(t[23]=e("label",null,"Entre",-1)),e("div",zt,[b(e("input",{"onUpdate:modelValue":t[9]||(t[9]=a=>s.start=a),type:"date"},null,512),[[E,s.start]]),b(e("input",{"onUpdate:modelValue":t[10]||(t[10]=a=>s.end=a),type:"date"},null,512),[[E,s.end]]),s.start||s.end?(o(),r("button",{key:0,class:"btn-clear","aria-label":"Limpar datas",type:"button",onClick:t[11]||(t[11]=a=>C("date"))}," × ")):p("",!0)])])]),e("div",null,[e("div",Ft,[t[24]||(t[24]=e("label",null,null,-1)),e("button",{class:"success",disabled:g.value,onClick:t[12]||(t[12]=a=>Z())},i(g.value?"Atualizando...":"Aplicar"),9,Gt)])])]),e("div",qt,[e("span",null,[t[25]||(t[25]=e("i",{class:"la la-tasks"},null,-1)),I(" "+i(Array.isArray(f.value)?f.value.length:0),1)])])])],512),[[h,d.value==="filters"]]),b(e("div",Pt,[e("div",{class:"text-center flex col items-center gap-4"},[t[27]||(t[27]=e("b",{class:"mb-4 p"},"Ajustes de impressão:",-1)),e("div",{class:"p"},[e("button",{class:"success",onClick:K},[...t[26]||(t[26]=[e("i",{class:"la la-print"},null,-1),I(" Imprimir ",-1)])])])]),e("div",Ht,[e("div",Wt,[t[28]||(t[28]=e("b",null,"Tamanho da Fonte",-1)),b(e("input",{type:"range","onUpdate:modelValue":t[13]||(t[13]=a=>A.value=a),min:"0.8",max:"1.6",step:"0.1"},null,512),[[E,A.value]])]),e("div",Yt,[t[29]||(t[29]=e("b",null,"Lista",-1)),e("div",null,[e("i",{class:_(["la",N.value?"la-toggle-on":"la-toggle-off"]),title:"Ocultar todos",onClick:t[14]||(t[14]=a=>tt(!N.value))},null,2)])]),(o(!0),r(y,null,k(R.value,a=>(o(),r("div",{key:a,class:"settings-list print-hide",onClick:v=>X(a)},[I(i(a)+" ",1),e("i",{class:_(["la",c[a]?"la-toggle-on":"la-toggle-off"]),title:"Alterar visibilidade"},null,2)],8,Zt))),128))])],512),[[h,d.value==="print"]]),$.value.length?(o(),r("div",Jt,[(o(!0),r(y,null,k($.value,({month:a,items:v})=>(o(),r("div",{key:a,class:"month-section"},[e("div",Kt,[e("table",{style:ct(q.value)},[e("thead",null,[e("tr",null,[e("th",Qt,i(a),1)])]),e("tbody",null,[(o(!0),r(y,null,k(v,u=>b((o(),r("tr",{key:u.id,onDblclick:B=>st(u)},[e("td",null,[u.formatDate?(o(),r("span",te,i(u.formatDate.split("/")[0])+" | "+i(u.formatWeek),1)):p("",!0)]),e("td",null,[u.formatTime?(o(),r("span",ee,i(u.formatTime),1)):p("",!0)]),e("td",null,i(u.title),1),e("td",null,[e("b",null,i(u.locale),1),t[30]||(t[30]=I(" - ",-1)),u.desc?(o(),r("span",{key:0,innerHTML:pt(vt)(u.desc)},null,8,se)):p("",!0)])],40,Xt)),[[h,c[u.title||"Sem título"]]])),128))])],4)])]))),128))])):p("",!0)])],64))])}}},ie=at(le,[["__scopeId","data-v-e495febc"]]);export{ie as default};
