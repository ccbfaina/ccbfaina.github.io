import{_ as y,H as C,A as w,c as e,a as t,e as n,x,m as a,t as d,F as A,q as N,o}from"./BvqWflSK.js";const P={key:0},I=["src"],U={key:1,class:"las la-user"},q={key:1},B={key:0},E=["disabled"],R={key:0},T={key:1},D={key:1},L={key:2},V={key:0},$={key:1},j={__name:"settings",setup(S){const c=N(),{notifications:i,pendingConfigsCount:p,install:l,user:u}=C();async function f(){if(navigator.share)navigator.share({title:"Agenda CCB",text:"Acesse o aplicativo Agenda CCB",url:"https://faina.ccbgo.org.br"});else try{await navigator.clipboard.writeText("https://faina.ccbgo.org.br"),alert("URL copiada para a área de transferência!")}catch{alert("Não foi possível copiar a URL.")}}async function g(){if(!("Notification"in window)){console.warn("Este navegador não suporta notificações."),alert("Este navegador não suporta notificações.");return}i.status="loading";try{const r=await Notification.requestPermission();r==="granted"?i.status="granted":r==="denied"?i.status="denied":i.status="default"}catch(r){console.error("Erro ao solicitar permissão de notificação:",r),i.status="default"}}function m(){l.deferredPrompt&&(l.deferredPrompt.prompt(),l.deferredPrompt.userChoice.then(({outcome:r})=>{r==="accepted"?(console.log("Usuário aceitou instalar o PWA."),l.canInstall=!1,l.deferredPrompt=null):console.log("Usuário recusou instalar o PWA.")}))}function v(){console.log(`Seu token de notificação é: ${i.fcmToken}`)}function b(){alert("Para ativar as notificações, vá nas configurações do seu navegador e permita notificações para este aplicativo.")}return w(()=>{"Notification"in window&&(i.status=Notification.permission)}),(r,s)=>(o(),e("div",null,[t("div",{class:"row space-between"},[t("div",null,[t("button",{class:"action-button",onClick:f},[...s[2]||(s[2]=[t("i",{class:"la la-share-alt"},null,-1),n(" Compartilhar aplicativo ",-1)])])])]),s[19]||(s[19]=t("hr",{class:"section-separator"},null,-1)),t("div",null,x(a(p)>0?`Você tem ${a(p)} configuração(ões) pendente(s).`:"Todas as configurações estão atualizadas."),1),t("div",null,[a(u)===null?(o(),e("section",P,[s[4]||(s[4]=t("h2",null,[t("i",{class:"la la-bell text-blue-500"}),n("Acesso")],-1)),s[5]||(s[5]=n(" Entre com uma conta de acesso para mais recursos. ",-1)),t("div",{class:"user-info",onClick:s[1]||(s[1]=k=>a(c).push("/perfil")),style:{cursor:"pointer",padding:"10px"}},[a(u)?(o(),e(A,{key:0},[a(u).photoURL?(o(),e("img",{key:0,src:a(u).photoURL,alt:"Avatar do usuário"},null,8,I)):(o(),e("i",U))],64)):(o(),e("button",{key:1,onClick:s[0]||(s[0]=k=>a(c).push("/perfil"))},[...s[3]||(s[3]=[t("i",{class:"las la-user-slash"},null,-1),n(" Perfil",-1)])]))])])):d("",!0),a(i).status!=="granted"?(o(),e("section",q,[s[12]||(s[12]=t("h2",null,[t("i",{class:"la la-bell text-blue-500"}),n(" Permissões")],-1)),a(i).status==="default"||a(i).status==="loading"?(o(),e("div",B,[s[7]||(s[7]=t("p",{class:"info-message"}," Deseja receber atualizações importantes e lembretes? ",-1)),t("button",{class:"action-button primary",disabled:a(i).status==="loading",onClick:g},[s[6]||(s[6]=t("i",{class:"la la-bell"},null,-1)),a(i).status==="loading"?(o(),e("span",R," Solicitando... ")):(o(),e("span",T," Ativar Notificações "))],8,E)])):a(i).status==="denied"?(o(),e("div",D,[s[9]||(s[9]=t("p",{class:"error-message"},[t("i",{class:"la la-exclamation-triangle"}),n(" As notificações estão bloqueadas no navegador. ")],-1)),t("button",{class:"action-button secondary",onClick:b},[...s[8]||(s[8]=[t("i",{class:"la la-unlock"},null,-1),n(" Desbloquear Notificações ",-1)])]),s[10]||(s[10]=t("p",{class:"instructions-text"}," Para reativar, você precisará desbloqueá-las manualmente nas configurações do seu navegador para este site. ",-1))])):a(i).status==="granted"?(o(),e("div",{key:2,onClick:v},[...s[11]||(s[11]=[t("p",{class:"success-message"},[t("i",{class:"la la-check-circle"}),n(" Notificações ativadas! ")],-1)])])):d("",!0),s[13]||(s[13]=t("hr",{class:"section-separator"},null,-1))])):d("",!0),a(l).canInstall?(o(),e("section",L,[s[17]||(s[17]=t("h2",null,[t("i",{class:"lab la-app-store-ios text-blue-500"}),n(" Instalar")],-1)),a(l).canInstall?(o(),e("div",V,[s[15]||(s[15]=t("p",{class:"info-message"},"Deseja instalar o app em seu dispositivo?",-1)),t("button",{class:"action-button",onClick:m},[...s[14]||(s[14]=[t("i",{class:"la la-download"},null,-1),n(" Instalar aplicativo ",-1)])])])):(o(),e("div",$,[...s[16]||(s[16]=[t("p",{class:"success-message"},[t("i",{class:"la la-check-circle"}),n("O aplicativo já está instalado. ")],-1)])])),s[18]||(s[18]=t("hr",{class:"section-separator"},null,-1))])):d("",!0)])]))}},F=y(j,[["__scopeId","data-v-8aba8f15"]]);export{F as default};
