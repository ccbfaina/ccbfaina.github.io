import{_ as v,s as b,r as k,f as C,c as n,a as t,z as u,e as l,t as w,m as i,o as e}from"./CI68DGMK.js";const y={key:0},N=["disabled"],x={key:0},A={key:1},P={key:1},B={__name:"settings",setup(E){const a=b(),c=k(!1);let r=null;async function d(){if(!("Notification"in window)){console.warn("Este navegador não suporta notificações."),alert("Este navegador não suporta notificações.");return}a.notifications.status="loading";try{const o=await Notification.requestPermission();o==="granted"?(console.log("Permissão para notificações concedida."),a.notifications.status="granted"):o==="denied"?(console.warn("Permissão para notificações negada."),a.notifications.status="denied"):(console.log("Permissão para notificações não foi concedida."),a.notifications.status="default")}catch(o){console.error("Erro ao solicitar permissão de notificação:",o)}}function f(){navigator.share?navigator.share({title:"Agenda CCB",text:"Acesse o aplicativo Agenda CCB",url:window.location.origin}):alert("Compartilhamento não suportado neste navegador.")}function p(){r&&(r.prompt(),r.userChoice.finally(()=>{r=null,c.value=!1}))}function g(){console.log(`Seu token de notificação é: ${a.notifications.fcmToken}`)}function m(){alert("Para ativar as notificações, vá nas configurações do seu navegador e permita notificações para este aplicativo.")}return C(()=>{window.addEventListener("beforeinstallprompt",o=>{o.preventDefault(),r=o,c.value=!0}),"Notification"in window?a.notifications.status=Notification.permission:console.warn("Notificações não suportadas neste ambiente.")}),(o,s)=>(e(),n("div",null,[t("div",null,[t("button",{class:"action-button",onClick:f},s[0]||(s[0]=[t("i",{class:"la la-share-alt"},null,-1),l(" Compartilhar aplicativo ")])),c.value?(e(),n("button",{key:0,class:"action-button",onClick:p},s[1]||(s[1]=[t("i",{class:"la la-download"},null,-1),l(" Instalar aplicativo ")]))):u("",!0)]),s[10]||(s[10]=t("hr",{class:"section-separator"},null,-1)),t("div",null,w(i(a).pendingConfigsCount>0?`Você tem ${i(a).pendingConfigsCount} configuração(ões) pendente(s).`:"Todas as configurações estão atualizadas."),1),s[11]||(s[11]=t("hr",{class:"section-separator"},null,-1)),t("div",null,[t("section",null,[s[8]||(s[8]=t("h2",null,[t("i",{class:"la la-bell text-blue-500"}),l(" Permissões")],-1)),i(a).notifications.status==="default"||i(a).notifications.status==="loading"?(e(),n("div",y,[s[3]||(s[3]=t("p",{class:"info-message"}," Deseja receber atualizações importantes e lembretes? ",-1)),t("button",{class:"action-button primary",disabled:i(a).notifications.status==="loading",onClick:d},[s[2]||(s[2]=t("i",{class:"la la-bell"},null,-1)),i(a).notifications.status==="loading"?(e(),n("span",x," Solicitando... ")):(e(),n("span",A," Ativar Notificações "))],8,N)])):i(a).notifications.status==="denied"?(e(),n("div",P,[s[5]||(s[5]=t("p",{class:"error-message"},[t("i",{class:"la la-exclamation-triangle"}),l(" As notificações estão bloqueadas no navegador. ")],-1)),t("button",{class:"action-button secondary",onClick:m},s[4]||(s[4]=[t("i",{class:"la la-unlock"},null,-1),l(" Desbloquear Notificações ")])),s[6]||(s[6]=t("p",{class:"instructions-text"}," Para reativar, você precisará desbloqueá-las manualmente nas configurações do seu navegador para este site. ",-1))])):i(a).notifications.status==="granted"?(e(),n("div",{key:2,onClick:g},s[7]||(s[7]=[t("p",{class:"success-message"},[t("i",{class:"la la-check-circle"}),l(" Notificações ativadas! ")],-1)]))):u("",!0)]),s[9]||(s[9]=t("hr",{class:"section-separator"},null,-1))])]))}},D=v(B,[["__scopeId","data-v-b31e39e4"]]);export{D as default};
