import{L as ot}from"./D8TODLEv.js";import{_ as it,y as rt,r as D,L as U,h as y,f as I,B as N,c as i,C as ut,p as x,F as g,a as e,m as c,n as w,t as r,i as b,v as S,D as A,k as h,J as P,e as T,g as dt,R as E,l as ct,X as pt,S as vt,o,K as ft,E as bt,G as mt}from"./J2eYMCAP.js";import{d as yt}from"./BcZQbp_F.js";const gt={class:"tabs-container print-hide"},kt={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},_t=["aria-selected"],ht={class:"badge"},Ct=["aria-selected"],xt={class:"badge"},wt=["aria-selected"],At={class:"tab-content"},Lt={id:"tab-content-lista",role:"tabpanel"},Dt={class:"text-center"},St={key:0},Tt={key:1},Vt={key:2},$t={key:3},Et={key:4},jt={id:"tab-content-filters",role:"tabpanel"},qt={class:"content"},Bt={class:"form-inline"},Ot={class:"form-group"},zt={class:"row"},Mt={class:"form-group"},Ft={class:"row"},Gt=["value"],Rt={class:"form-group"},Ut={class:"row"},It=["value"],Nt={class:"form-group"},Pt={class:"flex gap-xs"},Ht={class:"form-group"},Jt={class:"flex gap-xs"},Kt={class:"form-group",style:{"align-items":"flex-start"}},Wt=["id","value"],Xt=["for"],Yt={class:"form-group",style:{"text-align":"right"}},Qt=["disabled"],Zt={class:"form-inline",style:{gap:"1rem","margin-top":"1rem"}},te={id:"tab-content-print",role:"tabpanel"},ee={class:"a4 print-hide"},se={class:"settings-list"},le={class:"settings-list"},ne=["onClick"],ae={key:0,class:"print-page print-layout"},oe={class:"table-wrapper"},ie={colspan:"5",class:"text-center",style:{"text-transform":"uppercase"}},re=["onDblclick"],ue={key:0,class:"nowrap"},de={key:0},ce=["innerHTML"],pe={__name:"calendar",setup(ve){pt(l=>({"7b24e04e":L.value}));const{lista:k}=rt(),H=dt(),J=ct(),u=D("lista"),j=D(!1),L=D(1),s=U({search:"",title:"",locale:"",date:"",start:"",end:"",calendars:[]}),p=U({}),q=D([]),K=y(()=>({fontSize:`${L.value}rem`})),B=l=>l==null?void 0:l.replace(/-$/,"").trim(),V=l=>{if(!l)return"";const t=l.split("T")[0];return t?t.split("-").reverse().join("/"):""},$=(l,t)=>Array.from(new Set(l.map(a=>a[t]).filter(a=>typeof a=="string"&&a.trim()))),W=y(()=>$(m.value,"title")),X=y(()=>$(m.value,"locale")),Y=y(()=>$(k.allEvents,"list")),Q=()=>{const l=H.query||{};["search","title","locale","date","start","end"].forEach(v=>{l[v]!==void 0&&(s[v]=l[v])}),l.calendars&&(s.calendars=Array.isArray(l.calendars)?l.calendars:l.calendars.split(",").filter(Boolean));const{today:a,future:d}=E();s.start||(s.start=a),s.end||(s.end=d)},O=yt(()=>{const l=Object.fromEntries(Object.entries(s).filter(([t,a])=>t==="calendars"?a.length:a!==""&&a!=null).map(([t,a])=>Array.isArray(a)?[t,a.join(",")]:[t,a]));J.replace({query:l})},200),Z=()=>{O()};I(()=>{Q()}),N(s,O,{deep:!0});function C(l){if(l==="calendars")s.calendars=[];else if(l==="date"){s.date="";const{today:t,future:a}=E();s.start=t,s.end=a}else if(l==="start"||l==="end"){const{today:t,future:a}=E();s.start=t,s.end=a}else s[l]=""}const m=y(()=>{const l=vt(k.allEvents||[],s);return Array.from(new Set(l.map(a=>a.id))).map(a=>l.find(d=>d.id===a))}),tt=y(()=>{let l=0;return s.search&&l++,s.title&&l++,s.locale&&l++,s.date&&l++,s.calendars&&s.calendars.length>0&&l++,l}),et=()=>{u.value="lista",setTimeout(()=>{window.print()},1e3)},z=y(()=>{if(!m.value||!m.value.length)return[];const l=m.value.filter(a=>!["AVISOS À IRMANDADE"].includes(a.title)),t=new Map;for(const a of l||[]){if(!a.date)continue;const d=new Date(a.date),v=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}`,n=d.toLocaleDateString("pt-BR",{month:"long",year:"numeric"});t.has(v)||t.set(v,{month:n,items:[]}),t.get(v).items.push(a)}return Array.from(t.entries()).sort(([a],[d])=>a.localeCompare(d)).map(([a,{month:d,items:v}])=>({month:d,items:v.slice().sort((n,_)=>n.onDate-_.onDate)}))}),M=y(()=>{const l={};return m.value.forEach(t=>{const a=t.title||"Sem título";(l[a]||(l[a]=[])).push(t)}),Object.keys(l).map(t=>({title:t}))}),F=()=>{const l=Array.from(new Set(m.value.map(t=>t.title||"Sem título")));q.value=l},G=()=>{if(!M.value)return;const l=M.value.map(t=>t.title);l.forEach(t=>{t in p||(p[t]=!0)});for(const t in p)l.includes(t)||(p[t]=!1)};I(()=>{F(),G()}),N(m,()=>{F(),G()});const st=l=>{u.value="print",p[l]=!p[l]},R=y(()=>Object.values(p).length>0&&Object.values(p).every(Boolean)),lt=l=>{for(const t in p)p[t]=l},nt=y(()=>Object.values(p).filter(Boolean).length),at=l=>{const t=`https://www.google.com/calendar/event?eid=${l.htmlLink}`;window.open(t,"_blank")};return(l,t)=>{var d,v;const a=ot;return o(),i("div",null,[x(k).loading?(o(),ut(a,{key:0})):(o(),i(g,{key:1},[e("div",gt,[e("nav",kt,[e("span",{id:"tab-filters","aria-selected":u.value==="filters",role:"tab",type:"button",class:w(["tab",{active:u.value==="filters"}]),style:{position:"relative"},onClick:t[0]||(t[0]=n=>u.value="filters")},[e("span",ht,r(tt.value),1),t[18]||(t[18]=e("i",{class:"la la-filter z-10"},null,-1))],10,_t),e("span",{id:"tab-print","aria-selected":u.value==="print",role:"tab",type:"button",class:w(["tab",{active:u.value==="print"}]),onClick:t[1]||(t[1]=n=>u.value="print")},[e("span",xt,r(nt.value),1),t[19]||(t[19]=e("i",{class:"la la-print"},null,-1))],10,Ct),e("span",{id:"tab-lista","aria-selected":u.value==="lista",role:"tab",type:"button",class:w(["tab",{active:u.value==="lista"}]),onClick:t[2]||(t[2]=n=>u.value="lista")}," Calendário ",10,wt)])]),e("div",At,[b(e("div",Lt,[e("div",Dt,[t[20]||(t[20]=e("div",null,"CALENDÁRIO",-1)),s.calendars.length?(o(),i("div",St,[e("b",null,r(s.calendars.map(B).join(", ")),1)])):c("",!0),s.locale?(o(),i("span",Tt,[e("b",null,r(B(s.locale)),1)])):c("",!0),s.date?(o(),i("span",Vt," Data: "+r(V(s.date)),1)):c("",!0),!s.date&&(s.start||s.end)?(o(),i("div",$t," Período: "+r(V(s.start))+" à "+r(V(s.end)),1)):c("",!0),s.search?(o(),i("div",Et,r(s.search),1)):c("",!0)])],512),[[S,u.value==="lista"]]),b(e("div",jt,[e("div",qt,[e("div",Bt,[e("div",null,[e("div",Ot,[t[21]||(t[21]=e("label",{for:"search"},"Pesquisar",-1)),e("div",zt,[b(e("input",{id:"search","onUpdate:modelValue":t[3]||(t[3]=n=>s.search=n),type:"text",placeholder:"Buscar itens..."},null,512),[[A,s.search]]),s.search?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar pesquisa",type:"button",onClick:t[4]||(t[4]=n=>C("search"))}," × ")):c("",!0)])]),e("div",Mt,[t[23]||(t[23]=e("label",{for:"title"},"Título",-1)),e("div",Ft,[b(e("select",{id:"title","onUpdate:modelValue":t[5]||(t[5]=n=>s.title=n)},[t[22]||(t[22]=e("option",{value:""},"Todos os títulos",-1)),(o(!0),i(g,null,h(W.value,n=>(o(),i("option",{key:n,value:n},r(n),9,Gt))),128))],512),[[P,s.title]]),s.title?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar título",type:"button",onClick:t[6]||(t[6]=n=>C("title"))}," × ")):c("",!0)])]),e("div",Rt,[t[25]||(t[25]=e("label",{for:"locale"},"Local",-1)),e("div",Ut,[b(e("select",{id:"locale","onUpdate:modelValue":t[7]||(t[7]=n=>s.locale=n)},[t[24]||(t[24]=e("option",{value:""},"Todos os locais",-1)),(o(!0),i(g,null,h(X.value,n=>(o(),i("option",{key:n,value:n},r(n),9,It))),128))],512),[[P,s.locale]]),s.locale?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar local",type:"button",onClick:t[8]||(t[8]=n=>C("locale"))}," × ")):c("",!0)])]),e("div",Nt,[t[26]||(t[26]=e("label",{for:"date"},"Data",-1)),e("div",Pt,[b(e("input",{id:"date","onUpdate:modelValue":t[9]||(t[9]=n=>s.date=n),type:"date"},null,512),[[A,s.date]]),s.date?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar data",type:"button",onClick:t[10]||(t[10]=n=>C("date"))}," × ")):c("",!0)])]),e("div",Ht,[t[27]||(t[27]=e("label",null,"Intervalo de Datas",-1)),e("div",Jt,[b(e("input",{"onUpdate:modelValue":t[11]||(t[11]=n=>s.start=n),type:"date"},null,512),[[A,s.start]]),b(e("input",{"onUpdate:modelValue":t[12]||(t[12]=n=>s.end=n),type:"date"},null,512),[[A,s.end]]),s.start||s.end?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar datas",type:"button",onClick:t[13]||(t[13]=n=>C("date"))}," × ")):c("",!0)])])]),e("div",null,[e("div",Kt,[t[28]||(t[28]=e("label",null,"Agendas",-1)),e("div",null,[(o(!0),i(g,null,h(Y.value,n=>(o(),i("div",{key:n},[b(e("input",{id:"cat-"+n,"onUpdate:modelValue":t[14]||(t[14]=_=>s.calendars=_),type:"checkbox",value:n,style:{margin:"5px 5px 0 0"}},null,8,Wt),[[ft,s.calendars]]),e("label",{for:"cat-"+n,style:{"margin-bottom":"0"}},r(n),9,Xt)]))),128))])]),e("div",Yt,[t[29]||(t[29]=e("label",null,null,-1)),e("button",{class:"success",disabled:j.value||x(k).loading,onClick:t[15]||(t[15]=n=>Z())},r(j.value||x(k).loading?"Atualizando...":"Aplicar"),9,Qt)])])]),e("div",Zt,[e("span",null,[t[30]||(t[30]=e("i",{class:"la la-calendar-check"},null,-1)),T(" "+r(((v=(d=x(k))==null?void 0:d.calendars)==null?void 0:v.length)||0),1)]),e("span",null,[t[31]||(t[31]=e("i",{class:"la la-tasks"},null,-1)),T(" "+r(Array.isArray(m.value)?m.value.length:0),1)])])])],512),[[S,u.value==="filters"]]),b(e("div",te,[e("div",{class:"text-center flex col items-center gap-4"},[t[33]||(t[33]=e("b",{class:"mb-4 p"},"Ajustes de impressão:",-1)),e("div",{class:"p"},[e("button",{class:"success",onClick:et},t[32]||(t[32]=[e("i",{class:"la la-print"},null,-1),T(" Imprimir ")]))])]),e("div",ee,[e("div",se,[t[34]||(t[34]=e("b",null,"Tamanho da Fonte",-1)),b(e("input",{type:"range","onUpdate:modelValue":t[16]||(t[16]=n=>L.value=n),min:"0.8",max:"1.6",step:"0.1"},null,512),[[A,L.value]])]),e("div",le,[t[35]||(t[35]=e("b",null,"Lista",-1)),e("div",null,[e("i",{class:w(["la",R.value?"la-toggle-on":"la-toggle-off"]),title:"Ocultar todos",onClick:t[17]||(t[17]=n=>lt(!R.value))},null,2)])]),(o(!0),i(g,null,h(q.value,n=>(o(),i("div",{key:n,class:"settings-list print-hide",onClick:_=>st(n)},[T(r(n)+" ",1),e("i",{class:w(["la",p[n]?"la-toggle-on":"la-toggle-off"]),title:"Alterar visibilidade"},null,2)],8,ne))),128))])],512),[[S,u.value==="print"]])]),z.value.length?(o(),i("div",ae,[(o(!0),i(g,null,h(z.value,({month:n,items:_})=>(o(),i("div",{key:n,class:"month-section"},[e("div",oe,[e("table",{style:bt(K.value)},[e("thead",null,[e("tr",null,[e("th",ie,r(n),1)])]),e("tbody",null,[(o(!0),i(g,null,h(_,f=>b((o(),i("tr",{key:f.id,onDblclick:fe=>at(f)},[e("td",null,[f.formatDate?(o(),i("span",ue,r(f.formatDate.split("/")[0])+" | "+r(f.formatWeek),1)):c("",!0)]),e("td",null,[f.formatTime?(o(),i("span",de,r(f.formatTime),1)):c("",!0)]),e("td",null,r(f.locale),1),e("td",null,r(f.title),1),e("td",null,[f.desc?(o(),i("span",{key:0,innerHTML:x(mt)(f.desc)},null,8,ce)):c("",!0)])],40,re)),[[S,p[f.title||"Sem título"]]])),128))])],4)])]))),128))])):c("",!0)],64))])}}},ge=it(pe,[["__scopeId","data-v-9928d777"]]);export{ge as default};
