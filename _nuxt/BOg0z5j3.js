import{L as rt}from"./ll__0O3Z.js";import{_ as ut,u as dt,r as y,y as W,h as b,f as K,z as w,Q as ct,c as i,A as Q,l as L,F as g,a as e,p as c,n as k,t as u,i as v,v as V,C as I,B as A,k as _,H as J,e as q,g as pt,R as O,m as vt,S as ft,o,I as mt,L as X,D as bt}from"./BT_qbqAD.js";import{a as gt,S as yt,E as kt}from"./Bjj_46eH.js";import{d as _t}from"./BcZQbp_F.js";const Dt={class:"tabs-container print-hide"},ht={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},Ct=["aria-selected"],St={class:"badge"},Tt=["aria-selected"],Lt={class:"badge"},$t=["aria-selected"],xt={class:"tab-content"},Et={id:"tab-content-lista",role:"tabpanel"},At={key:0},qt={key:1},wt={key:2},Vt={key:3},zt={key:4},jt={id:"tab-content-filters",role:"tabpanel"},It={class:"content"},Ot={class:"form-inline"},Bt={class:"form-group"},Ut={class:"row"},Ft={class:"form-group"},Gt={class:"row"},Mt=["value"],Rt={class:"form-group"},Nt={class:"row"},Pt=["value"],Ht={class:"form-group"},Wt={class:"flex gap-xs"},Kt={class:"form-group"},Qt={class:"flex gap-xs"},Jt={class:"form-group",style:{"align-items":"flex-start"}},Xt=["id","value"],Yt=["for"],Zt={class:"form-group",style:{"text-align":"right"}},te=["disabled"],ee={class:"form-inline",style:{gap:"1rem","margin-top":"1rem"}},le={id:"tab-content-print",role:"tabpanel"},se={class:"a4 print-hide"},ne={class:"settings-list"},ae={id:"fontSteps"},oe=["value"],ie={class:"settings-list print-hide"},re=["onDragstart","onDragover","onDrop","onClick"],ue={key:0,class:"print-page"},de=["onDragstart","onDragover","onDrop"],ce={colspan:"5"},pe={class:"flex items-center aling-center justify-center"},ve=["onClick"],fe=["onDblclick"],me={key:0},be={key:0},ge={key:0},ye=["innerHTML"],ke={__name:"index",setup(_e){const{lista:D}=dt(),p=y("lista"),n=W({search:"",title:"",locale:"",date:"",start:"",end:"",calendars:[]}),h=y(1),z=pt(),B=vt(),U=y(!1),Y=()=>{const s=z.query||{};["search","title","locale","date","start","end"].forEach(r=>{s[r]!==void 0&&(n[r]=s[r])}),s.calendars&&(n.calendars=Array.isArray(s.calendars)?s.calendars:s.calendars.split(",").filter(Boolean));const{today:a,future:l}=O();n.start||(n.start=a),n.end||(n.end=l)},F=_t(()=>{const s=Object.fromEntries(Object.entries(n).filter(([t,a])=>t==="calendars"?a.length:a!==""&&a!=null).map(([t,a])=>Array.isArray(a)?[t,a.join(",")]:[t,a]));B.replace({query:s})},200),C=b(()=>{const s=ft(D.allEvents||[],n);return Array.from(new Set(s.map(a=>a.id))).map(a=>s.find(l=>l.id===a))});function Z(){F()}K(()=>{Y()}),w([n,h],F,{deep:!0});function $(s){if(s==="calendars")n.calendars=[];else if(s==="date"){n.date="";const{today:t,future:a}=O();n.start=t,n.end=a}else if(s==="start"||s==="end"){const{today:t,future:a}=O();n.start=t,n.end=a}else n[s]=""}function j(s,t){return Array.from(new Set(s.map(a=>a[t]).filter(a=>typeof a=="string"&&a.trim())))}const tt=b(()=>j(C.value,"title")),et=b(()=>j(C.value,"locale")),lt=b(()=>j(D.allEvents,"list")),S=y([]);w(C,s=>{const t=Array.from(new Set(s.map(r=>r.title||"Sem título"))),l=(z.query.order?.split(",").filter(Boolean)||[]).filter(r=>t.includes(r));t.forEach(r=>{l.includes(r)||l.push(r)}),S.value=l},{immediate:!0}),w(S,s=>{const t={...z.query};s&&s.length>0?t.order=s.join(","):delete t.order,B.replace({query:t})});const m=b(()=>{const s={};return C.value.forEach(t=>{const a=t.title||"Sem título";(s[a]||=[]).push(t)}),S.value.filter(t=>s[t]).map(t=>({title:t,items:s[t].slice().sort((a,l)=>a.onDate&&l.onDate?a.onDate-l.onDate:0)}))}),G=s=>s?.replace(/-$/,"")?.trim(),st=b(()=>{let s=0;return n.search&&s++,n.title&&s++,n.locale&&s++,n.date&&s++,n.calendars&&n.calendars.length>0&&s++,s}),nt=()=>{p.value="lista",setTimeout(()=>{window.print()},1e3)},T=y(null),x=y(null),M=s=>{T.value=s},R=s=>{x.value=s},N=s=>{if(T.value===null||T.value===s){T.value=null,x.value=null;return}const t=[...S.value],[a]=t.splice(T.value,1);t.splice(s,0,a),S.value=t,T.value=null,x.value=null},f=W({});w(m,()=>{if(!m.value)return;const s=m.value.map(t=>t.title);s.forEach(t=>{t in f||(f[t]=!0)});for(const t in f)s.includes(t)||delete f[t]},{immediate:!0});const P=s=>{p.value="print",f[s]=!f[s]},H=b(()=>m.value.length>0&&m.value.every(s=>f[s.title])),at=s=>{m.value.forEach(t=>{f[t.title]=s})},ot=s=>{const t=`https://www.google.com/calendar/event?eid=${s.htmlLink}`;window.open(t,"_blank")},E=y(null),it=b(()=>Object.values(f).filter(Boolean).length);return K(()=>{E.value=new gt({extensions:[yt],content:`
      <p>Oração Santa Ceia</p>
      <p><strong>Pão:</strong> "Senhor, abençoa este Pão que vamos comer, que é a comunhão do Corpo de Cristo."</p>
      <p><strong>Cálice:</strong> "Senhor, abençoa o Cálice que vamos beber, que é a comunhão do Sangue de Cristo."</p>
    `,editable:!0})}),ct(()=>{E.value&&E.value.destroy()}),(s,t)=>{const a=rt;return o(),i("div",null,[L(D).loading?(o(),Q(a,{key:0})):(o(),i(g,{key:1},[e("div",Dt,[e("nav",ht,[e("span",{id:"tab-filters","aria-selected":p.value==="filters",role:"tab",type:"button",class:k(["tab",{active:p.value==="filters"}]),style:{position:"relative"},onClick:t[0]||(t[0]=l=>p.value="filters")},[e("span",St,u(st.value),1),t[18]||(t[18]=e("i",{class:"la la-filter z-10"},null,-1))],10,Ct),e("span",{id:"tab-print","aria-selected":p.value==="print",role:"tab",type:"button",class:k(["tab",{active:p.value==="print"}]),onClick:t[1]||(t[1]=l=>p.value="print")},[e("span",Lt,u(it.value),1),t[19]||(t[19]=e("i",{class:"la la-print"},null,-1))],10,Tt),e("span",{id:"tab-lista","aria-selected":p.value==="lista",role:"tab",type:"button",class:k(["tab",{active:p.value==="lista"}]),onClick:t[2]||(t[2]=l=>p.value="lista")}," Lista ",10,$t)])]),e("div",null,[e("div",xt,[v(e("div",Et,[e("div",{class:"text-center",style:I({fontSize:h.value+"em"})},[t[20]||(t[20]=e("div",null,"LISTA DE ATENDIMENTO E DIVERSOS",-1)),n.calendars.length?(o(),i("div",At,[e("b",null,u(n.calendars.map(G).join(", ")),1)])):c("",!0),n.locale?(o(),i("span",qt,[e("b",null,u(G(n.locale)),1)])):c("",!0),n.date?(o(),i("span",wt," Data: "+u(n.date?.split("T")[0]?.split("-")?.reverse()?.join("/")),1)):c("",!0),!n.date&&(n.start||n.end)?(o(),i("div",Vt," Período: "+u(n.start?.split("T")[0]?.split("-")?.reverse()?.join("/"))+" à "+u(n.end?.split("T")[0]?.split("-")?.reverse()?.join("/")),1)):c("",!0),n.search?(o(),i("div",zt,u(n.search),1)):c("",!0)],4)],512),[[V,p.value==="lista"]]),v(e("div",jt,[e("div",It,[e("div",Ot,[e("div",null,[e("div",Bt,[t[21]||(t[21]=e("label",{for:"search"},"Pesquisar",-1)),e("div",Ut,[v(e("input",{id:"search","onUpdate:modelValue":t[3]||(t[3]=l=>n.search=l),type:"text",placeholder:"Buscar itens..."},null,512),[[A,n.search]]),n.search?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar pesquisa",type:"button",onClick:t[4]||(t[4]=l=>$("search"))}," × ")):c("",!0)])]),e("div",Ft,[t[23]||(t[23]=e("label",{for:"title"},"Título",-1)),e("div",Gt,[v(e("select",{id:"title","onUpdate:modelValue":t[5]||(t[5]=l=>n.title=l)},[t[22]||(t[22]=e("option",{value:""},"Todos os títulos",-1)),(o(!0),i(g,null,_(tt.value,l=>(o(),i("option",{key:l,value:l},u(l),9,Mt))),128))],512),[[J,n.title]]),n.title?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar título",type:"button",onClick:t[6]||(t[6]=l=>$("title"))}," × ")):c("",!0)])]),e("div",Rt,[t[25]||(t[25]=e("label",{for:"locale"},"Local",-1)),e("div",Nt,[v(e("select",{id:"locale","onUpdate:modelValue":t[7]||(t[7]=l=>n.locale=l)},[t[24]||(t[24]=e("option",{value:""},"Todos os locais",-1)),(o(!0),i(g,null,_(et.value,l=>(o(),i("option",{key:l,value:l},u(l),9,Pt))),128))],512),[[J,n.locale]]),n.locale?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar local",type:"button",onClick:t[8]||(t[8]=l=>$("locale"))}," × ")):c("",!0)])]),e("div",Ht,[t[26]||(t[26]=e("label",{for:"date"},"Data",-1)),e("div",Wt,[v(e("input",{id:"date","onUpdate:modelValue":t[9]||(t[9]=l=>n.date=l),type:"date"},null,512),[[A,n.date]]),n.date?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar data",type:"button",onClick:t[10]||(t[10]=l=>$("date"))}," × ")):c("",!0)])]),e("div",Kt,[t[27]||(t[27]=e("label",null,"Intervalo de Datas",-1)),e("div",Qt,[v(e("input",{"onUpdate:modelValue":t[11]||(t[11]=l=>n.start=l),type:"date"},null,512),[[A,n.start]]),v(e("input",{"onUpdate:modelValue":t[12]||(t[12]=l=>n.end=l),type:"date"},null,512),[[A,n.end]]),n.start||n.end?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar datas",type:"button",onClick:t[13]||(t[13]=l=>$("date"))}," × ")):c("",!0)])])]),e("div",null,[e("div",Jt,[t[28]||(t[28]=e("label",null,"Agendas",-1)),e("div",null,[(o(!0),i(g,null,_(lt.value,l=>(o(),i("div",{key:l},[v(e("input",{id:"cat-"+l,"onUpdate:modelValue":t[14]||(t[14]=r=>n.calendars=r),type:"checkbox",value:l,style:{margin:"5px 5px 0 0"}},null,8,Xt),[[mt,n.calendars]]),e("label",{for:"cat-"+l,style:{"margin-bottom":"0"}},u(l),9,Yt)]))),128))])]),e("div",Zt,[t[29]||(t[29]=e("label",null,null,-1)),e("button",{class:"success",disabled:U.value||L(D).loading,onClick:t[15]||(t[15]=l=>Z())},u(U.value||L(D).loading?"Atualizando...":"Aplicar"),9,te)])])]),e("div",ee,[e("span",null,[t[30]||(t[30]=e("i",{class:"la la-calendar-check"},null,-1)),q(" "+u(L(D)?.calendars?.length||0),1)]),e("span",null,[t[31]||(t[31]=e("i",{class:"la la-tasks"},null,-1)),q(" "+u(Array.isArray(C.value)?C.value.length:0),1)])])])],512),[[V,p.value==="filters"]]),v(e("div",le,[e("div",{class:"text-center flex col items-center gap-4"},[t[33]||(t[33]=e("b",{class:"mb-4 p"},"Ajustes de impressão:",-1)),e("div",{class:"p"},[e("button",{class:"success",onClick:nt},t[32]||(t[32]=[e("i",{class:"la la-print"},null,-1),q(" Imprimir ",-1)]))])]),e("div",se,[e("div",ne,[t[34]||(t[34]=e("b",null,"Tamanho da Fonte",-1)),v(e("input",{id:"fontSizeSlider",type:"range","onUpdate:modelValue":t[16]||(t[16]=l=>h.value=l),min:"0.5",max:"1.6",step:"0.05",list:"fontSteps"},null,512),[[A,h.value,void 0,{number:!0}]]),e("datalist",ae,[(o(),i(g,null,_(15,l=>e("option",{key:l,value:(l*.1).toFixed(1)},null,8,oe)),64))])]),e("div",ie,[t[35]||(t[35]=e("b",null,"Lista",-1)),e("div",null,[e("i",{class:k(["la",H.value?"la-toggle-on":"la-toggle-off"]),title:"Ocultar todos",onClick:t[17]||(t[17]=l=>at(!H.value))},null,2)])]),(o(!0),i(g,null,_(S.value,(l,r)=>(o(),i("div",{key:l,class:k(["settings-list print-hide",{"drag-over":x.value===r}]),draggable:"true",onDragstart:d=>M(r),onDragover:X(d=>R(r),["prevent"]),onDrop:d=>N(r),onClick:d=>P(l)},[q(u(l)+" ",1),e("i",{class:k(["la",f[l]?"la-toggle-on":"la-toggle-off"]),title:"Alterar visibilidade"},null,2)],42,re))),128))])],512),[[V,p.value==="print"]])])]),m.value.length?(o(),i("div",ue,[(o(!0),i(g,null,_(m.value,(l,r)=>v((o(),i("div",{key:l.title,class:k(["table-list",{"drag-over":x.value===r}]),draggable:"true",style:{cursor:"move"},onDragstart:d=>M(r),onDragover:X(d=>R(r),["prevent"]),onDrop:d=>N(r)},[e("div",{class:"table-container",style:I({fontSize:h.value+"em"})},[e("table",null,[e("thead",null,[e("tr",null,[e("th",ce,[e("div",pe,[q(u(l.title)+" ",1),e("i",{class:"la la-toggle-on print-hide",style:{cursor:"pointer"},onClick:d=>P(l.title)},null,8,ve)])])])]),e("tbody",null,[(o(!0),i(g,null,_(l.items,d=>(o(),i("tr",{key:d.id,onDblclick:he=>ot(d)},[e("td",null,[d.formatDate?(o(),i("span",me,u(d.formatDate),1)):c("",!0)]),e("td",null,[d.formatWeek?(o(),i("span",be,u(d.formatWeek),1)):c("",!0)]),e("td",null,[d.formatTime?(o(),i("span",ge,u(d.formatTime),1)):c("",!0)]),e("td",null,u(d.locale),1),e("td",null,[d.desc?(o(),i("span",{key:0,innerHTML:L(bt)(d.desc)},null,8,ye)):c("",!0)])],40,fe))),128))])])],4)],42,de)),[[V,f[l.title]]])),128)),E.value?(o(),Q(L(kt),{key:0,editor:E.value,class:"editable",style:I({fontSize:h.value+"em"})},null,8,["editor","style"])):c("",!0)])):c("",!0)],64))])}}},$e=ut(ke,[["__scopeId","data-v-201c73f1"]]);export{$e as default};
