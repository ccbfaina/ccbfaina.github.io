import{L as re}from"./B7S8XWMP.js";import{_ as ue,u as ce,r as p,y as ie,h as _,z as E,c as l,A as de,a,t as f,F as m,k as y,e as I,i as he,B as ve,g as ge,C as fe,o,n as q,p as X,D as x,l as pe,E as me}from"./CMPFHgJK.js";const ye={key:1,class:"calendar-wrapper"},_e={class:"calendar-header"},De={class:"month-year"},Ce={class:"calendar-table"},be=["onClick"],ke={class:"day-content"},Me={class:"day-number"},Te={key:0,class:"event-indicators"},we={class:"events-panel"},Se={class:"events-list-container"},Ee={class:"chips-container"},xe={key:0,class:"las la-toggle-on"},Ne={key:1,class:"las la-toggle-off"},Ue=["onClick"],Fe={key:0,class:"las la-toggle-on"},Ae={key:1,class:"las la-toggle-off"},Ge={class:"search-container"},Ye={key:0},$e={class:"event-date-title"},Pe={class:"events-list"},ze={class:"sub-events-list"},Oe=["onClick"],Le=["innerHTML"],Re={key:1,class:"no-events-message"},J="agenda_selected_groups",V=50,Be={__name:"agenda",setup(Ie){const{lista:D}=ce(),N=ge(),U=p(!0),u=ie({search:"",title:"",locale:"",date:"",start:"",end:"",calendars:[],groups:[]});(()=>{const e=N.query||{};["search","title","locale","date","start","end"].forEach(s=>{e[s]!==void 0&&(u[s]=e[s])}),e.calendars&&(u.calendars=Array.isArray(e.calendars)?e.calendars:e.calendars.split(",").filter(Boolean)),e.groups&&(u.groups=Array.isArray(e.groups)?e.groups:e.groups.split(",").filter(Boolean))})();const k=new Date,d=p(k.getMonth()),g=p(k.getFullYear()),h=p(null),C=_(()=>Array.from(new Set(D.allEvents.map(e=>e.group))).filter(e=>e).sort((e,t)=>e.localeCompare(t))),F=_(()=>u.groups.length===C.value.length);function H(){localStorage.setItem(J,JSON.stringify(u.groups))}function K(){const e=localStorage.getItem(J);return e?JSON.parse(e):null}E(C,e=>{if(u.groups.length)return;const t=K();t&&t.length>0?u.groups=t.filter(s=>e.includes(s)):u.groups=e.filter(s=>s!=="Rodízios")},{immediate:!0}),E(u.groups,()=>{H()},{deep:!0});function Q(e){const t=u.groups.indexOf(e);t===-1?u.groups.push(e):u.groups.splice(t,1)}function j(){F.value?u.groups=[]:u.groups=[...C.value]}const M=_(()=>{const e=u.search.trim();let t=fe(D.allEvents||[],u);if(N.query.next==="true"){const n=new Date;t=t.filter(c=>new Date(c.date)>n)}return t=t.filter(n=>u.groups.includes(n.group)),t}),A=_(()=>{let e;if(h.value){const s=h.value.date;e=M.value.filter(n=>{const c=new Date(n.date);return c.getUTCFullYear()===s.getFullYear()&&c.getUTCMonth()===s.getMonth()&&c.getUTCDate()===s.getDate()})}else e=M.value.filter(s=>{const n=new Date(s.date);return n.getUTCFullYear()===g.value&&n.getUTCMonth()===d.value});const t=new Map;for(const s of e){const c=new Date(s.date).toISOString().split("T")[0];t.has(c)||t.set(c,new Map);const i=t.get(c);i.has(s.title)||i.set(s.title,[]),i.get(s.title).push(s)}return Array.from(t.entries()).sort(([s],[n])=>new Date(s)-new Date(n))}),G=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],W=_(()=>`${G[d.value]} ${g.value}`),Z=_(()=>{const e=[],t=new Date(g.value,d.value,1).getDay(),s=new Date(g.value,d.value+1,0).getDate(),n=new Date(g.value,d.value,0).getDate();for(let r=t-1;r>=0;r--)e.push({dayNumber:n-r,isPrevMonth:!0,isNextMonth:!1,isToday:!1,hasEvent:!1,events:[]});for(let r=1;r<=s;r++){const v=new Date(g.value,d.value,r),w=M.value.filter(le=>{const S=new Date(le.date);return S.getUTCDate()===r&&S.getUTCMonth()===d.value&&S.getUTCFullYear()===g.value});e.push({dayNumber:r,date:v,isPrevMonth:!1,isNextMonth:!1,isToday:v.toDateString()===k.toDateString(),hasEvent:w.length>0,events:w})}const c=42-e.length;for(let r=1;r<=c;r++)e.push({dayNumber:r,isPrevMonth:!1,isNextMonth:!0,isToday:!1,hasEvent:!1,events:[]});const i=[];for(;e.length>0;)i.push(e.splice(0,7));return i});function ee(e){const t=new Date(e),s=t.getUTCDate(),n=G[t.getUTCMonth()],c=t.getUTCFullYear();return`${s} de ${n} de ${c}`}function b(e){d.value+=e,d.value<0?(d.value=11,g.value--):d.value>11&&(d.value=0,g.value++),h.value=null}function te(e){return{"prev-month-day":e.isPrevMonth||e.isNextMonth,today:e.isToday,"has-event":e.hasEvent,"selected-day":h.value&&h.value.date&&e.date&&h.value.date.toDateString()===e.date.toDateString()}}function ne(e){!e.isPrevMonth&&!e.isNextMonth&&(h.value&&h.value.date.toDateString()===e.date.toDateString()?h.value=null:h.value=e)}function se(e){return h.value?e.some(t=>{const s=new Date(t.date),n=h.value.date;return s.getUTCFullYear()===n.getFullYear()&&s.getUTCMonth()===n.getMonth()&&s.getUTCDate()===n.getDate()}):!1}const ae=e=>{const t=`https://www.google.com/calendar/event?eid=${e.htmlLink}`;window.open(t,"_blank")};function oe(e){const t=new Set;for(const s of e)s.group&&t.add(s.group);return[...t]}const Y=["#d6b8c1","#d1c965","#cdb8d1","#aed4d7","#b3a9a5","a9c6aa","#d39a8f","#b0a2cc","#d28fa9","#b2d29f","#d1b05e","#84c9cc","#d1be83","#92c2be","#a3b1b5","#bdc75d"],$={Reuniões:"#c4d7b9",Atendimentos:"#b4d0e3",Rodízios:"#e6b97f",Outros:"#c3bfe0"},T=p({});function P(e){if($[e])return $[e];if(!T.value[e]){const s=Array.from(new Set(D.allEvents.map(n=>n.group).filter(n=>n!==null))).indexOf(e);T.value[e]=Y[s%Y.length]}return T.value[e]}function z(e){return{backgroundColor:P(e)}}E(()=>D.allEvents,e=>{e&&e.length>0&&(U.value=!1)},{immediate:!0});const O=p(0),L=p(0);function R(e){O.value=e.touches?e.touches[0].clientX:e.clientX}function B(e){L.value=e.changedTouches?e.changedTouches[0].clientX:e.clientX;const t=L.value-O.value;t>V?b(-1):t<-V&&b(1)}return(e,t)=>{const s=re;return o(),l("div",null,[U.value?(o(),de(s,{key:0})):(o(),l("div",ye,[a("div",{class:"calendar-panel",onTouchstart:R,onTouchend:B,onMousedown:R,onMouseup:B},[a("div",_e,[a("i",{class:"las la-chevron-left",onClick:t[0]||(t[0]=n=>b(-1))}),a("h2",De,f(W.value),1),a("i",{class:"las la-chevron-right",onClick:t[1]||(t[1]=n=>b(1))})]),a("table",Ce,[t[3]||(t[3]=a("thead",null,[a("tr",null,[a("th",null,"Dom"),a("th",null,"Seg"),a("th",null,"Ter"),a("th",null,"Qua"),a("th",null,"Qui"),a("th",null,"Sex"),a("th",null,"Sáb")])],-1)),a("tbody",null,[(o(!0),l(m,null,y(Z.value,(n,c)=>(o(),l("tr",{key:c},[(o(!0),l(m,null,y(n,i=>(o(),l("td",{key:i.date,class:q(te(i)),onClick:r=>ne(i)},[a("div",ke,[a("div",Me,f(i.dayNumber),1),i.events.length?(o(),l("div",Te,[(o(!0),l(m,null,y(oe(i.events),r=>(o(),l("span",{key:r,class:"event-indicator",style:x({backgroundColor:P(r)})},null,4))),128))])):X("",!0)])],10,be))),128))]))),128))])])],32),a("div",we,[a("div",Se,[a("div",Ee,[a("span",{class:"chip",onClick:j},[F.value?(o(),l("i",xe)):(o(),l("i",Ne)),t[4]||(t[4]=I(" Todos ",-1))]),(o(!0),l(m,null,y(C.value,n=>(o(),l("span",{key:n,class:"chip",style:x(z(n)),onClick:c=>Q(n)},[u.groups.includes(n)?(o(),l("i",Fe)):(o(),l("i",Ae)),I(" "+f(n),1)],12,Ue))),128))]),a("div",Ge,[he(a("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>u.search=n),type:"text",placeholder:"Buscar eventos...",class:"search-input"},null,512),[[ve,u.search]]),t[5]||(t[5]=a("i",{class:"las la-search search-icon"},null,-1))]),Object.keys(A.value).length?(o(),l("div",Ye,[(o(!0),l(m,null,y(A.value,([n,c])=>(o(),l("div",{key:n},[a("h4",$e,f(ee(n)),1),a("ul",Pe,[(o(!0),l(m,null,y(c,([i,r])=>(o(),l("li",{key:i,class:q({"selected-event":se(r)}),style:x(z(r[0].group))},[a("strong",null,f(i),1),a("ul",ze,[(o(!0),l(m,null,y(r,v=>(o(),l("li",{key:v.id,onClick:w=>ae(v)},[a("p",null,[a("b",null,[a("i",null,f(v.formatTime)+f(v.formatTime?" - ":"")+f(v.formatDate),1)])]),a("p",null,f(v.locale),1),v.desc?(o(),l("p",{key:0,innerHTML:pe(me)(v.desc)},null,8,Le)):X("",!0)],8,Oe))),128))])],6))),128))])]))),128))])):(o(),l("p",Re,"Nenhum evento agendado."))])])]))])}}},Ve=ue(Be,[["__scopeId","data-v-936f4c26"]]);export{Ve as default};
