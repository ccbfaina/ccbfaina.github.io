import{L as ct}from"./DlGeDFYH.js";import{_ as vt,u as pt,r as b,y as K,o as W,z as E,j as C,Q as ft,c as r,A as Q,F as y,a as e,s as c,q as _,t as d,k as f,v as A,D as O,B as q,m as S,I as J,f as L,n as X,i as bt,R as B,p as mt,b as o,K as Y,E as gt}from"./Cy8TwrjR.js";import{a as yt,S as _t,E as kt}from"./CXc4witT.js";import{d as Z}from"./BcZQbp_F.js";const Dt={class:"tabs-container print-hide"},ht={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},Ct=["aria-selected"],St={class:"badge"},Tt=["aria-selected"],$t={class:"badge"},xt=["aria-selected"],Et={class:"tab-content"},qt={id:"tab-content-lista",role:"tabpanel"},At={key:0},Lt={key:1},Vt={key:2},wt={key:3},zt={key:4},jt={id:"tab-content-filters",role:"tabpanel"},Ot={class:"content"},Bt={class:"form-inline"},Ft={class:"form-group"},It={class:"row"},Ut={class:"form-group"},Gt={class:"row"},Mt=["value"],Rt={class:"form-group"},Nt={class:"row"},Pt=["value"],Ht={class:"form-group"},Kt={class:"flex gap-xs"},Wt={class:"form-group"},Qt={class:"flex gap-xs"},Jt={class:"form-group",style:{"text-align":"right"}},Xt=["disabled"],Yt={class:"form-inline",style:{gap:"1rem","margin-top":"1rem"}},Zt={id:"tab-content-print",role:"tabpanel"},te={class:"a4 print-hide"},ee={class:"settings-list"},le={id:"fontSteps"},se=["value"],ne={class:"settings-list print-hide"},ae=["onDragstart","onDragover","onDrop","onClick"],oe={key:0,class:"print-page"},re=["onDragstart","onDragover","onDrop"],ie={colspan:"5"},ue={class:"flex items-center aling-center justify-center"},de=["onClick"],ce=["onClick"],ve={key:0},pe={key:0},fe={key:0},be=["innerHTML"],me={__name:"index",setup(ge){const{$sw:F}=pt(),g=b([]),v=b("lista"),n=K({search:"",title:"",locale:"",date:"",start:"",end:"",calendars:[]}),k=b(1),V=bt(),w=mt(),z=b(!1),tt=()=>{const s=V.query||{};["search","title","locale","date","start","end"].forEach(i=>{s[i]!==void 0&&(n[i]=s[i])}),s.calendars&&(n.calendars=Array.isArray(s.calendars)?s.calendars:s.calendars.split(",").filter(Boolean));const{today:a,future:l}=B();n.start||(n.start=a),n.end||(n.end=l)},I=Z(()=>{const s=Object.fromEntries(Object.entries(n).filter(([t,a])=>t==="calendars"?a.length:a!==""&&a!=null).map(([t,a])=>Array.isArray(a)?[t,a.join(",")]:[t,a]));w.replace({query:s})},200);function et(){I()}W(()=>{tt()}),E([n,k],I,{deep:!0});function T(s){if(s==="calendars")n.calendars=[];else if(s==="date"){n.date="";const{today:t,future:a}=B();n.start=t,n.end=a}else if(s==="start"||s==="end"){const{today:t,future:a}=B();n.start=t,n.end=a}else n[s]=""}function U(s,t){return Array.from(new Set(s.map(a=>a[t]).filter(a=>typeof a=="string"&&a.trim())))}const lt=C(()=>U(g.value,"title")),st=C(()=>U(g.value,"locale")),nt=b([]),D=b([]),j=b([]),at=Z(async()=>{const{events:s,calendars:t}=await F.getEvents(n)||[];j.value=await F.getTitles()||[],g.value=s,nt.value=t},400);E(()=>n,async()=>{n.start&&at()},{immediate:!0,deep:!0}),E(g,s=>{const t=Array.from(new Set(s.map(i=>i.title||"Sem título"))),l=(V.query.order?.split(",").filter(Boolean)||[]).filter(i=>t.includes(i));t.forEach(i=>{l.includes(i)||l.push(i)}),D.value=l},{immediate:!0}),E(D,s=>{const t={...V.query};s&&s.length>0?t.order=s.join(","):delete t.order,w.replace({query:t})});const m=C(()=>{const s={};return g.value.forEach(a=>{const l=a.title||"Sem título";(s[l]||=[]).push(a)}),D.value.slice().sort((a,l)=>{const i=j.value.indexOf(a),u=j.value.indexOf(l);return i===-1&&u===-1?0:i===-1?1:u===-1?-1:i-u}).filter(a=>s[a]).map(a=>({title:a,items:s[a].slice().sort((l,i)=>l.onDate&&i.onDate?l.onDate-i.onDate:0)}))}),G=s=>s?.replace(/-$/,"")?.trim(),ot=C(()=>{let s=0;return n.search&&s++,n.title&&s++,n.locale&&s++,n.date&&s++,n.calendars&&n.calendars.length>0&&s++,s}),rt=()=>{v.value="lista",setTimeout(()=>{window.print()},1e3)},h=b(null),$=b(null),M=s=>{h.value=s},R=s=>{$.value=s},N=s=>{if(h.value===null||h.value===s){h.value=null,$.value=null;return}const t=[...D.value],[a]=t.splice(h.value,1);t.splice(s,0,a),D.value=t,h.value=null,$.value=null},p=K({});E(m,()=>{if(!m.value)return;const s=m.value.map(t=>t.title);s.forEach(t=>{t in p||(p[t]=!0)});for(const t in p)s.includes(t)||delete p[t]},{immediate:!0});const P=s=>{v.value="print",p[s]=!p[s]},H=C(()=>m.value.length>0&&m.value.every(s=>p[s.title])),it=s=>{m.value.forEach(t=>{p[t.title]=s})},x=b(null),ut=C(()=>Object.values(p).filter(Boolean).length);W(()=>{x.value=new yt({extensions:[_t],content:`
      <p>Oração Santa Ceia</p>
      <p><strong>Pão:</strong> "Senhor, abençoa este Pão que vamos comer, que é a comunhão do Corpo de Cristo."</p>
      <p><strong>Cálice:</strong> "Senhor, abençoa o Cálice que vamos beber, que é a comunhão do Sangue de Cristo."</p>
    `,editable:!0})}),ft(()=>{x.value&&x.value.destroy()});const dt=s=>{w.push({path:"/evento",query:{id:s.id}})};return(s,t)=>{const a=ct;return o(),r("div",null,[z.value?(o(),Q(a,{key:0})):(o(),r(y,{key:1},[e("div",Dt,[e("nav",ht,[e("span",{id:"tab-filters","aria-selected":v.value==="filters",role:"tab",type:"button",class:_(["tab",{active:v.value==="filters"}]),style:{position:"relative"},onClick:t[0]||(t[0]=l=>v.value="filters")},[e("span",St,d(ot.value),1),t[17]||(t[17]=e("i",{class:"la la-filter z-10"},null,-1))],10,Ct),e("span",{id:"tab-print","aria-selected":v.value==="print",role:"tab",type:"button",class:_(["tab",{active:v.value==="print"}]),onClick:t[1]||(t[1]=l=>v.value="print")},[e("span",$t,d(ut.value),1),t[18]||(t[18]=e("i",{class:"la la-print"},null,-1))],10,Tt),e("span",{id:"tab-lista","aria-selected":v.value==="lista",role:"tab",type:"button",class:_(["tab",{active:v.value==="lista"}]),onClick:t[2]||(t[2]=l=>v.value="lista")}," Lista ",10,xt)])]),e("div",null,[e("div",Et,[f(e("div",qt,[e("div",{class:"text-center",style:O({fontSize:k.value+"em"})},[t[19]||(t[19]=e("div",null,"LISTA DE ATENDIMENTO E DIVERSOS",-1)),n.calendars.length?(o(),r("div",At,[e("b",null,d(n.calendars.map(G).join(", ")),1)])):c("",!0),n.locale?(o(),r("span",Lt,[e("b",null,d(G(n.locale)),1)])):c("",!0),n.date?(o(),r("span",Vt," Data: "+d(n.date?.split("T")[0]?.split("-")?.reverse()?.join("/")),1)):c("",!0),!n.date&&(n.start||n.end)?(o(),r("div",wt," Período: "+d(n.start?.split("T")[0]?.split("-")?.reverse()?.join("/"))+" à "+d(n.end?.split("T")[0]?.split("-")?.reverse()?.join("/")),1)):c("",!0),n.search?(o(),r("div",zt,d(n.search),1)):c("",!0)],4)],512),[[A,v.value==="lista"]]),f(e("div",jt,[e("div",Ot,[e("div",Bt,[e("div",null,[e("div",Ft,[t[20]||(t[20]=e("label",{for:"search"},"Pesquisar",-1)),e("div",It,[f(e("input",{id:"search","onUpdate:modelValue":t[3]||(t[3]=l=>n.search=l),type:"text",placeholder:"Buscar itens..."},null,512),[[q,n.search]]),n.search?(o(),r("button",{key:0,class:"btn-clear","aria-label":"Limpar pesquisa",type:"button",onClick:t[4]||(t[4]=l=>T("search"))}," × ")):c("",!0)])]),e("div",Ut,[t[22]||(t[22]=e("label",{for:"title"},"Título",-1)),e("div",Gt,[f(e("select",{id:"title","onUpdate:modelValue":t[5]||(t[5]=l=>n.title=l)},[t[21]||(t[21]=e("option",{value:""},"Todos os títulos",-1)),(o(!0),r(y,null,S(lt.value,l=>(o(),r("option",{key:l,value:l},d(l),9,Mt))),128))],512),[[J,n.title]]),n.title?(o(),r("button",{key:0,class:"btn-clear","aria-label":"Limpar título",type:"button",onClick:t[6]||(t[6]=l=>T("title"))}," × ")):c("",!0)])]),e("div",Rt,[t[24]||(t[24]=e("label",{for:"locale"},"Local",-1)),e("div",Nt,[f(e("select",{id:"locale","onUpdate:modelValue":t[7]||(t[7]=l=>n.locale=l)},[t[23]||(t[23]=e("option",{value:""},"Todos os locais",-1)),(o(!0),r(y,null,S(st.value,l=>(o(),r("option",{key:l,value:l},d(l),9,Pt))),128))],512),[[J,n.locale]]),n.locale?(o(),r("button",{key:0,class:"btn-clear","aria-label":"Limpar local",type:"button",onClick:t[8]||(t[8]=l=>T("locale"))}," × ")):c("",!0)])]),e("div",Ht,[t[25]||(t[25]=e("label",{for:"date"},"Data",-1)),e("div",Kt,[f(e("input",{id:"date","onUpdate:modelValue":t[9]||(t[9]=l=>n.date=l),type:"date"},null,512),[[q,n.date]]),n.date?(o(),r("button",{key:0,class:"btn-clear","aria-label":"Limpar data",type:"button",onClick:t[10]||(t[10]=l=>T("date"))}," × ")):c("",!0)])]),e("div",Wt,[t[26]||(t[26]=e("label",null,"Intervalo de Datas",-1)),e("div",Qt,[f(e("input",{"onUpdate:modelValue":t[11]||(t[11]=l=>n.start=l),type:"date"},null,512),[[q,n.start]]),f(e("input",{"onUpdate:modelValue":t[12]||(t[12]=l=>n.end=l),type:"date"},null,512),[[q,n.end]]),n.start||n.end?(o(),r("button",{key:0,class:"btn-clear","aria-label":"Limpar datas",type:"button",onClick:t[13]||(t[13]=l=>T("date"))}," × ")):c("",!0)])])]),e("div",null,[e("div",Jt,[t[27]||(t[27]=e("label",null,null,-1)),e("button",{class:"success",disabled:z.value,onClick:t[14]||(t[14]=l=>et())},d(z.value?"Atualizando...":"Aplicar"),9,Xt)])])]),e("div",Yt,[e("span",null,[t[28]||(t[28]=e("i",{class:"la la-tasks"},null,-1)),L(" "+d(Array.isArray(g.value)?g.value.length:0),1)])])])],512),[[A,v.value==="filters"]]),f(e("div",Zt,[e("div",{class:"text-center flex col items-center gap-4"},[t[30]||(t[30]=e("b",{class:"mb-4 p"},"Ajustes de impressão:",-1)),e("div",{class:"p"},[e("button",{class:"success",onClick:rt},t[29]||(t[29]=[e("i",{class:"la la-print"},null,-1),L(" Imprimir ",-1)]))])]),e("div",te,[e("div",ee,[t[31]||(t[31]=e("b",null,"Tamanho da Fonte",-1)),f(e("input",{id:"fontSizeSlider",type:"range","onUpdate:modelValue":t[15]||(t[15]=l=>k.value=l),min:"0.5",max:"1.6",step:"0.05",list:"fontSteps"},null,512),[[q,k.value,void 0,{number:!0}]]),e("datalist",le,[(o(),r(y,null,S(15,l=>e("option",{key:l,value:(l*.1).toFixed(1)},null,8,se)),64))])]),e("div",ne,[t[32]||(t[32]=e("b",null,"Lista",-1)),e("div",null,[e("i",{class:_(["la",H.value?"la-toggle-on":"la-toggle-off"]),title:"Ocultar todos",onClick:t[16]||(t[16]=l=>it(!H.value))},null,2)])]),(o(!0),r(y,null,S(D.value,(l,i)=>(o(),r("div",{key:l,class:_(["settings-list print-hide",{"drag-over":$.value===i}]),draggable:"true",onDragstart:u=>M(i),onDragover:Y(u=>R(i),["prevent"]),onDrop:u=>N(i),onClick:u=>P(l)},[L(d(l)+" ",1),e("i",{class:_(["la",p[l]?"la-toggle-on":"la-toggle-off"]),title:"Alterar visibilidade"},null,2)],42,ae))),128))])],512),[[A,v.value==="print"]])])]),m.value.length?(o(),r("div",oe,[(o(!0),r(y,null,S(m.value,(l,i)=>f((o(),r("div",{key:l.title,class:_(["table-list",{"drag-over":$.value===i}]),draggable:"true",style:{cursor:"move"},onDragstart:u=>M(i),onDragover:Y(u=>R(i),["prevent"]),onDrop:u=>N(i)},[e("div",{class:"table-container",style:O({fontSize:k.value+"em"})},[e("table",null,[e("thead",null,[e("tr",null,[e("th",ie,[e("div",ue,[L(d(l.title)+" ",1),e("i",{class:"la la-toggle-on print-hide",style:{cursor:"pointer"},onClick:u=>P(l.title)},null,8,de)])])])]),e("tbody",null,[(o(!0),r(y,null,S(l.items,u=>(o(),r("tr",{key:u.id,onClick:_e=>dt(u)},[e("td",null,[u.formatDate?(o(),r("span",ve,d(u.formatDate),1)):c("",!0)]),e("td",null,[u.formatWeek?(o(),r("span",pe,d(u.formatWeek),1)):c("",!0)]),e("td",null,[u.formatTime?(o(),r("span",fe,d(u.formatTime),1)):c("",!0)]),e("td",null,d(u.locale),1),e("td",null,[u.desc?(o(),r("span",{key:0,innerHTML:X(gt)(u.desc)},null,8,be)):c("",!0)])],8,ce))),128))])])],4)],42,re)),[[A,p[l.title]]])),128)),x.value?(o(),Q(X(kt),{key:0,editor:x.value,class:"editable",style:O({fontSize:k.value+"em"})},null,8,["editor","style"])):c("",!0)])):c("",!0)],64))])}}},Se=vt(me,[["__scopeId","data-v-95901cb2"]]);export{Se as default};
