import{L as pe}from"./DqqTAazl.js";import{_ as fe,u as be,r as p,A as X,o as Y,B as O,j as x,Q as me,c as o,k as Z,F as g,a as t,y as v,x as y,t as u,m as b,v as A,E as j,C as V,p as D,I as ee,f as z,l as te,i as ge,R as F,s as ye,b as a,M as w,G as _e}from"#entry";import{a as ke,S as he,E as Ce}from"./COUpvK7N.js";import{d as le}from"./D0Dr7phT.js";const De={class:"tabs-container print-hide"},Se={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},Te=["aria-selected"],$e={class:"badge"},Le=["aria-selected"],we={class:"badge"},Ee=["aria-selected"],xe={class:"tab-content"},Ae={id:"tab-content-lista",role:"tabpanel"},Ve={key:0},ze={key:1},qe={key:2},Oe={key:3},je={id:"tab-content-filters",role:"tabpanel"},Fe={class:"content"},Be={class:"form-inline"},Me={class:"form-group"},Ge={class:"row"},Ie={class:"form-group"},Re={class:"row"},Ue=["value"],Ne={class:"form-group"},Pe={class:"row"},He=["value"],We={class:"form-group"},Ke={class:"flex gap-xs"},Qe={class:"form-group",style:{"text-align":"right"}},Je=["disabled"],Xe={class:"form-inline",style:{gap:"1rem","margin-top":"1rem"}},Ye={id:"tab-content-print",role:"tabpanel"},Ze={class:"a4 print-hide"},et={class:"settings-list"},tt={id:"fontSteps"},lt=["value"],st={class:"settings-list print-hide"},nt=["onDragstart","onDragover","onDrop","onClick"],at={key:0,class:"print-page"},ot=["onDragstart","onDragover","onDrop"],it={colspan:"5"},rt={class:"flex items-center aling-center justify-center"},ut=["onClick"],dt=["onClick","onContextmenu","onMousedown"],ct={key:0},vt={key:0},pt={key:0},ft=["innerHTML"],bt={__name:"index",setup(mt){const{$indexedDB:B}=be(),S=p([]),c=p("lista"),s=X({search:"",title:"",locale:"",date:"",start:"",end:"",calendars:[]}),_=p(1),se=ge(),M=ye(),q=p(!1),ne=()=>{const l=se.query||{};["search","title","locale","date","start","end"].forEach(d=>{l[d]!==void 0&&(s[d]=l[d])}),l.calendars&&(s.calendars=Array.isArray(l.calendars)?l.calendars:l.calendars.split(",").filter(Boolean));const{today:i,future:n}=F();s.start||(s.start=i),s.end||(s.end=n)},G=le(()=>{const l=Object.fromEntries(Object.entries(s).filter(([e,i])=>e==="calendars"?i.length:i!==""&&i!=null).map(([e,i])=>Array.isArray(i)?[e,i.join(",")]:[e,i]));M.replace({query:l})},200);function ae(){G()}Y(()=>{ne()}),O([s,_],G,{deep:!0});function E(l){if(l==="calendars")s.calendars=[];else if(l==="date"){s.date="";const{today:e,future:i}=F();s.start=e,s.end=i}else if(l==="start"||l==="end"){const{today:e,future:i}=F();s.start=e,s.end=i}else s[l]=""}const oe=p([]),I=p([]),R=p([]),T=p([]),U=p([]),ie=le(async()=>{const{events:l,calendars:e,titles:i,locales:n}=await B.getEvents(s)||[];U.value=await B.getTitles()||[],S.value=l,oe.value=e,I.value=i,R.value=n;const d=Array.from(new Set(S.value.map(C=>C.title||"Sem título"))),h=U.value.filter(C=>d.includes(C));d.forEach(C=>{h.includes(C)||h.push(C)}),T.value=h},400);O(()=>s,async()=>{s.start&&ie()},{immediate:!0,deep:!0});const m=x(()=>{const l={};return S.value.forEach(e=>{const i=e.title||"Sem título";(l[i]||=[]).push(e)}),T.value.filter(e=>l[e]).map(e=>({title:e,items:l[e].slice().sort((i,n)=>i.onDate&&n.onDate?i.onDate-n.onDate:0)}))}),N=l=>l?.replace(/-$/,"")?.trim(),re=x(()=>{let l=0;return s.search&&l++,s.title&&l++,s.locale&&l++,s.date&&l++,s.calendars&&s.calendars.length>0&&l++,l}),ue=()=>{c.value="lista",setTimeout(()=>{window.print()},1e3)},k=p(null),$=p(null),P=l=>{k.value=l},H=l=>{$.value=l},W=l=>{if(k.value===null||k.value===l){k.value=null,$.value=null;return}const e=[...T.value],[i]=e.splice(k.value,1);e.splice(l,0,i),T.value=e,k.value=null,$.value=null},f=X({});O(m,()=>{if(!m.value)return;const l=m.value.map(e=>e.title);l.forEach(e=>{e in f||(f[e]=!0)});for(const e in f)l.includes(e)||delete f[e]},{immediate:!0});const K=l=>{c.value="print",f[l]=!f[l]},Q=x(()=>m.value.length>0&&m.value.every(l=>f[l.title])),de=l=>{m.value.forEach(e=>{f[e.title]=l})},L=p(null),ce=x(()=>Object.values(f).filter(Boolean).length);Y(()=>{L.value=new ke({extensions:[he],content:`
      <p>Oração Santa Ceia</p>
      <p><strong>Pão:</strong> "Senhor, abençoa este Pão que vamos comer, que é a comunhão do Corpo de Cristo."</p>
      <p><strong>Cálice:</strong> "Senhor, abençoa o Cálice que vamos beber, que é a comunhão do Sangue de Cristo."</p>
    `,editable:!0})}),me(()=>{L.value&&L.value.destroy()});const ve=l=>{M.push({path:"/evento",query:{id:l.id}})};function J(l){l&&l.htmlLink&&window.open(l.htmlLink,"_blank")}return(l,e)=>{const i=pe;return a(),o("div",null,[q.value?(a(),Z(i,{key:0})):(a(),o(g,{key:1},[t("div",De,[t("nav",Se,[t("span",{id:"tab-filters","aria-selected":c.value==="filters",role:"tab",type:"button",class:y(["tab",{active:c.value==="filters"}]),style:{position:"relative"},onClick:e[0]||(e[0]=n=>c.value="filters")},[t("span",$e,u(re.value),1),e[15]||(e[15]=t("i",{class:"la la-filter z-10"},null,-1))],10,Te),t("span",{id:"tab-print","aria-selected":c.value==="print",role:"tab",type:"button",class:y(["tab",{active:c.value==="print"}]),onClick:e[1]||(e[1]=n=>c.value="print")},[t("span",we,u(ce.value),1),e[16]||(e[16]=t("i",{class:"la la-print"},null,-1))],10,Le),t("span",{id:"tab-lista","aria-selected":c.value==="lista",role:"tab",type:"button",class:y(["tab",{active:c.value==="lista"}]),onClick:e[2]||(e[2]=n=>c.value="lista")}," Lista ",10,Ee)])]),t("div",null,[t("div",xe,[b(t("div",Ae,[t("div",{class:"text-center",style:j({fontSize:_.value+"em"})},[e[17]||(e[17]=t("div",null,"LISTA DE ATENDIMENTO E DIVERSOS",-1)),s.calendars.length?(a(),o("div",Ve,[t("b",null,u(s.calendars.map(N).join(", ")),1)])):v("",!0),s.locale?(a(),o("span",ze,[t("b",null,u(N(s.locale)),1)])):v("",!0),!s.date&&(s.start||s.end)?(a(),o("div",qe," Período: "+u(s.start?.split("T")[0]?.split("-")?.reverse()?.join("/"))+" à "+u(s.end?.split("T")[0]?.split("-")?.reverse()?.join("/")),1)):v("",!0),s.search?(a(),o("div",Oe,u(s.search.replace(/\!\S+/gi,"")),1)):v("",!0)],4)],512),[[A,c.value==="lista"]]),b(t("div",je,[t("div",Fe,[t("div",Be,[t("div",null,[t("div",Me,[e[18]||(e[18]=t("label",{for:"search"},"Pesquisar",-1)),t("div",Ge,[b(t("input",{id:"search","onUpdate:modelValue":e[3]||(e[3]=n=>s.search=n),type:"text",placeholder:"Buscar itens..."},null,512),[[V,s.search]]),s.search?(a(),o("button",{key:0,class:"btn-clear","aria-label":"Limpar pesquisa",type:"button",onClick:e[4]||(e[4]=n=>E("search"))}," × ")):v("",!0)])]),t("div",Ie,[e[20]||(e[20]=t("label",{for:"title"},"Título",-1)),t("div",Re,[b(t("select",{id:"title","onUpdate:modelValue":e[5]||(e[5]=n=>s.title=n)},[e[19]||(e[19]=t("option",{value:""},"Todos os títulos",-1)),(a(!0),o(g,null,D(I.value,n=>(a(),o("option",{key:n,value:n},u(n),9,Ue))),128))],512),[[ee,s.title]]),s.title?(a(),o("button",{key:0,class:"btn-clear","aria-label":"Limpar título",type:"button",onClick:e[6]||(e[6]=n=>E("title"))}," × ")):v("",!0)])]),t("div",Ne,[e[22]||(e[22]=t("label",{for:"locale"},"Local",-1)),t("div",Pe,[b(t("select",{id:"locale","onUpdate:modelValue":e[7]||(e[7]=n=>s.locale=n)},[e[21]||(e[21]=t("option",{value:""},"Todos os locais",-1)),(a(!0),o(g,null,D(R.value,n=>(a(),o("option",{key:n,value:n},u(n),9,He))),128))],512),[[ee,s.locale]]),s.locale?(a(),o("button",{key:0,class:"btn-clear","aria-label":"Limpar local",type:"button",onClick:e[8]||(e[8]=n=>E("locale"))}," × ")):v("",!0)])]),t("div",We,[e[23]||(e[23]=t("label",null,"Intervalo de Datas",-1)),t("div",Ke,[b(t("input",{"onUpdate:modelValue":e[9]||(e[9]=n=>s.start=n),type:"date"},null,512),[[V,s.start]]),b(t("input",{"onUpdate:modelValue":e[10]||(e[10]=n=>s.end=n),type:"date"},null,512),[[V,s.end]]),s.start||s.end?(a(),o("button",{key:0,class:"btn-clear","aria-label":"Limpar datas",type:"button",onClick:e[11]||(e[11]=n=>E("date"))}," × ")):v("",!0)])])]),t("div",null,[t("div",Qe,[e[24]||(e[24]=t("label",null,null,-1)),t("button",{class:"success",disabled:q.value,onClick:e[12]||(e[12]=n=>ae())},u(q.value?"Atualizando...":"Aplicar"),9,Je)])])]),t("div",Xe,[t("span",null,[e[25]||(e[25]=t("i",{class:"la la-tasks"},null,-1)),z(" "+u(Array.isArray(S.value)?S.value.length:0),1)])])])],512),[[A,c.value==="filters"]]),b(t("div",Ye,[t("div",{class:"text-center flex col items-center gap-4"},[e[27]||(e[27]=t("b",{class:"mb-4 p"},"Ajustes de impressão:",-1)),t("div",{class:"p"},[t("button",{class:"success",onClick:ue},[...e[26]||(e[26]=[t("i",{class:"la la-print"},null,-1),z(" Imprimir ",-1)])])])]),t("div",Ze,[t("div",et,[e[28]||(e[28]=t("b",null,"Tamanho da Fonte",-1)),b(t("input",{id:"fontSizeSlider",type:"range","onUpdate:modelValue":e[13]||(e[13]=n=>_.value=n),min:"0.5",max:"1.6",step:"0.05",list:"fontSteps"},null,512),[[V,_.value,void 0,{number:!0}]]),t("datalist",tt,[(a(),o(g,null,D(15,n=>t("option",{key:n,value:(n*.1).toFixed(1)},null,8,lt)),64))])]),t("div",st,[e[29]||(e[29]=t("b",null,"Lista",-1)),t("div",null,[t("i",{class:y(["la",Q.value?"la-toggle-on":"la-toggle-off"]),title:"Ocultar todos",onClick:e[14]||(e[14]=n=>de(!Q.value))},null,2)])]),(a(!0),o(g,null,D(T.value,(n,d)=>(a(),o("div",{key:n,class:y(["settings-list print-hide",{"drag-over":$.value===d}]),draggable:"true",onDragstart:r=>P(d),onDragover:w(r=>H(d),["prevent"]),onDrop:r=>W(d),onClick:r=>K(n)},[z(u(n)+" ",1),t("i",{class:y(["la",f[n]?"la-toggle-on":"la-toggle-off"]),title:"Alterar visibilidade"},null,2)],42,nt))),128))])],512),[[A,c.value==="print"]])])]),m.value.length?(a(),o("div",at,[(a(!0),o(g,null,D(m.value,(n,d)=>b((a(),o("div",{key:n.title,class:y(["table-list",{"drag-over":$.value===d}]),draggable:"true",style:{cursor:"move"},onDragstart:r=>P(d),onDragover:w(r=>H(d),["prevent"]),onDrop:r=>W(d)},[t("div",{class:"table-container",style:j({fontSize:_.value+"em"})},[t("table",null,[t("thead",null,[t("tr",null,[t("th",it,[t("div",rt,[z(u(n.title)+" ",1),t("i",{class:"la la-toggle-on print-hide",style:{cursor:"pointer"},onClick:r=>K(n.title)},null,8,ut)])])])]),t("tbody",null,[(a(!0),o(g,null,D(n.items,r=>(a(),o("tr",{key:r.id,onClick:w(h=>ve(r),["left"]),onContextmenu:w(h=>J(r),["prevent"]),onMousedown:w(h=>J(r),["right","prevent"])},[t("td",null,[r.formatDate?(a(),o("span",ct,u(r.formatDate),1)):v("",!0)]),t("td",null,[r.formatWeek?(a(),o("span",vt,u(r.formatWeek),1)):v("",!0)]),t("td",null,[r.formatTime?(a(),o("span",pt,u(r.formatTime),1)):v("",!0)]),t("td",null,u(r.locale),1),t("td",null,[r.desc?(a(),o("span",{key:0,innerHTML:te(_e)(r.desc)},null,8,ft)):v("",!0)])],40,dt))),128))])])],4)],42,ot)),[[A,f[n.title]]])),128)),L.value?(a(),Z(te(Ce),{key:0,editor:L.value,class:"editable",style:j({fontSize:_.value+"em"})},null,8,["editor","style"])):v("",!0)])):v("",!0)],64))])}}},Ct=fe(bt,[["__scopeId","data-v-c4b819e1"]]);export{Ct as default};
