import{L as de}from"./D17XMlcw.js";import{_ as ve,u as he,y as fe,r as m,z as ge,h as C,A as U,c as u,B as pe,a as s,t as y,F as D,k as _,e as V,i as me,C as ye,o,n as Q,p as H,D as $,l as De,E as _e}from"./C3tncR8Q.js";const Ce={key:1,class:"calendar-wrapper"},be={class:"calendar-header"},ke={class:"month-year"},Me={class:"calendar-table"},we=["onClick"],Te={class:"day-content"},Se={class:"day-number"},xe={key:0,class:"event-indicators"},Ee={class:"events-panel"},Ne={class:"events-list-container"},Fe={class:"chips-container"},Ue={key:0,class:"las la-toggle-on"},$e={key:1,class:"las la-toggle-off"},Re=["onClick"],ze={key:0,class:"las la-toggle-on"},Ge={key:1,class:"las la-toggle-off"},Ae={class:"search-container"},Le={key:0},Ye={class:"event-date-title"},Pe={class:"events-list"},Oe={class:"sub-events-list"},Be=["onClick"],Ie=["innerHTML"],qe={key:1,class:"no-events-message"},K="agenda_selected_groups",j=50,Xe={__name:"agenda",setup(Je){const{lista:M}=he(),R=fe(),z=m(!0),w=ge({search:"",title:"",locale:"",date:"",start:"",end:"",calendars:[]});(()=>{const e=R.query||{};["search","title","locale","date","start","end"].forEach(n=>{e[n]!==void 0&&(w[n]=e[n])}),e.calendars&&(w.calendars=Array.isArray(e.calendars)?e.calendars:e.calendars.split(",").filter(Boolean))})();const x=new Date,v=m(x.getMonth()),p=m(x.getFullYear()),h=m(null),E=m(""),f=m([]),T=C(()=>Array.from(new Set(M.allEvents.map(e=>e.group))).filter(e=>e).sort((e,t)=>e.localeCompare(t))),G=C(()=>f.value.length===T.value.length);function W(){localStorage.setItem(K,JSON.stringify(f.value))}function Z(){const e=localStorage.getItem(K);return e?JSON.parse(e):null}U(T,e=>{const t=Z();t&&t.length>0?f.value=t.filter(n=>e.includes(n)):f.value=e.filter(n=>n!=="Rodízios")},{immediate:!0}),U(f,()=>{W()},{deep:!0});function ee(e){const t=f.value.indexOf(e);t===-1?f.value.push(e):f.value.splice(t,1)}function te(){G.value?f.value=[]:f.value=[...T.value]}const N=C(()=>{const e=E.value.trim();let t=M.allEvents;if(R.query.next==="true"){const l=new Date;t=t.filter(d=>new Date(d.date)>l)}if(w.calendars.length){const l=new Set(w.calendars.map(b));t=t.filter(d=>l.has(d.normalizedList))}if(t=t.filter(l=>f.value.includes(l.group)),!e)return t;const a=l=>`${b(l.title||"")} ${b(l.locale||"")} ${b(l.desc||"")} ${new Date(l.date).toLocaleDateString("pt-BR")}`,c=(l,d)=>d.every(ie=>ie.test(l)),i=(l,d)=>d.test(l),r=t.map(l=>({event:l,text:a(l)}));if(e.includes("|"))try{const l=new RegExp(e,"i");return r.filter(({text:d})=>i(d,l)).map(({event:d})=>d)}catch(l){return console.error("Regex inválida:",l),[]}const k=b(e).replace(/\bou/gi,",").split(/,|\s+/).filter(Boolean).map(l=>new RegExp(l,"i"));return r.filter(({text:l})=>c(l,k)).map(({event:l})=>l)}),A=C(()=>{let e;if(h.value){const n=h.value.date;e=N.value.filter(a=>{const c=new Date(a.date);return c.getUTCFullYear()===n.getFullYear()&&c.getUTCMonth()===n.getMonth()&&c.getUTCDate()===n.getDate()})}else e=N.value.filter(n=>{const a=new Date(n.date);return a.getUTCFullYear()===p.value&&a.getUTCMonth()===v.value});const t=new Map;for(const n of e){const c=new Date(n.date).toISOString().split("T")[0];t.has(c)||t.set(c,new Map);const i=t.get(c);i.has(n.title)||i.set(n.title,[]),i.get(n.title).push(n)}return Array.from(t.entries()).sort(([n],[a])=>new Date(n)-new Date(a))}),L=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],ne=C(()=>`${L[v.value]} ${p.value}`),ae=C(()=>{const e=[],t=new Date(p.value,v.value,1).getDay(),n=new Date(p.value,v.value+1,0).getDate(),a=new Date(p.value,v.value,0).getDate();for(let r=t-1;r>=0;r--)e.push({dayNumber:a-r,isPrevMonth:!0,isNextMonth:!1,isToday:!1,hasEvent:!1,events:[]});for(let r=1;r<=n;r++){const g=new Date(p.value,v.value,r),k=N.value.filter(l=>{const d=new Date(l.date);return d.getUTCDate()===r&&d.getUTCMonth()===v.value&&d.getUTCFullYear()===p.value});e.push({dayNumber:r,date:g,isPrevMonth:!1,isNextMonth:!1,isToday:g.toDateString()===x.toDateString(),hasEvent:k.length>0,events:k})}const c=42-e.length;for(let r=1;r<=c;r++)e.push({dayNumber:r,isPrevMonth:!1,isNextMonth:!0,isToday:!1,hasEvent:!1,events:[]});const i=[];for(;e.length>0;)i.push(e.splice(0,7));return i});function se(e){const t=new Date(e),n=t.getUTCDate(),a=L[t.getUTCMonth()],c=t.getUTCFullYear();return`${n} de ${a} de ${c}`}function S(e){v.value+=e,v.value<0?(v.value=11,p.value--):v.value>11&&(v.value=0,p.value++),h.value=null}function le(e){return{"prev-month-day":e.isPrevMonth||e.isNextMonth,today:e.isToday,"has-event":e.hasEvent,"selected-day":h.value&&h.value.date&&e.date&&h.value.date.toDateString()===e.date.toDateString()}}function oe(e){!e.isPrevMonth&&!e.isNextMonth&&(h.value&&h.value.date.toDateString()===e.date.toDateString()?h.value=null:h.value=e)}function re(e){return h.value?e.some(t=>{const n=new Date(t.date),a=h.value.date;return n.getUTCFullYear()===a.getFullYear()&&n.getUTCMonth()===a.getMonth()&&n.getUTCDate()===a.getDate()}):!1}function b(e){return e?e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""):""}const ue=e=>{const t=`https://www.google.com/calendar/event?eid=${e.htmlLink}`;window.open(t,"_blank")};function ce(e){const t=new Set;for(const n of e)n.group&&t.add(n.group);return[...t]}const Y=["#d6b8c1","#d1c965","#cdb8d1","#aed4d7","#b3a9a5","a9c6aa","#d39a8f","#b0a2cc","#d28fa9","#b2d29f","#d1b05e","#84c9cc","#d1be83","#92c2be","#a3b1b5","#bdc75d"],P={Reuniões:"#c4d7b9",Atendimentos:"#b4d0e3",Rodízios:"#e6b97f",Outros:"#c3bfe0"},F=m({});function O(e){if(P[e])return P[e];if(!F.value[e]){const n=Array.from(new Set(M.allEvents.map(a=>a.group).filter(a=>a!==null))).indexOf(e);F.value[e]=Y[n%Y.length]}return F.value[e]}function B(e){return{backgroundColor:O(e)}}U(()=>M.allEvents,e=>{e&&e.length>0&&(z.value=!1)},{immediate:!0});const I=m(0),q=m(0);function X(e){I.value=e.touches?e.touches[0].clientX:e.clientX}function J(e){q.value=e.changedTouches?e.changedTouches[0].clientX:e.clientX;const t=q.value-I.value;t>j?S(-1):t<-j&&S(1)}return(e,t)=>{const n=de;return o(),u("div",null,[z.value?(o(),pe(n,{key:0})):(o(),u("div",Ce,[s("div",{class:"calendar-panel",onTouchstart:X,onTouchend:J,onMousedown:X,onMouseup:J},[s("div",be,[s("i",{class:"las la-chevron-left",onClick:t[0]||(t[0]=a=>S(-1))}),s("h2",ke,y(ne.value),1),s("i",{class:"las la-chevron-right",onClick:t[1]||(t[1]=a=>S(1))})]),s("table",Me,[t[3]||(t[3]=s("thead",null,[s("tr",null,[s("th",null,"Dom"),s("th",null,"Seg"),s("th",null,"Ter"),s("th",null,"Qua"),s("th",null,"Qui"),s("th",null,"Sex"),s("th",null,"Sáb")])],-1)),s("tbody",null,[(o(!0),u(D,null,_(ae.value,(a,c)=>(o(),u("tr",{key:c},[(o(!0),u(D,null,_(a,i=>(o(),u("td",{key:i.date,class:Q(le(i)),onClick:r=>oe(i)},[s("div",Te,[s("div",Se,y(i.dayNumber),1),i.events.length?(o(),u("div",xe,[(o(!0),u(D,null,_(ce(i.events),r=>(o(),u("span",{key:r,class:"event-indicator",style:$({backgroundColor:O(r)})},null,4))),128))])):H("",!0)])],10,we))),128))]))),128))])])],32),s("div",Ee,[s("div",Ne,[s("div",Fe,[s("span",{class:"chip",onClick:te},[G.value?(o(),u("i",Ue)):(o(),u("i",$e)),t[4]||(t[4]=V(" Todos "))]),(o(!0),u(D,null,_(T.value,a=>(o(),u("span",{key:a,class:"chip",style:$(B(a)),onClick:c=>ee(a)},[f.value.includes(a)?(o(),u("i",ze)):(o(),u("i",Ge)),V(" "+y(a),1)],12,Re))),128))]),s("div",Ae,[me(s("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>E.value=a),type:"text",placeholder:"Buscar eventos...",class:"search-input"},null,512),[[ye,E.value]]),t[5]||(t[5]=s("i",{class:"las la-search search-icon"},null,-1))]),Object.keys(A.value).length?(o(),u("div",Le,[(o(!0),u(D,null,_(A.value,([a,c])=>(o(),u("div",{key:a},[s("h4",Ye,y(se(a)),1),s("ul",Pe,[(o(!0),u(D,null,_(c,([i,r])=>(o(),u("li",{key:i,class:Q({"selected-event":re(r)}),style:$(B(r[0].group))},[s("strong",null,y(i),1),s("ul",Oe,[(o(!0),u(D,null,_(r,g=>(o(),u("li",{key:g.id,onClick:k=>ue(g)},[s("p",null,[s("b",null,[s("i",null,y(g.formatTime)+y(g.formatTime?" - ":"")+y(g.formatDate),1)])]),s("p",null,y(g.locale),1),g.desc?(o(),u("p",{key:0,innerHTML:De(_e)(g.desc)},null,8,Ie)):H("",!0)],8,Be))),128))])],6))),128))])]))),128))])):(o(),u("p",qe,"Nenhum evento agendado."))])])]))])}}},Ke=ve(Xe,[["__scopeId","data-v-d5c909ff"]]);export{Ke as default};
