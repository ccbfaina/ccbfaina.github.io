import{L as ie}from"./BSq6NVqL.js";import{_ as de,u as ce,r as C,y as ve,h as b,z as G,c as r,A as he,a as n,t as p,F as g,k as m,e as A,i as fe,B as pe,g as be,C as ge,o,n as w,p as V,D as N,l as me,E as ye}from"./BNw1CUDX.js";const Ce={key:1,class:"calendar-wrapper"},De={class:"calendar-header"},_e={class:"month-year"},ke={class:"calendar-table"},Ge=["onClick"],we={class:"day-content"},Me={class:"day-number"},Te={key:0,class:"event-indicators"},Ee={class:"events-panel"},Se={class:"events-list-container"},xe={class:"chips-container"},Ae={key:0,class:"las la-toggle-on"},Ne={key:1,class:"las la-toggle-off"},qe=["onClick"],Ue={key:0,class:"las la-toggle-on"},$e={key:1,class:"las la-toggle-off"},Fe={class:"chips-container"},Ye=["onClick"],Le={key:0,class:"las la-toggle-on"},ze={key:1,class:"las la-toggle-off"},Pe={class:"search-container"},Be={key:0},Oe={class:"event-date-title"},Re={class:"events-list"},Xe={class:"sub-events-list"},Ie=["onClick"],Ve=["innerHTML"],Je={key:1,class:"no-events-message"},J=50,He={__name:"agenda",setup(Qe){const{lista:y}=ce(),D=be(),q=C(!0),M=new Date,d=C(M.getMonth()),h=C(M.getFullYear()),v=C(null),l=ve({search:"",title:"",locale:"",date:"",start:"",end:"",enabledGroups:[],disabledGroups:[],enabledCalendars:[],disabledCalendars:[]});function U(){return[]}const _=b(()=>Array.from(new Set(y.allEvents.map(e=>e.group))).filter(e=>e).sort((e,a)=>e.localeCompare(a))),H=b(()=>Array.from(new Set(y.calendars.map(e=>e.calendar))).filter(e=>e).sort((e,a)=>e.localeCompare(a)));G(_,e=>{if(!(D.query.groups&&D.query.groups.length>0)&&l.enabledGroups.length===0&&l.disabledGroups.length===0){const a=U(),s=U();a.length>0||s.length>0?(l.enabledGroups=a.filter(t=>e.includes(t)),l.disabledGroups=s.filter(t=>e.includes(t))):(l.enabledGroups=e.filter(t=>t!=="Rodízios"),l.disabledGroups=e.filter(t=>t==="Rodízios"))}},{immediate:!0}),G(H,e=>{D.query.calendars&&D.query.calendars.length>0||l.enabledCalendars.length===0&&l.disabledCalendars.length===0&&(l.enabledCalendars=[...e],l.disabledCalendars=[])},{immediate:!0}),G([()=>l.enabledGroups,()=>l.disabledGroups],()=>{},{deep:!0});const Q=b(()=>{const e=[...l.enabledGroups,...l.disabledGroups];return Array.from(new Set(e)).sort((s,t)=>s.localeCompare(t))}),j=b(()=>{const e=[...l.enabledCalendars,...l.disabledCalendars];return Array.from(new Set(e)).sort((s,t)=>s.localeCompare(t))}),$=b(()=>l.enabledGroups.length===_.value.length);G(()=>y.allEvents,()=>{const e=D.query||{};if(["search","title","locale","date","start","end"].forEach(s=>{e[s]!==void 0&&(l[s]=e[s])}),e.groups){const s=Array.isArray(e.groups)?e.groups:e.groups.split(",").filter(Boolean);l.enabledGroups=s.filter(t=>_.value.includes(t)),l.disabledGroups=_.value.filter(t=>!s.includes(t))}if(e.calendars){const s=Array.isArray(e.calendars)?e.calendars:e.calendars.split(",").filter(Boolean);console.log("Calendários da URL:",s),l.enabledCalendars=s,l.disabledCalendars=[]}y.allEvents&&y.allEvents.length>0&&(q.value=!1)},{immediate:!0});function K(e){l.enabledGroups.includes(e)?(l.enabledGroups=l.enabledGroups.filter(s=>s!==e),l.disabledGroups.push(e)):(l.disabledGroups=l.disabledGroups.filter(s=>s!==e),l.enabledGroups.push(e)),l.enabledGroups.sort((s,t)=>s.localeCompare(t)),l.disabledGroups.sort((s,t)=>s.localeCompare(t))}function W(){$.value?(l.disabledGroups=[..._.value],l.enabledGroups=[]):(l.enabledGroups=[..._.value],l.disabledGroups=[])}function Z(e){l.enabledCalendars.includes(e)?(l.enabledCalendars=l.enabledCalendars.filter(s=>s!==e),l.disabledCalendars.push(e)):(l.disabledCalendars=l.disabledCalendars.filter(s=>s!==e),l.enabledCalendars.push(e)),l.enabledCalendars.sort((s,t)=>s.localeCompare(t)),l.disabledCalendars.sort((s,t)=>s.localeCompare(t))}const T=b(()=>{const e=l.search.trim();let a=ge(y.allEvents||[],l);if(D.query.next==="true"){const t=new Date;a=a.filter(i=>new Date(i.date)>t)}return a=a.filter(t=>l.enabledGroups.includes(t.group)).filter(t=>l.enabledCalendars.includes(t.list)).filter(t=>!t.noDate),a}),F=b(()=>{let e;if(v.value){const s=v.value.date;e=T.value.filter(t=>{const i=new Date(t.date);return i.getUTCFullYear()===s.getFullYear()&&i.getUTCMonth()===s.getMonth()&&i.getUTCDate()===s.getDate()})}else e=T.value.filter(s=>{const t=new Date(s.date);return t.getUTCFullYear()===h.value&&t.getUTCMonth()===d.value});const a=new Map;for(const s of e){const i=new Date(s.date).toISOString().split("T")[0];a.has(i)||a.set(i,new Map);const c=a.get(i);c.has(s.title)||c.set(s.title,[]),c.get(s.title).push(s)}return Array.from(a.entries()).sort(([s],[t])=>new Date(s)-new Date(t))}),Y=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],ee=b(()=>`${Y[d.value]} ${h.value}`),te=b(()=>{const e=[],a=new Date(h.value,d.value,1).getDay(),s=new Date(h.value,d.value+1,0).getDate(),t=new Date(h.value,d.value,0).getDate();for(let u=a-1;u>=0;u--)e.push({dayNumber:t-u,date:new Date(h.value,d.value-1,t-u),isPrevMonth:!0,isNextMonth:!1,isToday:!1,hasEvent:!1,events:[]});for(let u=1;u<=s;u++){const f=new Date(h.value,d.value,u),S=T.value.filter(ue=>{const x=new Date(ue.date);return x.getUTCDate()===u&&x.getUTCMonth()===d.value&&x.getUTCFullYear()===h.value});e.push({dayNumber:u,date:f,isPrevMonth:!1,isNextMonth:!1,isToday:f.toDateString()===M.toDateString(),hasEvent:S.length>0,events:S})}const i=42-e.length;for(let u=1;u<=i;u++)e.push({dayNumber:u,date:new Date(h.value,d.value+1,u),isPrevMonth:!1,isNextMonth:!0,isToday:!1,hasEvent:!1,events:[]});const c=[];for(;e.length>0;)c.push(e.splice(0,7));return c});function se(e){const a=new Date(e),s=a.getUTCDate(),t=Y[a.getUTCMonth()],i=a.getUTCFullYear();return`${s} de ${t} de ${i}`}function k(e){d.value+=e,d.value<0?(d.value=11,h.value--):d.value>11&&(d.value=0,h.value++),v.value=null}function ae(e){return{"prev-month-day":e.isPrevMonth||e.isNextMonth,today:e.isToday,"has-event":e.hasEvent,"selected-day":v.value&&e.date&&v.value.date&&v.value.date.toDateString()===e.date.toDateString()}}function le(e){e.isPrevMonth?(k(-1),v.value={...e,date:new Date(h.value,d.value,e.dayNumber)}):e.isNextMonth?(k(1),v.value={...e,date:new Date(h.value,d.value,e.dayNumber)}):v.value&&v.value.date.toDateString()===e.date.toDateString()?v.value=null:v.value=e}function ne(e){return v.value?e.some(a=>{const s=new Date(a.date),t=v.value.date;return s.getUTCFullYear()===t.getFullYear()&&s.getUTCMonth()===t.getMonth()&&s.getUTCDate()===t.getDate()}):!1}const oe=e=>{const a=`https://www.google.com/calendar/event?eid=${e.htmlLink}`;window.open(a,"_blank")};function re(e){const a=new Set;for(const s of e)s.group&&a.add(s.group);return[...a]}const L=["#d6b8c1","#d1c965","#cdb8d1","#aed4d7","#b3a9a5","#a9c6aa","#d39a8f","#b0a2cc","#d28fa9","#b2d29f","#d1b05e","#84c9cc","#d1be83","#92c2be","#a3b1b5","#bdc75d"],z={Reuniões:"#c4d7b9",Atendimentos:"#b4d0e3",Rodízios:"#e6b97f",Outros:"#c3bfe0"},E=C({});function P(e){if(z[e])return z[e];if(!E.value[e]){const s=Array.from(new Set(y.allEvents.map(t=>t.group).filter(t=>t!==null))).indexOf(e);E.value[e]=L[s%L.length]}return E.value[e]}function B(e){return{backgroundColor:P(e)}}const O=C(0),R=C(0);function X(e){O.value=e.touches?e.touches[0].clientX:e.clientX}function I(e){R.value=e.changedTouches?e.changedTouches[0].clientX:e.clientX;const a=R.value-O.value;a>J?k(-1):a<-J&&k(1)}return(e,a)=>{const s=ie;return o(),r("div",null,[q.value?(o(),he(s,{key:0})):(o(),r("div",Ce,[n("div",{class:"calendar-panel",onTouchstart:X,onTouchend:I,onMousedown:X,onMouseup:I},[n("div",De,[n("i",{class:"las la-chevron-left",onClick:a[0]||(a[0]=t=>k(-1))}),n("h2",_e,p(ee.value),1),n("i",{class:"las la-chevron-right",onClick:a[1]||(a[1]=t=>k(1))})]),n("table",ke,[a[3]||(a[3]=n("thead",null,[n("tr",null,[n("th",null,"Dom"),n("th",null,"Seg"),n("th",null,"Ter"),n("th",null,"Qua"),n("th",null,"Qui"),n("th",null,"Sex"),n("th",null,"Sáb")])],-1)),n("tbody",null,[(o(!0),r(g,null,m(te.value,(t,i)=>(o(),r("tr",{key:i},[(o(!0),r(g,null,m(t,c=>(o(),r("td",{key:c.date,class:w(ae(c)),onClick:u=>le(c)},[n("div",we,[n("div",Me,p(c.dayNumber),1),c.events.length?(o(),r("div",Te,[(o(!0),r(g,null,m(re(c.events),u=>(o(),r("span",{key:u,class:"event-indicator",style:N({backgroundColor:P(u)})},null,4))),128))])):V("",!0)])],10,Ge))),128))]))),128))])])],32),n("div",Ee,[n("div",Se,[a[7]||(a[7]=n("small",{style:{opacity:"0.8"}},"Grupos:",-1)),n("div",xe,[n("span",{class:"chip",onClick:W},[$.value?(o(),r("i",Ae)):(o(),r("i",Ne)),a[4]||(a[4]=A(" Todos os Grupos ",-1))]),(o(!0),r(g,null,m(Q.value,t=>(o(),r("span",{key:t,class:w(["chip",{"chip-disabled":l.disabledGroups.includes(t)}]),style:N(B(t)),onClick:i=>K(t)},[l.enabledGroups.includes(t)?(o(),r("i",Ue)):(o(),r("i",$e)),A(" "+p(t),1)],14,qe))),128))]),a[8]||(a[8]=n("small",{style:{opacity:"0.8"}},"Agenda(s):",-1)),n("div",Fe,[(o(!0),r(g,null,m(j.value,t=>(o(),r("span",{key:t,class:w(["chip",{"chip-disabled":l.disabledCalendars.includes(t)}]),onClick:i=>Z(t)},[l.enabledCalendars.includes(t)?(o(),r("i",Le)):(o(),r("i",ze)),A(" "+p(t),1)],10,Ye))),128))]),n("div",Pe,[fe(n("input",{"onUpdate:modelValue":a[2]||(a[2]=t=>l.search=t),type:"text",placeholder:"Buscar eventos...",class:"search-input"},null,512),[[pe,l.search]]),a[5]||(a[5]=n("i",{class:"las la-search search-icon"},null,-1))]),Object.keys(F.value).length?(o(),r("div",Be,[(o(!0),r(g,null,m(F.value,([t,i])=>(o(),r("div",{key:t},[n("h4",Oe,p(se(t)),1),n("ul",Re,[(o(!0),r(g,null,m(i,([c,u])=>(o(),r("li",{key:c,class:w({"selected-event":ne(u)}),style:N(B(u[0].group))},[n("strong",null,p(c),1),n("ul",Xe,[(o(!0),r(g,null,m(u,f=>(o(),r("li",{key:f.id,onClick:S=>oe(f)},[n("p",null,[n("b",null,[n("i",null,p(f.formatTime)+p(f.formatTime?" - ":"")+p(f.formatDate),1)]),a[6]||(a[6]=n("i",{style:{"margin-left":"5px"},class:"las la-external-link-alt","aria-label":"Google Agenda",title:"Este link abrirá em uma nova aba."},null,-1))]),n("p",null,p(f.locale),1),f.desc?(o(),r("p",{key:0,innerHTML:me(ye)(f.desc)},null,8,Ve)):V("",!0)],8,Ie))),128))])],6))),128))])]))),128))])):(o(),r("p",Je,"Nenhum evento agendado."))])])]))])}}},We=de(He,[["__scopeId","data-v-c7645cab"]]);export{We as default};
