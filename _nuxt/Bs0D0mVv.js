import{L as Dt}from"./DH0QS-ZV.js";import{_ as Ct,y as ht,r as k,A as lt,f as st,D as nt,h as L,P as xt,c as i,C as at,p as m,F as _,a as e,m as d,n as S,t as r,i as c,v as q,E as h,k as x,I as ot,e as z,L as zt,g as Et,Q as U,R as Tt,l as $t,o,J as At,N as it,O as Lt}from"./BcnDC6yg.js";import{d as rt,a as Vt,S as wt,E as qt}from"./BgxXXIRF.js";const Ft={class:"tabs-container print-hide"},It={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},Ut=["aria-selected"],Ot={class:"badge"},jt=["aria-selected"],Mt=["aria-selected"],Bt={class:"tab-content"},Rt={id:"tab-content-lista",role:"tabpanel"},Gt={class:"text-center"},Nt={key:0},Pt={key:1},Ht={key:2},Wt={key:3},Jt={key:4},Kt={id:"tab-content-filters",role:"tabpanel"},Qt={class:"content"},Xt={class:"form-inline"},Yt={class:"form-group"},Zt={class:"row"},te={class:"form-group"},ee={class:"row"},le=["value"],se={class:"form-group"},ne={class:"row"},ae=["value"],oe={class:"form-group"},ie={class:"flex gap-xs"},re={class:"form-group"},ue={class:"flex gap-xs"},de={class:"form-group",style:{"align-items":"flex-start"}},pe=["id","value"],ve=["for"],ce={class:"form-group",style:{"text-align":"right"}},fe=["disabled"],be={class:"form-inline",style:{gap:"1rem","margin-top":"1rem"}},me={id:"tab-content-print",role:"tabpanel"},ge={class:"text-center flex col items-center gap-4"},ye={class:"p form-group flex items-center aling-center"},ke={class:"a4 print-hide"},_e={class:"settings-list print-hide"},Se=["onDragstart","onDragover","onDrop"],De=["onClick"],Ce={key:0,class:"print-page"},he=["onDragstart","onDragover","onDrop"],xe={class:"table-container"},ze={colspan:"5"},Ee={class:"flex items-center aling-center justify-center"},Te=["onClick"],$e={key:0},Ae={key:0},Le={key:0},Ve=["innerHTML"],we={__name:"index",setup(qe){const{lista:g}=ht(),p=k("lista"),l=lt({fontSize:17,search:"",title:"",locale:"",date:"",start:"",end:"",calendars:[]}),ut=Et(),dt=$t(),V=k(!1),pt=()=>{const s=ut.query||{};["search","title","locale","date","start","end"].forEach(C=>{s[C]!==void 0&&(l[C]=s[C])}),s.calendars&&(l.calendars=Array.isArray(s.calendars)?s.calendars:s.calendars.split(",").filter(Boolean));const{today:a,future:v}=U();l.start||(l.start=a),l.end||(l.end=v)},vt=rt(()=>{const s=Object.fromEntries(Object.entries(l).filter(([t,a])=>t==="calendars"?a.length:a!==""&&a!=null).map(([t,a])=>Array.isArray(a)?[t,a.join(",")]:[t,a]));dt.replace({query:s})},200),F=rt(()=>{V.value=!0;const s=Tt(g.allEvents||[],l);gt(s),V.value=!1},200);function ct(){F()}st(()=>{pt(),F()}),nt(l,()=>{vt(),F()},{deep:!0});function E(s){if(s==="calendars")l.calendars=[];else if(s==="date"){l.date="";const{today:t,future:a}=U();l.start=t,l.end=a}else if(s==="start"||s==="end"){const{today:t,future:a}=U();l.start=t,l.end=a}else l[s]=""}function I(s,t){return Array.from(new Set(s.map(a=>a[t]).filter(a=>typeof a=="string"&&a.trim())))}const ft=L(()=>I(w.value,"title")),bt=L(()=>I(w.value,"locale")),mt=I(g.allEvents,"list"),w=k([]),T=k([]);function gt(s){w.value=s;const t=Array.from(new Set(s.map(v=>v.title||"Sem título"))),a=T.value.filter(v=>t.includes(v));t.forEach(v=>{a.includes(v)||a.push(v)}),T.value=a}const b=L(()=>{const s={};return w.value.forEach(t=>{const a=t.title||"Sem título";(s[a]||(s[a]=[])).push(t)}),T.value.filter(t=>s[t]).map(t=>({title:t,items:s[t].slice().sort((a,v)=>a.onDate&&v.onDate?a.onDate-v.onDate:0)}))});function yt(){l.fontSize<10&&(l.fontSize=10),l.fontSize>25&&(l.fontSize=25),l.fontSize=Math.round(l.fontSize*10)/10}const O=s=>{var t;return(t=s==null?void 0:s.replace(/-$/,""))==null?void 0:t.trim()},kt=L(()=>{let s=0;return l.search&&s++,l.title&&s++,l.locale&&s++,l.date&&s++,l.calendars&&l.calendars.length>0&&s++,s}),_t=()=>{p.value="lista",setTimeout(()=>{window.print()},1e3)},D=k(null),$=k(null),j=s=>{D.value=s},M=s=>{$.value=s},B=s=>{if(D.value===null||D.value===s){D.value=null,$.value=null;return}const t=T.value.slice(),[a]=t.splice(D.value,1);t.splice(s,0,a),T.value=t,D.value=null,$.value=null},y=lt({});nt(b,()=>{b.value&&b.value.forEach(s=>{s.title in y||(y[s.title]=!0)})},{immediate:!0});const R=s=>{p.value="print",y[s]=!y[s]},G=L(()=>b.value.length>0&&b.value.every(s=>y[s.title])),St=s=>{b.value.forEach(t=>{y[t.title]=s})},A=k(null);return st(()=>{A.value=new Vt({extensions:[wt],content:`
      <p>Oração Santa Ceia</p>
      <p><strong>Pão:</strong> "Senhor, abençoa este Pão que vamos comer, que é a comunhão do Corpo de Cristo."</p>
      <p><strong>Cálice:</strong> "Senhor, abençoa o Cálice que vamos beber, que é a comunhão do Sangue de Cristo."</p>
    `,editable:!0})}),xt(()=>{A.value&&A.value.destroy()}),(s,t)=>{var v,C,N,P,H,W,J,K,Q,X,Y,Z,tt,et;const a=Dt;return o(),i("div",{style:zt({fontSize:(l.fontSize?l.fontSize:17)+"px"})},[m(g).loading?(o(),at(a,{key:0})):(o(),i(_,{key:1},[e("div",Ft,[e("nav",It,[e("span",{id:"tab-filters","aria-selected":p.value==="filters",role:"tab",type:"button",class:S(["tab",{active:p.value==="filters"}]),style:{position:"relative"},onClick:t[0]||(t[0]=n=>p.value="filters")},[e("span",Ot,r(kt.value),1),t[19]||(t[19]=e("i",{class:"la la-filter z-10"},null,-1))],10,Ut),e("span",{id:"tab-print","aria-selected":p.value==="print",role:"tab",type:"button",class:S(["tab",{active:p.value==="print"}]),onClick:t[1]||(t[1]=n=>p.value="print")},t[20]||(t[20]=[e("i",{class:"la la-print"},null,-1)]),10,jt),e("span",{id:"tab-lista","aria-selected":p.value==="lista",role:"tab",type:"button",class:S(["tab",{active:p.value==="lista"}]),onClick:t[2]||(t[2]=n=>p.value="lista")}," Lista ",10,Mt)])]),e("div",null,[e("div",Bt,[c(e("div",Rt,[e("div",Gt,[t[21]||(t[21]=e("div",null,"LISTA DE ATENDIMENTO E DIVERSOS",-1)),l.calendars.length?(o(),i("div",Nt,[e("b",null,r(l.calendars.map(O).join(", ")),1)])):d("",!0),l.locale?(o(),i("span",Pt,[e("b",null,r(O(l.locale)),1)])):d("",!0),l.date?(o(),i("span",Ht," Data: "+r((P=(N=(C=(v=l.date)==null?void 0:v.split("T")[0])==null?void 0:C.split("-"))==null?void 0:N.reverse())==null?void 0:P.join("/")),1)):d("",!0),!l.date&&(l.start||l.end)?(o(),i("div",Wt," Período: "+r((K=(J=(W=(H=l.start)==null?void 0:H.split("T")[0])==null?void 0:W.split("-"))==null?void 0:J.reverse())==null?void 0:K.join("/"))+" à "+r((Z=(Y=(X=(Q=l.end)==null?void 0:Q.split("T")[0])==null?void 0:X.split("-"))==null?void 0:Y.reverse())==null?void 0:Z.join("/")),1)):d("",!0),l.search?(o(),i("div",Jt,r(l.search),1)):d("",!0)])],512),[[q,p.value==="lista"]]),c(e("div",Kt,[e("div",Qt,[e("div",Xt,[e("div",null,[e("div",Yt,[t[22]||(t[22]=e("label",{for:"search"},"Pesquisar",-1)),e("div",Zt,[c(e("input",{id:"search","onUpdate:modelValue":t[3]||(t[3]=n=>l.search=n),type:"text",placeholder:"Buscar itens..."},null,512),[[h,l.search]]),l.search?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar pesquisa",type:"button",onClick:t[4]||(t[4]=n=>E("search"))}," × ")):d("",!0)])]),e("div",te,[t[24]||(t[24]=e("label",{for:"title"},"Título",-1)),e("div",ee,[c(e("select",{id:"title","onUpdate:modelValue":t[5]||(t[5]=n=>l.title=n)},[t[23]||(t[23]=e("option",{value:""},"Todos os títulos",-1)),(o(!0),i(_,null,x(ft.value,n=>(o(),i("option",{key:n,value:n},r(n),9,le))),128))],512),[[ot,l.title]]),l.title?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar título",type:"button",onClick:t[6]||(t[6]=n=>E("title"))}," × ")):d("",!0)])]),e("div",se,[t[26]||(t[26]=e("label",{for:"locale"},"Local",-1)),e("div",ne,[c(e("select",{id:"locale","onUpdate:modelValue":t[7]||(t[7]=n=>l.locale=n)},[t[25]||(t[25]=e("option",{value:""},"Todos os locais",-1)),(o(!0),i(_,null,x(bt.value,n=>(o(),i("option",{key:n,value:n},r(n),9,ae))),128))],512),[[ot,l.locale]]),l.locale?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar local",type:"button",onClick:t[8]||(t[8]=n=>E("locale"))}," × ")):d("",!0)])]),e("div",oe,[t[27]||(t[27]=e("label",{for:"date"},"Data",-1)),e("div",ie,[c(e("input",{id:"date","onUpdate:modelValue":t[9]||(t[9]=n=>l.date=n),type:"date"},null,512),[[h,l.date]]),l.date?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar data",type:"button",onClick:t[10]||(t[10]=n=>E("date"))}," × ")):d("",!0)])]),e("div",re,[t[28]||(t[28]=e("label",null,"Intervalo de Datas",-1)),e("div",ue,[c(e("input",{"onUpdate:modelValue":t[11]||(t[11]=n=>l.start=n),type:"date"},null,512),[[h,l.start]]),c(e("input",{"onUpdate:modelValue":t[12]||(t[12]=n=>l.end=n),type:"date"},null,512),[[h,l.end]]),l.start||l.end?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar datas",type:"button",onClick:t[13]||(t[13]=n=>E("date"))}," × ")):d("",!0)])])]),e("div",null,[e("div",de,[t[29]||(t[29]=e("label",null,"Agendas",-1)),e("div",null,[(o(!0),i(_,null,x(m(mt),n=>(o(),i("div",{key:n},[c(e("input",{id:"cat-"+n,"onUpdate:modelValue":t[14]||(t[14]=f=>l.calendars=f),type:"checkbox",value:n,style:{margin:"5px 5px 0 0"}},null,8,pe),[[At,l.calendars]]),e("label",{for:"cat-"+n,style:{"margin-bottom":"0"}},r(n),9,ve)]))),128))])]),e("div",ce,[t[30]||(t[30]=e("label",null,null,-1)),e("button",{class:"success",disabled:V.value||m(g).loading,onClick:t[15]||(t[15]=n=>ct())},r(V.value||m(g).loading?"Atualizando...":"Aplicar"),9,fe)])])]),e("div",be,[e("span",null,[t[31]||(t[31]=e("i",{class:"la la-calendar-check"},null,-1)),z(" "+r(((et=(tt=m(g))==null?void 0:tt.calendars)==null?void 0:et.length)||0),1)]),e("span",null,[t[32]||(t[32]=e("i",{class:"la la-tasks"},null,-1)),z(" "+r(Array.isArray(m(g).eventsFiltered)?m(g).eventsFiltered.length:0),1)])])])],512),[[q,p.value==="filters"]]),c(e("div",me,[e("div",ge,[t[36]||(t[36]=e("b",{class:"mb-4 p"},"Ajustes de impressão:",-1)),e("div",ye,[t[33]||(t[33]=e("label",null,"Fonte",-1)),c(e("input",{"onUpdate:modelValue":t[16]||(t[16]=n=>l.fontSize=n),type:"range",min:"10",max:"25",step:"0.1",placeholder:"Font Size"},null,512),[[h,l.fontSize,void 0,{number:!0}]]),c(e("input",{"onUpdate:modelValue":t[17]||(t[17]=n=>l.fontSize=n),type:"number",min:"10",max:"25",step:"0.1",style:{width:"70px","margin-left":"8px"},onInput:yt},null,544),[[h,l.fontSize,void 0,{number:!0}]]),t[34]||(t[34]=z(" px "))]),e("div",{class:"p"},[e("button",{class:"success",onClick:_t},t[35]||(t[35]=[e("i",{class:"la la-print"},null,-1),z(" Imprimir ")]))])]),e("div",ke,[e("div",_e,[t[37]||(t[37]=e("b",null,"Lista",-1)),e("div",null,[e("i",{class:S(["la",G.value?"la-toggle-on":"la-toggle-off"]),title:"Ocultar todos",onClick:t[18]||(t[18]=n=>St(!G.value))},null,2)])]),(o(!0),i(_,null,x(b.value,(n,f)=>(o(),i("div",{key:n.title,class:S(["settings-list print-hide",{"drag-over":$.value===f}]),draggable:"true",onDragstart:u=>j(f),onDragover:it(u=>M(f),["prevent"]),onDrop:u=>B(f)},[z(r(n.title)+" ",1),e("i",{class:S(["la",y[n.title]?"la-toggle-on":"la-toggle-off"]),title:"Alterar visibilidade",onClick:u=>R(n.title)},null,10,De)],42,Se))),128))])],512),[[q,p.value==="print"]])])]),b.value.length?(o(),i("div",Ce,[(o(!0),i(_,null,x(b.value,(n,f)=>c((o(),i("div",{key:n.title,class:S(["table-list",{"drag-over":$.value===f}]),draggable:"true",style:{cursor:"move"},onDragstart:u=>j(f),onDragover:it(u=>M(f),["prevent"]),onDrop:u=>B(f)},[e("div",xe,[e("table",null,[e("thead",null,[e("tr",null,[e("th",ze,[e("div",Ee,[z(r(n.title)+" ",1),e("i",{class:"la la-toggle-on print-hide",style:{cursor:"pointer"},onClick:u=>R(n.title)},null,8,Te)])])])]),e("tbody",null,[(o(!0),i(_,null,x(n.items,u=>(o(),i("tr",{key:u.id},[e("td",null,[u.formatDate?(o(),i("span",$e,r(u.formatDate),1)):d("",!0)]),e("td",null,[u.formatWeek?(o(),i("span",Ae,r(u.formatWeek),1)):d("",!0)]),e("td",null,[u.formatTime?(o(),i("span",Le,r(u.formatTime),1)):d("",!0)]),e("td",null,r(u.locale),1),e("td",null,[u.desc?(o(),i("span",{key:0,innerHTML:m(Lt)(u.desc)},null,8,Ve)):d("",!0)])]))),128))])])])],42,he)),[[q,y[n.title]]])),128)),A.value?(o(),at(m(qt),{key:0,editor:A.value,class:"editable"},null,8,["editor"])):d("",!0)])):d("",!0)],64))],4)}}},je=Ct(we,[["__scopeId","data-v-3b3dbb99"]]);export{je as default};
