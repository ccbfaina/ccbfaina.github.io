import{L as it}from"./hcp5vuFM.js";import{_ as ot,x as rt,r as S,A as ct,D as T,h,c as a,C as ut,m as f,F as k,a as s,z as g,n as D,t as c,i as C,v as A,b as dt,e as P,k as j,g as vt,l as pt,o as n,N as ft,O as bt}from"./DUsU1EbR.js";import{F as mt}from"./BV0JURaq.js";import"./BcZQbp_F.js";const gt={class:"tabs-container print-hide"},yt={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},_t=["aria-selected"],ht={class:"badge"},kt=["aria-selected"],Dt={class:"badge"},Ct=["aria-selected"],At={class:"tab-content"},Ot={id:"tab-content-lista",role:"tabpanel",class:"text-center"},St={key:0},Tt={key:1},jt={key:2},$t={key:3},Ft={id:"tab-content-filters",role:"tabpanel"},Lt={id:"tab-content-print",role:"tabpanel"},Nt={style:{"margin-top":"10px"},class:"a4"},wt={class:"settings-list"},Bt=["onDragstart","onDragover","onDrop"],Mt=["onClick"],Vt=["onClick"],It={key:0,class:"print-page"},Rt={colspan:"5",class:"text-center",style:{"text-transform":"uppercase"}},Gt={key:0,class:"nowrap"},xt={key:0},zt=["innerHTML"],Et={__name:"calendar",setup(qt){const{lista:i}=rt(),$=vt(),Y=pt(),u=S("lista"),Q=S(null),o=ct({}),O=S([]);function X(e){O.value=e}const F=e=>e==null?void 0:e.replace(/-$/,"").trim(),Z=e=>{const t=e.toLocaleString("pt-BR",{month:"long",year:"numeric"});return t.charAt(0).toUpperCase()+t.slice(1)},tt=()=>{const e=$.query;if(i.filters={...i.filters,...["search","title","locale","date","start","end"].reduce((t,l)=>(e[l]&&(t[l]=e[l]),t),{})},i.filters.calendars=e.calendars?Array.isArray(e.calendars)?e.calendars:e.calendars.split(","):[],e.visible&&Object.keys(o).length){const t=Array.isArray(e.visible)?e.visible:e.visible.split(",");for(const l of Object.keys(o))o[l]=t.includes(l)}},et=()=>{const e=Object.entries(o).filter(([l,d])=>d).map(([l])=>l),t={...$.query};e.length?t.visible=e.join(","):delete t.visible,Y.replace({query:t})};T(()=>JSON.stringify(o),()=>et());const st=h(()=>{const e=i.filters;return e?["search","title","locale","date","calendars"].filter(t=>e[t]&&(Array.isArray(e[t])?e[t].length:!0)).length:0}),lt=h(()=>Object.values(o).filter(Boolean).length),nt=()=>{u.value="lista",setTimeout(()=>{window.print(),u.value="print"},500)},L=h(()=>{const e={},t=(O.value||[]).filter(l=>!["AVISOS À IRMANDADE"].includes(l.title));for(const l of t){if(!l.onDate||isNaN(l.onDate))continue;const d=new Date(l.onDate.getFullYear(),l.onDate.getMonth(),1),p=d.toISOString();e[p]||(e[p]={month:d,items:[]}),e[p].items.push(l)}return Object.values(e).map(({month:l,items:d})=>({month:l,items:d.sort((p,b)=>{var m,_;return(((m=p.onDate)==null?void 0:m.getTime())||0)-(((_=b.onDate)==null?void 0:_.getTime())||0)||(p.title||"").localeCompare(b.title||"")})})).sort((l,d)=>l.month-d.month)}),N=e=>o[e]=!o[e],at=h(()=>Object.values(o).every(Boolean)),w=e=>Object.keys(o).forEach(t=>o[t]=e),B=h(()=>{const e=new Map;for(const t of O.value||[]){const l=t.title||"Sem título";e.has(l)||e.set(l,[]),e.get(l).push(t)}return[...e.entries()].map(([t,l])=>({title:t,items:l.sort((d,p)=>{var b,m;return((b=d.onDate)==null?void 0:b.getTime())-((m=p.onDate)==null?void 0:m.getTime())||(d.title||"").localeCompare(p.title||"")})}))});return T(()=>i.eventsFiltered,()=>{for(const e of i.eventsFiltered||[]){const t=e.title||"Sem título";t in o||(o[t]=!0)}tt()},{immediate:!0}),T(B,e=>{e.forEach(({title:t})=>{t in o||(o[t]=!0)})},{immediate:!0}),(e,t)=>{var d,p,b,m,_,M,V,I,R,G,x,z,E,q,U,W,H,J,K;const l=it;return n(),a("div",null,[f(i).loading?(n(),ut(l,{key:0})):(n(),a(k,{key:1},[s("div",gt,[s("nav",yt,[s("span",{id:"tab-filters","aria-selected":u.value==="filters",role:"tab",type:"button",class:D(["tab",{active:u.value==="filters"}]),style:{position:"relative"},onClick:t[0]||(t[0]=v=>u.value="filters")},[s("span",ht,c(st.value),1),t[5]||(t[5]=s("i",{class:"la la-filter z-10"},null,-1))],10,_t),s("span",{id:"tab-print","aria-selected":u.value==="print",role:"tab",type:"button",class:D(["tab",{active:u.value==="print"}]),onClick:t[1]||(t[1]=v=>u.value="print")},[s("span",Dt,c(lt.value),1),t[6]||(t[6]=s("i",{class:"la la-print"},null,-1))],10,kt),s("span",{id:"tab-lista","aria-selected":u.value==="lista",role:"tab",type:"button",class:D(["tab",{active:u.value==="lista"}]),onClick:t[2]||(t[2]=v=>u.value="lista")}," Calendário ",10,Ct)])]),s("div",At,[C(s("div",Ot,[t[7]||(t[7]=s("div",null,"CALENDÁRIO",-1)),(p=(d=f(i).filters)==null?void 0:d.calendars)!=null&&p.length?(n(),a("div",St,[s("b",null,c(f(i).filters.calendars.map(F).join(", ")),1)])):g("",!0),(b=f(i).filters)!=null&&b.locale?(n(),a("div",Tt,[s("b",null,c(F((m=f(i).filters)==null?void 0:m.locale)),1)])):g("",!0),(_=f(i).filters)!=null&&_.date?(n(),a("div",jt," Data: "+c((R=(I=(V=(M=f(i).filters.date)==null?void 0:M.split("T")[0])==null?void 0:V.split("-"))==null?void 0:I.reverse())==null?void 0:R.join("/")),1)):g("",!0),s("div",null,c((q=(E=(z=(x=(G=f(i).filters)==null?void 0:G.start)==null?void 0:x.split("T")[0])==null?void 0:z.split("-"))==null?void 0:E.reverse())==null?void 0:q.join("/"))+" à "+c((K=(J=(H=(W=(U=f(i).filters)==null?void 0:U.end)==null?void 0:W.split("T")[0])==null?void 0:H.split("-"))==null?void 0:J.reverse())==null?void 0:K.join("/")),1),f(i).filters.search?(n(),a("div",$t,c(f(i).filters.search),1)):g("",!0)],512),[[A,u.value==="lista"]]),C(s("div",Ft,[dt(mt,{"onUpdate:filtered":X})],512),[[A,u.value==="filters"]]),C(s("div",Lt,[s("div",{class:"text-center"},[t[9]||(t[9]=s("p",{class:"mb-4"},"Ajustes de impressão:",-1)),s("button",{class:"success",onClick:nt},t[8]||(t[8]=[s("i",{class:"la la-print"},null,-1),P(" Imprimir ")]))]),s("div",Nt,[s("div",wt,[t[10]||(t[10]=s("b",null,"Lista",-1)),s("div",null,[at.value?(n(),a("i",{key:0,class:"la la-toggle-on",title:"Ocultar todos",onClick:t[3]||(t[3]=v=>w(!1))})):(n(),a("i",{key:1,class:"la la-toggle-off",title:"Mostrar todos",onClick:t[4]||(t[4]=v=>w(!0))}))])]),(n(!0),a(k,null,j(B.value,(v,y)=>(n(),a("div",{key:v.title,class:D(["settings-list",{"drag-over":Q.value===y}]),draggable:"true",onDragstart:r=>e.onDragStart(y),onDragover:ft(r=>e.onDragOver(y),["prevent"]),onDrop:r=>e.onDrop(y)},[P(c(v.title)+" ",1),o[v.title]?(n(),a("i",{key:1,class:"la la-toggle-on",onClick:r=>N(v.title)},null,8,Vt)):(n(),a("i",{key:0,class:"la la-toggle-off",onClick:r=>N(v.title)},null,8,Mt))],42,Bt))),128))])],512),[[A,u.value==="print"]])]),L.value.length?(n(),a("div",It,[(n(!0),a(k,null,j(L.value,({month:v,items:y})=>(n(),a("div",{key:v,class:"month-section"},[s("table",null,[s("thead",null,[s("tr",null,[s("th",Rt,c(Z(v)),1)])]),s("tbody",null,[(n(!0),a(k,null,j(y,r=>C((n(),a("tr",{key:r.id},[s("td",null,[r.formatDate?(n(),a("span",Gt,c(r.formatDate.split("/")[0])+" | "+c(r.formatWeek),1)):g("",!0)]),s("td",null,[r.formatTime?(n(),a("span",xt,c(r.formatTime),1)):g("",!0)]),s("td",null,c(r.locale),1),s("td",null,c(r.title),1),s("td",null,[r.desc?(n(),a("span",{key:0,innerHTML:f(bt)(r.desc)},null,8,zt)):g("",!0)])])),[[A,o[r.title||"Sem título"]]])),128))])])]))),128))])):g("",!0)],64))])}}},Kt=ot(Et,[["__scopeId","data-v-d2e92dec"]]);export{Kt as default};
