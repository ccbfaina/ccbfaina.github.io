import{L as _t}from"./Dr9FLoPf.js";import{_ as St,y as Dt,r as h,I as nt,h as y,f as st,B as j,P as Ct,c as i,C as ot,p as x,F as k,a as e,m as c,n as _,t as d,i as v,v as O,A as $,k as z,G as at,e as E,K as ht,g as xt,Q as R,l as $t,R as zt,o as a,H as Et,M as it,O as Tt}from"./C5rNtuYf.js";import{d as Lt,a as At,S as wt,E as It}from"./D2gOrVmJ.js";const Vt={class:"tabs-container print-hide"},qt={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},Ut=["aria-selected"],Ot={class:"badge"},Mt=["aria-selected"],jt=["aria-selected"],Rt={class:"tab-content"},Ft={id:"tab-content-lista",role:"tabpanel"},Bt={class:"text-center"},Gt={key:0},Pt={key:1},Nt={key:2},Ht={key:3},Kt={key:4},Wt={id:"tab-content-filters",role:"tabpanel"},Qt={class:"content"},Jt={class:"form-inline"},Xt={class:"form-group"},Yt={class:"row"},Zt={class:"form-group"},te={class:"row"},ee=["value"],le={class:"form-group"},ne={class:"row"},se=["value"],oe={class:"form-group"},ae={class:"flex gap-xs"},ie={class:"form-group"},re={class:"flex gap-xs"},de={class:"form-group",style:{"align-items":"flex-start"}},ue=["id","value"],ce=["for"],pe={class:"form-group",style:{"text-align":"right"}},ve=["disabled"],fe={class:"form-inline",style:{gap:"1rem","margin-top":"1rem"}},me={id:"tab-content-print",role:"tabpanel"},be={class:"text-center flex col items-center gap-4"},ge={class:"p form-group flex items-center aling-center"},ye={class:"a4 print-hide"},ke={class:"settings-list print-hide"},_e=["onDragstart","onDragover","onDrop"],Se=["onClick"],De={key:0,class:"print-page"},Ce=["onDragstart","onDragover","onDrop"],he={class:"table-container"},xe={colspan:"5"},$e={class:"flex items-center aling-center justify-center"},ze=["onClick"],Ee=["onDblclick"],Te={key:0},Le={key:0},Ae={key:0},we=["innerHTML"],Ie={__name:"index",setup(Ve){const{lista:S}=Dt(),p=h("lista"),l=nt({fontSize:17,search:"",title:"",locale:"",date:"",start:"",end:"",calendars:[]}),rt=xt(),dt=$t(),F=h(!1),ut=()=>{const n=rt.query||{};["search","title","locale","date","start","end"].forEach(g=>{n[g]!==void 0&&(l[g]=n[g])}),n.calendars&&(l.calendars=Array.isArray(n.calendars)?n.calendars:n.calendars.split(",").filter(Boolean));const{today:o,future:u}=R();l.start||(l.start=o),l.end||(l.end=u)},B=Lt(()=>{const n=Object.fromEntries(Object.entries(l).filter(([t,o])=>t==="calendars"?o.length:o!==""&&o!=null).map(([t,o])=>Array.isArray(o)?[t,o.join(",")]:[t,o]));dt.replace({query:n})},200),D=y(()=>{const n=zt(S.allEvents||[],l);return Array.from(new Set(n.map(o=>o.id))).map(o=>n.find(u=>u.id===o))});function ct(){B()}st(()=>{ut()}),j(l,B,{deep:!0});function T(n){if(n==="calendars")l.calendars=[];else if(n==="date"){l.date="";const{today:t,future:o}=R();l.start=t,l.end=o}else if(n==="start"||n==="end"){const{today:t,future:o}=R();l.start=t,l.end=o}else l[n]=""}function M(n,t){return Array.from(new Set(n.map(o=>o[t]).filter(o=>typeof o=="string"&&o.trim())))}const pt=y(()=>M(D.value,"title")),vt=y(()=>M(D.value,"locale")),ft=y(()=>M(S.allEvents,"list")),L=h([]);j(D,n=>{const t=Array.from(new Set(n.map(u=>u.title||"Sem título"))),o=L.value.filter(u=>t.includes(u));t.forEach(u=>{o.includes(u)||o.push(u)}),L.value=o},{immediate:!0});const m=y(()=>{const n={};return D.value.forEach(t=>{const o=t.title||"Sem título";(n[o]||(n[o]=[])).push(t)}),L.value.filter(t=>n[t]).map(t=>({title:t,items:n[t].slice().sort((o,u)=>o.onDate&&u.onDate?o.onDate-u.onDate:0)}))});function mt(){l.fontSize<10&&(l.fontSize=10),l.fontSize>25&&(l.fontSize=25),l.fontSize=Math.round(l.fontSize*10)/10}const G=n=>{var t;return(t=n==null?void 0:n.replace(/-$/,""))==null?void 0:t.trim()},bt=y(()=>{let n=0;return l.search&&n++,l.title&&n++,l.locale&&n++,l.date&&n++,l.calendars&&l.calendars.length>0&&n++,n}),gt=()=>{p.value="lista",setTimeout(()=>{window.print()},1e3)},C=h(null),A=h(null),P=n=>{C.value=n},N=n=>{A.value=n},H=n=>{if(C.value===null||C.value===n){C.value=null,A.value=null;return}const t=L.value.slice(),[o]=t.splice(C.value,1);t.splice(n,0,o),L.value=t,C.value=null,A.value=null},b=nt({});j(m,()=>{m.value&&m.value.forEach(n=>{n.title in b||(b[n.title]=!0)})},{immediate:!0});const K=n=>{p.value="print",b[n]=!b[n]},W=y(()=>m.value.length>0&&m.value.every(n=>b[n.title])),yt=n=>{m.value.forEach(t=>{b[t.title]=n})},kt=n=>{const t=new Date(n.date).toISOString().replace(/-|:|\.\d{3}/g,""),o=new Date(n.end).toISOString().replace(/-|:|\.\d{3}/g,""),u=encodeURIComponent(n.title||"Evento"),g=`${t}/${o}`,I=n.desc?n.desc.replace(/<[^>]*>?/gm,""):"",V=encodeURIComponent(I),q=encodeURIComponent(n.locale||""),U=`https://calendar.google.com/calendar/render?action=TEMPLATE&text=${u}&dates=${g}&details=${V}&location=${q}`;window.open(U,"_blank")},w=h(null);return st(()=>{w.value=new At({extensions:[wt],content:`
      <p>Oração Santa Ceia</p>
      <p><strong>Pão:</strong> "Senhor, abençoa este Pão que vamos comer, que é a comunhão do Corpo de Cristo."</p>
      <p><strong>Cálice:</strong> "Senhor, abençoa o Cálice que vamos beber, que é a comunhão do Sangue de Cristo."</p>
    `,editable:!0})}),Ct(()=>{w.value&&w.value.destroy()}),(n,t)=>{var u,g,I,V,q,U,Q,J,X,Y,Z,tt,et,lt;const o=_t;return a(),i("div",{style:ht({fontSize:(l.fontSize?l.fontSize:17)+"px"})},[x(S).loading?(a(),ot(o,{key:0})):(a(),i(k,{key:1},[e("div",Vt,[e("nav",qt,[e("span",{id:"tab-filters","aria-selected":p.value==="filters",role:"tab",type:"button",class:_(["tab",{active:p.value==="filters"}]),style:{position:"relative"},onClick:t[0]||(t[0]=s=>p.value="filters")},[e("span",Ot,d(bt.value),1),t[19]||(t[19]=e("i",{class:"la la-filter z-10"},null,-1))],10,Ut),e("span",{id:"tab-print","aria-selected":p.value==="print",role:"tab",type:"button",class:_(["tab",{active:p.value==="print"}]),onClick:t[1]||(t[1]=s=>p.value="print")},t[20]||(t[20]=[e("i",{class:"la la-print"},null,-1)]),10,Mt),e("span",{id:"tab-lista","aria-selected":p.value==="lista",role:"tab",type:"button",class:_(["tab",{active:p.value==="lista"}]),onClick:t[2]||(t[2]=s=>p.value="lista")}," Lista ",10,jt)])]),e("div",null,[e("div",Rt,[v(e("div",Ft,[e("div",Bt,[t[21]||(t[21]=e("div",null,"LISTA DE ATENDIMENTO E DIVERSOS",-1)),l.calendars.length?(a(),i("div",Gt,[e("b",null,d(l.calendars.map(G).join(", ")),1)])):c("",!0),l.locale?(a(),i("span",Pt,[e("b",null,d(G(l.locale)),1)])):c("",!0),l.date?(a(),i("span",Nt," Data: "+d((V=(I=(g=(u=l.date)==null?void 0:u.split("T")[0])==null?void 0:g.split("-"))==null?void 0:I.reverse())==null?void 0:V.join("/")),1)):c("",!0),!l.date&&(l.start||l.end)?(a(),i("div",Ht," Período: "+d((J=(Q=(U=(q=l.start)==null?void 0:q.split("T")[0])==null?void 0:U.split("-"))==null?void 0:Q.reverse())==null?void 0:J.join("/"))+" à "+d((tt=(Z=(Y=(X=l.end)==null?void 0:X.split("T")[0])==null?void 0:Y.split("-"))==null?void 0:Z.reverse())==null?void 0:tt.join("/")),1)):c("",!0),l.search?(a(),i("div",Kt,d(l.search),1)):c("",!0)])],512),[[O,p.value==="lista"]]),v(e("div",Wt,[e("div",Qt,[e("div",Jt,[e("div",null,[e("div",Xt,[t[22]||(t[22]=e("label",{for:"search"},"Pesquisar",-1)),e("div",Yt,[v(e("input",{id:"search","onUpdate:modelValue":t[3]||(t[3]=s=>l.search=s),type:"text",placeholder:"Buscar itens..."},null,512),[[$,l.search]]),l.search?(a(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar pesquisa",type:"button",onClick:t[4]||(t[4]=s=>T("search"))}," × ")):c("",!0)])]),e("div",Zt,[t[24]||(t[24]=e("label",{for:"title"},"Título",-1)),e("div",te,[v(e("select",{id:"title","onUpdate:modelValue":t[5]||(t[5]=s=>l.title=s)},[t[23]||(t[23]=e("option",{value:""},"Todos os títulos",-1)),(a(!0),i(k,null,z(pt.value,s=>(a(),i("option",{key:s,value:s},d(s),9,ee))),128))],512),[[at,l.title]]),l.title?(a(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar título",type:"button",onClick:t[6]||(t[6]=s=>T("title"))}," × ")):c("",!0)])]),e("div",le,[t[26]||(t[26]=e("label",{for:"locale"},"Local",-1)),e("div",ne,[v(e("select",{id:"locale","onUpdate:modelValue":t[7]||(t[7]=s=>l.locale=s)},[t[25]||(t[25]=e("option",{value:""},"Todos os locais",-1)),(a(!0),i(k,null,z(vt.value,s=>(a(),i("option",{key:s,value:s},d(s),9,se))),128))],512),[[at,l.locale]]),l.locale?(a(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar local",type:"button",onClick:t[8]||(t[8]=s=>T("locale"))}," × ")):c("",!0)])]),e("div",oe,[t[27]||(t[27]=e("label",{for:"date"},"Data",-1)),e("div",ae,[v(e("input",{id:"date","onUpdate:modelValue":t[9]||(t[9]=s=>l.date=s),type:"date"},null,512),[[$,l.date]]),l.date?(a(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar data",type:"button",onClick:t[10]||(t[10]=s=>T("date"))}," × ")):c("",!0)])]),e("div",ie,[t[28]||(t[28]=e("label",null,"Intervalo de Datas",-1)),e("div",re,[v(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>l.start=s),type:"date"},null,512),[[$,l.start]]),v(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>l.end=s),type:"date"},null,512),[[$,l.end]]),l.start||l.end?(a(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar datas",type:"button",onClick:t[13]||(t[13]=s=>T("date"))}," × ")):c("",!0)])])]),e("div",null,[e("div",de,[t[29]||(t[29]=e("label",null,"Agendas",-1)),e("div",null,[(a(!0),i(k,null,z(ft.value,s=>(a(),i("div",{key:s},[v(e("input",{id:"cat-"+s,"onUpdate:modelValue":t[14]||(t[14]=f=>l.calendars=f),type:"checkbox",value:s,style:{margin:"5px 5px 0 0"}},null,8,ue),[[Et,l.calendars]]),e("label",{for:"cat-"+s,style:{"margin-bottom":"0"}},d(s),9,ce)]))),128))])]),e("div",pe,[t[30]||(t[30]=e("label",null,null,-1)),e("button",{class:"success",disabled:F.value||x(S).loading,onClick:t[15]||(t[15]=s=>ct())},d(F.value||x(S).loading?"Atualizando...":"Aplicar"),9,ve)])])]),e("div",fe,[e("span",null,[t[31]||(t[31]=e("i",{class:"la la-calendar-check"},null,-1)),E(" "+d(((lt=(et=x(S))==null?void 0:et.calendars)==null?void 0:lt.length)||0),1)]),e("span",null,[t[32]||(t[32]=e("i",{class:"la la-tasks"},null,-1)),E(" "+d(Array.isArray(D.value)?D.value.length:0),1)])])])],512),[[O,p.value==="filters"]]),v(e("div",me,[e("div",be,[t[36]||(t[36]=e("b",{class:"mb-4 p"},"Ajustes de impressão:",-1)),e("div",ge,[t[33]||(t[33]=e("label",null,"Fonte",-1)),v(e("input",{"onUpdate:modelValue":t[16]||(t[16]=s=>l.fontSize=s),type:"range",min:"10",max:"25",step:"0.1",placeholder:"Font Size"},null,512),[[$,l.fontSize,void 0,{number:!0}]]),v(e("input",{"onUpdate:modelValue":t[17]||(t[17]=s=>l.fontSize=s),type:"number",min:"10",max:"25",step:"0.1",style:{width:"70px","margin-left":"8px"},onInput:mt},null,544),[[$,l.fontSize,void 0,{number:!0}]]),t[34]||(t[34]=E(" px "))]),e("div",{class:"p"},[e("button",{class:"success",onClick:gt},t[35]||(t[35]=[e("i",{class:"la la-print"},null,-1),E(" Imprimir ")]))])]),e("div",ye,[e("div",ke,[t[37]||(t[37]=e("b",null,"Lista",-1)),e("div",null,[e("i",{class:_(["la",W.value?"la-toggle-on":"la-toggle-off"]),title:"Ocultar todos",onClick:t[18]||(t[18]=s=>yt(!W.value))},null,2)])]),(a(!0),i(k,null,z(m.value,(s,f)=>(a(),i("div",{key:s.title,class:_(["settings-list print-hide",{"drag-over":A.value===f}]),draggable:"true",onDragstart:r=>P(f),onDragover:it(r=>N(f),["prevent"]),onDrop:r=>H(f)},[E(d(s.title)+" ",1),e("i",{class:_(["la",b[s.title]?"la-toggle-on":"la-toggle-off"]),title:"Alterar visibilidade",onClick:r=>K(s.title)},null,10,Se)],42,_e))),128))])],512),[[O,p.value==="print"]])])]),m.value.length?(a(),i("div",De,[(a(!0),i(k,null,z(m.value,(s,f)=>v((a(),i("div",{key:s.title,class:_(["table-list",{"drag-over":A.value===f}]),draggable:"true",style:{cursor:"move"},onDragstart:r=>P(f),onDragover:it(r=>N(f),["prevent"]),onDrop:r=>H(f)},[e("div",he,[e("table",null,[e("thead",null,[e("tr",null,[e("th",xe,[e("div",$e,[E(d(s.title)+" ",1),e("i",{class:"la la-toggle-on print-hide",style:{cursor:"pointer"},onClick:r=>K(s.title)},null,8,ze)])])])]),e("tbody",null,[(a(!0),i(k,null,z(s.items,r=>(a(),i("tr",{key:r.id,onDblclick:Ue=>kt(r)},[e("td",null,[r.formatDate?(a(),i("span",Te,d(r.formatDate),1)):c("",!0)]),e("td",null,[r.formatWeek?(a(),i("span",Le,d(r.formatWeek),1)):c("",!0)]),e("td",null,[r.formatTime?(a(),i("span",Ae,d(r.formatTime),1)):c("",!0)]),e("td",null,d(r.locale),1),e("td",null,[r.desc?(a(),i("span",{key:0,innerHTML:x(Tt)(r.desc)},null,8,we)):c("",!0)])],40,Ee))),128))])])])],42,Ce)),[[O,b[s.title]]])),128)),w.value?(a(),ot(x(It),{key:0,editor:w.value,class:"editable"},null,8,["editor"])):c("",!0)])):c("",!0)],64))],4)}}},Re=St(Ie,[["__scopeId","data-v-2ce2f9b5"]]);export{Re as default};
