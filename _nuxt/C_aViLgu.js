import{L as at}from"./J6iyAyYO.js";import{_ as nt,y as ot,r as T,I as U,h as y,f as z,B as F,c as i,C as it,p as A,F as k,a as e,m as c,n as x,t as r,i as b,v as w,A as L,k as h,G as N,e as D,g as rt,Q as V,l as ut,R as dt,o,H as ct,O as pt}from"./M9ouRNVy.js";import{d as vt}from"./BcZQbp_F.js";const ft={class:"tabs-container print-hide"},bt={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},mt=["aria-selected"],yt={class:"badge"},gt=["aria-selected"],kt={class:"badge"},_t=["aria-selected"],ht={class:"tab-content"},Ct={id:"tab-content-lista",role:"tabpanel"},At={class:"text-center"},xt={key:0},wt={key:1},Lt={key:2},Dt={key:3},$t={key:4},St={id:"tab-content-filters",role:"tabpanel"},Tt={class:"content"},Vt={class:"form-inline"},Ot={class:"form-group"},jt={class:"row"},qt={class:"form-group"},Bt={class:"row"},Et=["value"],Mt={class:"form-group"},Gt={class:"row"},It=["value"],Rt={class:"form-group"},Ut={class:"flex gap-xs"},zt={class:"form-group"},Ft={class:"flex gap-xs"},Nt={class:"form-group",style:{"align-items":"flex-start"}},Ht=["id","value"],Pt=["for"],Qt={class:"form-group",style:{"text-align":"right"}},Wt=["disabled"],Yt={class:"form-inline",style:{gap:"1rem","margin-top":"1rem"}},Jt={id:"tab-content-print",role:"tabpanel"},Kt={class:"a4 print-hide"},Xt={class:"settings-list print-hide"},Zt=["onClick"],te={key:0,class:"print-page"},ee={colspan:"5",class:"text-center",style:{"text-transform":"uppercase"}},le=["onDblclick"],se={key:0,class:"nowrap"},ae={key:0},ne=["innerHTML"],oe={__name:"calendar",setup(ie){const{lista:_}=ot(),H=rt(),P=ut(),u=T("lista"),O=T(!1),l=U({search:"",title:"",locale:"",date:"",start:"",end:"",calendars:[]}),p=U({}),j=T([]),q=s=>s==null?void 0:s.replace(/-$/,"").trim(),$=s=>{if(!s)return"";const t=s.split("T")[0];return t?t.split("-").reverse().join("/"):""},S=(s,t)=>Array.from(new Set(s.map(n=>n[t]).filter(n=>typeof n=="string"&&n.trim()))),Q=y(()=>S(m.value,"title")),W=y(()=>S(m.value,"locale")),Y=y(()=>S(_.allEvents,"list")),J=()=>{const s=H.query||{};["search","title","locale","date","start","end"].forEach(v=>{s[v]!==void 0&&(l[v]=s[v])}),s.calendars&&(l.calendars=Array.isArray(s.calendars)?s.calendars:s.calendars.split(",").filter(Boolean));const{today:n,future:d}=V();l.start||(l.start=n),l.end||(l.end=d)},B=vt(()=>{const s=Object.fromEntries(Object.entries(l).filter(([t,n])=>t==="calendars"?n.length:n!==""&&n!=null).map(([t,n])=>Array.isArray(n)?[t,n.join(",")]:[t,n]));P.replace({query:s})},200),K=()=>{B()};z(()=>{J()}),F(l,B,{deep:!0});function C(s){if(s==="calendars")l.calendars=[];else if(s==="date"){l.date="";const{today:t,future:n}=V();l.start=t,l.end=n}else if(s==="start"||s==="end"){const{today:t,future:n}=V();l.start=t,l.end=n}else l[s]=""}const m=y(()=>{const s=dt(_.allEvents||[],l);return Array.from(new Set(s.map(n=>n.id))).map(n=>s.find(d=>d.id===n))}),X=y(()=>{let s=0;return l.search&&s++,l.title&&s++,l.locale&&s++,l.date&&s++,l.calendars&&l.calendars.length>0&&s++,s}),Z=()=>{u.value="lista",setTimeout(()=>{window.print()},1e3)},E=y(()=>{if(!m.value||!m.value.length)return[];const s=m.value.filter(n=>!["AVISOS À IRMANDADE"].includes(n.title)),t=new Map;for(const n of s||[]){if(!n.date)continue;const d=new Date(n.date),v=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}`,a=d.toLocaleDateString("pt-BR",{month:"long",year:"numeric"});t.has(v)||t.set(v,{month:a,items:[]}),t.get(v).items.push(n)}return Array.from(t.entries()).sort(([n],[d])=>n.localeCompare(d)).map(([n,{month:d,items:v}])=>({month:d,items:v.slice().sort((a,g)=>a.onDate-g.onDate||(a.title||"").localeCompare(g.title||"")||(a.locale||"").localeCompare(g.locale||""))}))}),M=y(()=>{const s={};return m.value.forEach(t=>{const n=t.title||"Sem título";(s[n]||(s[n]=[])).push(t)}),Object.keys(s).map(t=>({title:t}))}),G=()=>{const s=Array.from(new Set(m.value.map(t=>t.title||"Sem título")));j.value=s},I=()=>{if(!M.value)return;const s=M.value.map(t=>t.title);s.forEach(t=>{t in p||(p[t]=!0)});for(const t in p)s.includes(t)||delete p[t]};z(()=>{G(),I()}),F(m,()=>{G(),I()});const tt=s=>{u.value="print",p[s]=!p[s]},R=y(()=>Object.values(p).length>0&&Object.values(p).every(Boolean)),et=s=>{for(const t in p)p[t]=s},lt=y(()=>Object.values(p).filter(Boolean).length),st=s=>{const t=`https://www.google.com/calendar/event?eid=${s.htmlLink}`;window.open(t,"_blank")};return(s,t)=>{var d,v;const n=at;return o(),i("div",null,[A(_).loading?(o(),it(n,{key:0})):(o(),i(k,{key:1},[e("div",ft,[e("nav",bt,[e("span",{id:"tab-filters","aria-selected":u.value==="filters",role:"tab",type:"button",class:x(["tab",{active:u.value==="filters"}]),style:{position:"relative"},onClick:t[0]||(t[0]=a=>u.value="filters")},[e("span",yt,r(X.value),1),t[17]||(t[17]=e("i",{class:"la la-filter z-10"},null,-1))],10,mt),e("span",{id:"tab-print","aria-selected":u.value==="print",role:"tab",type:"button",class:x(["tab",{active:u.value==="print"}]),onClick:t[1]||(t[1]=a=>u.value="print")},[e("span",kt,r(lt.value),1),t[18]||(t[18]=e("i",{class:"la la-print"},null,-1))],10,gt),e("span",{id:"tab-lista","aria-selected":u.value==="lista",role:"tab",type:"button",class:x(["tab",{active:u.value==="lista"}]),onClick:t[2]||(t[2]=a=>u.value="lista")}," Calendário ",10,_t)])]),e("div",ht,[b(e("div",Ct,[e("div",At,[t[19]||(t[19]=e("div",null,"CALENDÁRIO",-1)),l.calendars.length?(o(),i("div",xt,[e("b",null,r(l.calendars.map(q).join(", ")),1)])):c("",!0),l.locale?(o(),i("span",wt,[e("b",null,r(q(l.locale)),1)])):c("",!0),l.date?(o(),i("span",Lt," Data: "+r($(l.date)),1)):c("",!0),!l.date&&(l.start||l.end)?(o(),i("div",Dt," Período: "+r($(l.start))+" à "+r($(l.end)),1)):c("",!0),l.search?(o(),i("div",$t,r(l.search),1)):c("",!0)])],512),[[w,u.value==="lista"]]),b(e("div",St,[e("div",Tt,[e("div",Vt,[e("div",null,[e("div",Ot,[t[20]||(t[20]=e("label",{for:"search"},"Pesquisar",-1)),e("div",jt,[b(e("input",{id:"search","onUpdate:modelValue":t[3]||(t[3]=a=>l.search=a),type:"text",placeholder:"Buscar itens..."},null,512),[[L,l.search]]),l.search?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar pesquisa",type:"button",onClick:t[4]||(t[4]=a=>C("search"))}," × ")):c("",!0)])]),e("div",qt,[t[22]||(t[22]=e("label",{for:"title"},"Título",-1)),e("div",Bt,[b(e("select",{id:"title","onUpdate:modelValue":t[5]||(t[5]=a=>l.title=a)},[t[21]||(t[21]=e("option",{value:""},"Todos os títulos",-1)),(o(!0),i(k,null,h(Q.value,a=>(o(),i("option",{key:a,value:a},r(a),9,Et))),128))],512),[[N,l.title]]),l.title?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar título",type:"button",onClick:t[6]||(t[6]=a=>C("title"))}," × ")):c("",!0)])]),e("div",Mt,[t[24]||(t[24]=e("label",{for:"locale"},"Local",-1)),e("div",Gt,[b(e("select",{id:"locale","onUpdate:modelValue":t[7]||(t[7]=a=>l.locale=a)},[t[23]||(t[23]=e("option",{value:""},"Todos os locais",-1)),(o(!0),i(k,null,h(W.value,a=>(o(),i("option",{key:a,value:a},r(a),9,It))),128))],512),[[N,l.locale]]),l.locale?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar local",type:"button",onClick:t[8]||(t[8]=a=>C("locale"))}," × ")):c("",!0)])]),e("div",Rt,[t[25]||(t[25]=e("label",{for:"date"},"Data",-1)),e("div",Ut,[b(e("input",{id:"date","onUpdate:modelValue":t[9]||(t[9]=a=>l.date=a),type:"date"},null,512),[[L,l.date]]),l.date?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar data",type:"button",onClick:t[10]||(t[10]=a=>C("date"))}," × ")):c("",!0)])]),e("div",zt,[t[26]||(t[26]=e("label",null,"Intervalo de Datas",-1)),e("div",Ft,[b(e("input",{"onUpdate:modelValue":t[11]||(t[11]=a=>l.start=a),type:"date"},null,512),[[L,l.start]]),b(e("input",{"onUpdate:modelValue":t[12]||(t[12]=a=>l.end=a),type:"date"},null,512),[[L,l.end]]),l.start||l.end?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar datas",type:"button",onClick:t[13]||(t[13]=a=>C("date"))}," × ")):c("",!0)])])]),e("div",null,[e("div",Nt,[t[27]||(t[27]=e("label",null,"Agendas",-1)),e("div",null,[(o(!0),i(k,null,h(Y.value,a=>(o(),i("div",{key:a},[b(e("input",{id:"cat-"+a,"onUpdate:modelValue":t[14]||(t[14]=g=>l.calendars=g),type:"checkbox",value:a,style:{margin:"5px 5px 0 0"}},null,8,Ht),[[ct,l.calendars]]),e("label",{for:"cat-"+a,style:{"margin-bottom":"0"}},r(a),9,Pt)]))),128))])]),e("div",Qt,[t[28]||(t[28]=e("label",null,null,-1)),e("button",{class:"success",disabled:O.value||A(_).loading,onClick:t[15]||(t[15]=a=>K())},r(O.value||A(_).loading?"Atualizando...":"Aplicar"),9,Wt)])])]),e("div",Yt,[e("span",null,[t[29]||(t[29]=e("i",{class:"la la-calendar-check"},null,-1)),D(" "+r(((v=(d=A(_))==null?void 0:d.calendars)==null?void 0:v.length)||0),1)]),e("span",null,[t[30]||(t[30]=e("i",{class:"la la-tasks"},null,-1)),D(" "+r(Array.isArray(m.value)?m.value.length:0),1)])])])],512),[[w,u.value==="filters"]]),b(e("div",Jt,[e("div",{class:"text-center flex col items-center gap-4"},[t[32]||(t[32]=e("b",{class:"mb-4 p"},"Ajustes de impressão:",-1)),e("div",{class:"p"},[e("button",{class:"success",onClick:Z},t[31]||(t[31]=[e("i",{class:"la la-print"},null,-1),D(" Imprimir ")]))])]),e("div",Kt,[e("div",Xt,[t[33]||(t[33]=e("b",null,"Lista",-1)),e("div",null,[e("i",{class:x(["la",R.value?"la-toggle-on":"la-toggle-off"]),title:"Ocultar todos",onClick:t[16]||(t[16]=a=>et(!R.value))},null,2)])]),(o(!0),i(k,null,h(j.value,a=>(o(),i("div",{key:a,class:"settings-list print-hide",onClick:g=>tt(a)},[D(r(a)+" ",1),e("i",{class:x(["la",p[a]?"la-toggle-on":"la-toggle-off"]),title:"Alterar visibilidade"},null,2)],8,Zt))),128))])],512),[[w,u.value==="print"]])]),E.value.length?(o(),i("div",te,[(o(!0),i(k,null,h(E.value,({month:a,items:g})=>(o(),i("div",{key:a,class:"month-section"},[e("table",null,[e("thead",null,[e("tr",null,[e("th",ee,r(a),1)])]),e("tbody",null,[(o(!0),i(k,null,h(g,f=>b((o(),i("tr",{key:f.id,onDblclick:re=>st(f)},[e("td",null,[f.formatDate?(o(),i("span",se,r(f.formatDate.split("/")[0])+" | "+r(f.formatWeek),1)):c("",!0)]),e("td",null,[f.formatTime?(o(),i("span",ae,r(f.formatTime),1)):c("",!0)]),e("td",null,r(f.title),1),e("td",null,r(f.locale),1),e("td",null,[f.desc?(o(),i("span",{key:0,innerHTML:A(pt)(f.desc)},null,8,ne)):c("",!0)])],40,le)),[[w,p[f.title||"Sem título"]]])),128))])])]))),128))])):c("",!0)],64))])}}},pe=nt(oe,[["__scopeId","data-v-d193f202"]]);export{pe as default};
