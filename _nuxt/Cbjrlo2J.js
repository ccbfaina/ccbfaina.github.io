import{L as ie}from"./Bj3usENl.js";import{_ as de,g as ce,r as y,y as ve,u as he,o as fe,h as pe,i as C,z as M,c as u,A as ge,a as l,t as g,F as m,l as D,f as N,j as be,B as ye,C as Ce,b as r,p as w,q as H,D as q,d as me,w as De,m as _e,E as Ge,e as ke}from"./oOVsQuiL.js";const Me={key:1,class:"calendar-wrapper"},we={class:"calendar-header"},Te={class:"month-year"},Se={class:"calendar-table"},Ee=["onClick"],xe={class:"day-content"},Ne={class:"day-number"},qe={key:0,class:"event-indicators"},Ae={class:"events-panel"},Ue={class:"events-list-container"},Fe={class:"chips-container"},Re={key:0,class:"las la-toggle-on"},$e={key:1,class:"las la-toggle-off"},Ye=["onClick"],ze={key:0,class:"las la-toggle-on"},Be={key:1,class:"las la-toggle-off"},Le={class:"chips-container"},Pe=["onClick"],Oe={key:0,class:"las la-toggle-on"},Xe={key:1,class:"las la-toggle-off"},Ie={class:"search-container"},Ve={key:0},Je={class:"event-date-title"},je={class:"events-list"},He={class:"sub-events-list"},Qe=["innerHTML"],Ke={key:1,class:"no-events-message"},Q=50,We={__name:"agenda",setup(Ze){ce();const b=pe(),A=y(!0),T=new Date,d=y(T.getMonth()),v=y(T.getFullYear()),c=y(null),a=ve({search:"",title:"",locale:"",date:"",start:"",end:"",enabledGroups:[],disabledGroups:[],enabledCalendars:[],disabledCalendars:[]}),{$sw:K}=he(),_=y([]),U=y([]);fe(async()=>{const{events:e,calendars:s}=await K.getEvents({...a,calendars:a.enabledCalendars});_.value=e,console.log("Eventos carregados:",a,_.value.length),U.value=s}),b.query?.regionais==="true"&&a.enabledCalendars.push("Regional Faina","Regional Goiânia","Regional Uruaçu","Regional Bom Jesus","Regional Catalão");function F(){return[]}const G=C(()=>Array.from(new Set(_.value.map(e=>e.group))).filter(e=>e).sort((e,s)=>e.localeCompare(s)));M(G,e=>{if(!(b.query.groups&&b.query.groups.length>0)&&a.enabledGroups.length===0&&a.disabledGroups.length===0){const s=F(),t=F();s.length>0||t.length>0?(a.enabledGroups=s.filter(n=>e.includes(n)),a.disabledGroups=t.filter(n=>e.includes(n))):(a.enabledGroups=e.filter(n=>n!=="Rodízios"),a.disabledGroups=e.filter(n=>n==="Rodízios"))}},{immediate:!0}),M(U,e=>{b.query.calendars&&b.query.calendars.length>0||a.enabledCalendars.length===0&&a.disabledCalendars.length===0&&(a.enabledCalendars=[...e],a.disabledCalendars=[])},{immediate:!0}),M([()=>a.enabledGroups,()=>a.disabledGroups],()=>{},{deep:!0});const W=C(()=>{const e=[...a.enabledGroups,...a.disabledGroups];return Array.from(new Set(e)).sort((t,n)=>t.localeCompare(n))}),Z=C(()=>{const e=[...a.enabledCalendars,...a.disabledCalendars];return Array.from(new Set(e)).sort((t,n)=>t.localeCompare(n))}),R=C(()=>a.enabledGroups.length===G.value.length);M(()=>_.value,()=>{const e=b.query||{};if(["search","title","locale","date","start","end"].forEach(t=>{e[t]!==void 0&&(a[t]=e[t])}),e.groups){const t=Array.isArray(e.groups)?e.groups:e.groups.split(",").filter(Boolean);a.enabledGroups=t.filter(n=>G.value.includes(n)),a.disabledGroups=G.value.filter(n=>!t.includes(n))}if(e.calendars){const t=Array.isArray(e.calendars)?e.calendars:e.calendars.split(",").filter(Boolean);console.log("Calendários da URL:",t),a.enabledCalendars=t,a.disabledCalendars=[]}A.value=!1},{immediate:!0});function ee(e){a.enabledGroups.includes(e)?(a.enabledGroups=a.enabledGroups.filter(t=>t!==e),a.disabledGroups.push(e)):(a.disabledGroups=a.disabledGroups.filter(t=>t!==e),a.enabledGroups.push(e)),a.enabledGroups.sort((t,n)=>t.localeCompare(n)),a.disabledGroups.sort((t,n)=>t.localeCompare(n))}function te(){R.value?(a.disabledGroups=[...G.value],a.enabledGroups=[]):(a.enabledGroups=[...G.value],a.disabledGroups=[])}function ae(e){a.enabledCalendars.includes(e)?(a.enabledCalendars=a.enabledCalendars.filter(t=>t!==e),a.disabledCalendars.push(e)):(a.disabledCalendars=a.disabledCalendars.filter(t=>t!==e),a.enabledCalendars.push(e)),a.enabledCalendars.sort((t,n)=>t.localeCompare(n)),a.disabledCalendars.sort((t,n)=>t.localeCompare(n))}const S=C(()=>{const e=a.search.trim();let s=Ce(_.value||[],a);if(b.query.next==="true"){const n=new Date;s=s.filter(o=>new Date(o.date)>n)}return s=s.filter(n=>a.enabledGroups.includes(n.group)).filter(n=>a.enabledCalendars.includes(n.list)).filter(n=>!n.noDate),s}),$=C(()=>{let e;if(c.value){const t=c.value.date;e=S.value.filter(n=>{const o=new Date(n.date);return o.getUTCFullYear()===t.getFullYear()&&o.getUTCMonth()===t.getMonth()&&o.getUTCDate()===t.getDate()})}else e=S.value.filter(t=>{const n=new Date(t.date);return n.getUTCFullYear()===v.value&&n.getUTCMonth()===d.value});const s=new Map;for(const t of e){const o=new Date(t.date).toISOString().split("T")[0];s.has(o)||s.set(o,new Map);const h=s.get(o);h.has(t.title)||h.set(t.title,[]),h.get(t.title).push(t)}return Array.from(s.entries()).sort(([t],[n])=>new Date(t)-new Date(n))}),Y=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],se=C(()=>`${Y[d.value]} ${v.value}`),z=C(()=>{const e=[],s=new Date(v.value,d.value,1).getDay(),t=new Date(v.value,d.value+1,0).getDate(),n=new Date(v.value,d.value,0).getDate();for(let i=s-1;i>=0;i--)e.push({dayNumber:n-i,date:new Date(v.value,d.value-1,n-i),isPrevMonth:!0,isNextMonth:!1,isToday:!1,hasEvent:!1,events:[]});for(let i=1;i<=t;i++){const p=new Date(v.value,d.value,i),f=S.value.filter(ue=>{const x=new Date(ue.date);return x.getUTCDate()===i&&x.getUTCMonth()===d.value&&x.getUTCFullYear()===v.value});e.push({dayNumber:i,date:p,isPrevMonth:!1,isNextMonth:!1,isToday:p.toDateString()===T.toDateString(),hasEvent:f.length>0,events:f})}const o=42-e.length;for(let i=1;i<=o;i++)e.push({dayNumber:i,date:new Date(v.value,d.value+1,i),isPrevMonth:!1,isNextMonth:!0,isToday:!1,hasEvent:!1,events:[]});const h=[];for(;e.length>0;)h.push(e.splice(0,7));return h});function ne(e){const s=new Date(e),t=s.getUTCDate(),n=Y[s.getUTCMonth()],o=s.getUTCFullYear();return`${t} de ${n} de ${o}`}function k(e){d.value+=e,d.value<0?(d.value=11,v.value--):d.value>11&&(d.value=0,v.value++),c.value=null}function le(e){return{"prev-month-day":e.isPrevMonth||e.isNextMonth,today:e.isToday,"has-event":e.hasEvent,"selected-day":c.value&&e.date&&c.value.date&&c.value.date.toDateString()===e.date.toDateString()}}function B(e){e.isPrevMonth?(k(-1),c.value={...e,date:new Date(v.value,d.value,e.dayNumber)}):e.isNextMonth?(k(1),c.value={...e,date:new Date(v.value,d.value,e.dayNumber)}):c.value&&c.value.date.toDateString()===e.date.toDateString()?c.value=null:c.value=e}if(b.query?.data){const e=z.value[0].find(s=>s.date?.toDateString()===new Date(b.query?.data+" 03:00:00")?.toDateString());e&&B(e)}function oe(e){return c.value?e.some(s=>{const t=new Date(s.date),n=c.value.date;return t.getUTCFullYear()===n.getFullYear()&&t.getUTCMonth()===n.getMonth()&&t.getUTCDate()===n.getDate()}):!1}function re(e){const s=new Set;for(const t of e)t.group&&s.add(t.group);return[...s]}const L=["#d6b8c1","#d1c965","#cdb8d1","#aed4d7","#b3a9a5","#a9c6aa","#d39a8f","#b0a2cc","#d28fa9","#b2d29f","#d1b05e","#84c9cc","#d1be83","#92c2be","#a3b1b5","#bdc75d"],P={Reuniões:"#c4d7b9",Atendimentos:"#b4d0e3",Rodízios:"#e6b97f",Outros:"#c3bfe0"},E=y({});function O(e){if(P[e])return P[e];if(!E.value[e]){const t=Array.from(new Set(_.value.map(n=>n.group).filter(n=>n!==null))).indexOf(e);E.value[e]=L[t%L.length]}return E.value[e]}function X(e){return{backgroundColor:O(e)}}const I=y(0),V=y(0);function J(e){I.value=e.touches?e.touches[0].clientX:e.clientX}function j(e){V.value=e.changedTouches?e.changedTouches[0].clientX:e.clientX;const s=V.value-I.value;s>Q?k(-1):s<-Q&&k(1)}return(e,s)=>{const t=ie,n=ke;return r(),u("div",null,[A.value?(r(),ge(t,{key:0})):(r(),u("div",Me,[l("div",{class:"calendar-panel",onTouchstart:J,onTouchend:j,onMousedown:J,onMouseup:j},[l("div",we,[l("i",{class:"las la-chevron-left",onClick:s[0]||(s[0]=o=>k(-1))}),l("h2",Te,g(se.value),1),l("i",{class:"las la-chevron-right",onClick:s[1]||(s[1]=o=>k(1))})]),l("table",Se,[s[3]||(s[3]=l("thead",null,[l("tr",null,[l("th",null,"Dom"),l("th",null,"Seg"),l("th",null,"Ter"),l("th",null,"Qua"),l("th",null,"Qui"),l("th",null,"Sex"),l("th",null,"Sáb")])],-1)),l("tbody",null,[(r(!0),u(m,null,D(z.value,(o,h)=>(r(),u("tr",{key:h},[(r(!0),u(m,null,D(o,i=>(r(),u("td",{key:i.date,class:w(le(i)),onClick:p=>B(i)},[l("div",xe,[l("div",Ne,g(i.dayNumber),1),i.events.length?(r(),u("div",qe,[(r(!0),u(m,null,D(re(i.events),p=>(r(),u("span",{key:p,class:"event-indicator",style:q({backgroundColor:O(p)})},null,4))),128))])):H("",!0)])],10,Ee))),128))]))),128))])])],32),l("div",Ae,[l("div",Ue,[s[6]||(s[6]=l("small",{style:{opacity:"0.8"}},"Grupos:",-1)),l("div",Fe,[l("span",{class:"chip",onClick:te},[R.value?(r(),u("i",Re)):(r(),u("i",$e)),s[4]||(s[4]=N(" Todos os Grupos ",-1))]),(r(!0),u(m,null,D(W.value,o=>(r(),u("span",{key:o,class:w(["chip",{"chip-disabled":a.disabledGroups.includes(o)}]),style:q(X(o)),onClick:h=>ee(o)},[a.enabledGroups.includes(o)?(r(),u("i",ze)):(r(),u("i",Be)),N(" "+g(o),1)],14,Ye))),128))]),s[7]||(s[7]=l("small",{style:{opacity:"0.8"}},"Agenda(s):",-1)),l("div",Le,[(r(!0),u(m,null,D(Z.value,o=>(r(),u("span",{key:o,class:w(["chip",{"chip-disabled":a.disabledCalendars.includes(o)}]),onClick:h=>ae(o)},[a.enabledCalendars.includes(o)?(r(),u("i",Oe)):(r(),u("i",Xe)),N(" "+g(o),1)],10,Pe))),128))]),l("div",Ie,[be(l("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>a.search=o),type:"text",placeholder:"Buscar eventos...",class:"search-input"},null,512),[[ye,a.search]]),s[5]||(s[5]=l("i",{class:"las la-search search-icon"},null,-1))]),Object.keys($.value).length?(r(),u("div",Ve,[(r(!0),u(m,null,D($.value,([o,h])=>(r(),u("div",{key:o},[l("h4",Je,g(ne(o)),1),l("ul",je,[(r(!0),u(m,null,D(h,([i,p])=>(r(),u("li",{key:i,class:w({"selected-event":oe(p)}),style:q(X(p[0].group))},[l("strong",null,g(i),1),l("ul",He,[(r(!0),u(m,null,D(p,f=>(r(),u("li",{key:f.id},[me(n,{to:{path:"/evento",query:{id:f.id}}},{default:De(()=>[l("p",null,[l("b",null,[l("i",null,g(f.formatTime)+g(f.formatTime?" - ":"")+g(f.formatDate),1)])]),l("p",null,g(f.locale),1),f.desc?(r(),u("p",{key:0,innerHTML:_e(Ge)(f.desc)},null,8,Qe)):H("",!0)]),_:2},1032,["to"])]))),128))])],6))),128))])]))),128))])):(r(),u("p",Ke,"Nenhum evento agendado."))])])]))])}}},at=de(We,[["__scopeId","data-v-3646d576"]]);export{at as default};
