import{L as at}from"./F8eatfyJ.js";import{_ as nt,y as it,r as P,B as ot,E as j,f as h,c as n,D as rt,s as f,F as k,a as s,A as m,n as C,t as c,i as D,k as A,b as ct,e as Q,l as O,I as dt,m as ut,o as a,p as pt,Q as vt}from"./DOW2NTVq.js";import{F as ft}from"./CfqQoWJo.js";const bt={class:"tabs-container print-hide"},yt={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},mt=["aria-selected"],gt={class:"badge"},_t=["aria-selected"],ht={class:"badge"},kt=["aria-selected"],Ct={class:"tab-content"},Dt={id:"tab-content-lista",role:"tabpanel",class:"text-center"},At={key:0},jt={key:1},Ot={key:2},$t={key:3},St={id:"tab-content-filters",role:"tabpanel"},Tt={id:"tab-content-print",role:"tabpanel"},xt={style:{"margin-top":"10px"},class:"a4"},Bt={class:"settings-list"},Ft=["onDragstart","onDragover","onDrop"],Lt=["onClick"],wt=["onClick"],Vt={key:0,class:"print-page"},Mt={colspan:"5",class:"text-center",style:{"text-transform":"uppercase"}},zt={key:0,class:"nowrap"},It={key:0},Nt=["innerHTML"],Rt={__name:"calendar",setup(Et){const{lista:i}=it(),$=dt(),U=ut(),d=P("lista"),K=P(null),o=ot({}),S=e=>e==null?void 0:e.replace(/-$/,"").trim(),X=e=>{const l=new Date(e).toLocaleString("pt-BR",{month:"long"});return l.charAt(0).toUpperCase()+l.slice(1)},Y=()=>{const e=$.query;if(i.filters={...i.filters,...["search","title","locale","date","start","end"].reduce((t,l)=>(e[l]&&(t[l]=e[l]),t),{})},i.filters.calendars=e.calendars?Array.isArray(e.calendars)?e.calendars:e.calendars.split(","):[],e.visible&&Object.keys(o).length){const t=Array.isArray(e.visible)?e.visible:e.visible.split(",");for(const l of Object.keys(o))o[l]=t.includes(l)}},Z=()=>{const e=Object.entries(o).filter(([l,u])=>u).map(([l])=>l),t={...$.query};e.length?t.visible=e.join(","):delete t.visible,U.replace({query:t})};j(()=>JSON.stringify(o),()=>Z());const tt=h(()=>{const e=i.filters;return e?["search","title","locale","date","calendars"].filter(t=>e[t]&&(Array.isArray(e[t])?e[t].length:!0)).length:0}),et=h(()=>Object.values(o).filter(Boolean).length),st=()=>{d.value="lista",setTimeout(()=>{window.print(),d.value="print"},500)},T=h(()=>{const e={},t=i.eventsFiltered.filter(l=>!["AVISOS À IRMANDADE"].includes(l.title));for(const l of t||[]){const[u,b]=(l.date||"").split("-");if(!u||!b)continue;const v=`${u}-${b}-01 12:00:00`;(e[v]||(e[v]=[])).push(l)}return Object.entries(e).map(([l,u])=>({month:l,items:u.sort((b,v)=>{var y,_;return((y=b.date)==null?void 0:y.localeCompare(v.date))||((_=b.title)==null?void 0:_.localeCompare(v.title))})})).sort((l,u)=>l.month.localeCompare(u.month))}),x=e=>o[e]=!o[e],lt=h(()=>Object.values(o).every(Boolean)),B=e=>Object.keys(o).forEach(t=>o[t]=e),F=h(()=>{const e=new Map;for(const t of i.eventsFiltered||[]){const l=t.title||"Sem título";e.has(l)||e.set(l,[]),e.get(l).push(t)}return[...e.entries()].map(([t,l])=>({title:t,items:l.sort((u,b)=>{var v,y;return((v=u.date)==null?void 0:v.localeCompare(b.date))||((y=u.title)==null?void 0:y.localeCompare(b.title))})}))});return j(()=>i.eventsFiltered,()=>{for(const e of i.eventsFiltered||[]){const t=e.title||"Sem título";t in o||(o[t]=!0)}Y()},{immediate:!0}),j(F,e=>{e.forEach(({title:t})=>{t in o||(o[t]=!0)})},{immediate:!0}),(e,t)=>{var u,b,v,y,_,L,w,V,M,z,I,N,R,E,G,q,W,H,J;const l=at;return a(),n("div",null,[f(i).loading?(a(),rt(l,{key:0})):(a(),n(k,{key:1},[s("div",bt,[s("nav",yt,[s("span",{id:"tab-filters","aria-selected":d.value==="filters",role:"tab",type:"button",class:C(["tab",{active:d.value==="filters"}]),style:{position:"relative"},onClick:t[0]||(t[0]=p=>d.value="filters")},[s("span",gt,c(tt.value),1),t[5]||(t[5]=s("i",{class:"la la-filter z-10"},null,-1))],10,mt),s("span",{id:"tab-print","aria-selected":d.value==="print",role:"tab",type:"button",class:C(["tab",{active:d.value==="print"}]),onClick:t[1]||(t[1]=p=>d.value="print")},[s("span",ht,c(et.value),1),t[6]||(t[6]=s("i",{class:"la la-print"},null,-1))],10,_t),s("span",{id:"tab-lista","aria-selected":d.value==="lista",role:"tab",type:"button",class:C(["tab",{active:d.value==="lista"}]),onClick:t[2]||(t[2]=p=>d.value="lista")}," Calendário ",10,kt)])]),s("div",Ct,[D(s("div",Dt,[t[7]||(t[7]=s("div",null,"CALENDÁRIO",-1)),(b=(u=f(i).filters)==null?void 0:u.calendars)!=null&&b.length?(a(),n("div",At,[s("b",null,c(f(i).filters.calendars.map(S).join(", ")),1)])):m("",!0),(v=f(i).filters)!=null&&v.locale?(a(),n("div",jt,[s("b",null,c(S((y=f(i).filters)==null?void 0:y.locale)),1)])):m("",!0),(_=f(i).filters)!=null&&_.date?(a(),n("div",Ot," Data: "+c((M=(V=(w=(L=f(i).filters.date)==null?void 0:L.split("T")[0])==null?void 0:w.split("-"))==null?void 0:V.reverse())==null?void 0:M.join("/")),1)):m("",!0),s("div",null,c((E=(R=(N=(I=(z=f(i).filters)==null?void 0:z.start)==null?void 0:I.split("T")[0])==null?void 0:N.split("-"))==null?void 0:R.reverse())==null?void 0:E.join("/"))+" à "+c((J=(H=(W=(q=(G=f(i).filters)==null?void 0:G.end)==null?void 0:q.split("T")[0])==null?void 0:W.split("-"))==null?void 0:H.reverse())==null?void 0:J.join("/")),1),f(i).filters.search?(a(),n("div",$t,c(f(i).filters.search),1)):m("",!0)],512),[[A,d.value==="lista"]]),D(s("div",St,[ct(ft)],512),[[A,d.value==="filters"]]),D(s("div",Tt,[s("div",{class:"text-center"},[t[9]||(t[9]=s("p",{class:"mb-4"},"Ajustes de impressão:",-1)),s("button",{class:"success",onClick:st},t[8]||(t[8]=[s("i",{class:"la la-print"},null,-1),Q(" Imprimir ")]))]),s("div",xt,[s("div",Bt,[t[10]||(t[10]=s("b",null,"Lista",-1)),s("div",null,[lt.value?(a(),n("i",{key:0,class:"la la-toggle-on",style:{cursor:"pointer","font-size":"18px",padding:"8px",color:"#22c55e"},title:"Ocultar todos",onClick:t[3]||(t[3]=p=>B(!1))})):(a(),n("i",{key:1,class:"la la-toggle-off",title:"Mostrar todos",style:{cursor:"pointer","font-size":"18px",padding:"8px",color:"#dc2626"},onClick:t[4]||(t[4]=p=>B(!0))}))])]),(a(!0),n(k,null,O(F.value,(p,g)=>(a(),n("div",{key:p.title,class:C(["settings-list",{"drag-over":K.value===g}]),draggable:"true",onDragstart:r=>e.onDragStart(g),onDragover:pt(r=>e.onDragOver(g),["prevent"]),onDrop:r=>e.onDrop(g)},[Q(c(p.title)+" ",1),o[p.title]?(a(),n("i",{key:1,class:"la la-toggle-on",style:{cursor:"pointer","font-size":"14px",padding:"8px",color:"#22c55e"},onClick:r=>x(p.title)},null,8,wt)):(a(),n("i",{key:0,class:"la la-toggle-off",onClick:r=>x(p.title)},null,8,Lt))],42,Ft))),128))])],512),[[A,d.value==="print"]])]),T.value.length?(a(),n("div",Vt,[(a(!0),n(k,null,O(T.value,({month:p,items:g})=>(a(),n("div",{key:p,class:"month-section"},[s("table",null,[s("thead",null,[s("tr",null,[s("th",Mt,c(X(p)),1)])]),s("tbody",null,[(a(!0),n(k,null,O(g,r=>D((a(),n("tr",{key:r.id},[s("td",null,[r.formatDate?(a(),n("span",zt,c(r.formatDate.split("/")[0])+" | "+c(r.formatWeek),1)):m("",!0)]),s("td",null,[r.formatTime?(a(),n("span",It,c(r.formatTime),1)):m("",!0)]),s("td",null,c(r.locale),1),s("td",null,c(r.title),1),s("td",null,[r.desc?(a(),n("span",{key:0,innerHTML:f(vt)(r.desc)},null,8,Nt)):m("",!0)])])),[[A,o[r.title||"Sem título"]]])),128))])])]))),128))])):m("",!0)],64))])}}},Ht=nt(Rt,[["__scopeId","data-v-7645089b"]]);export{Ht as default};
