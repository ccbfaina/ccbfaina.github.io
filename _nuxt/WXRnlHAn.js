import{L as lt}from"./DxGekH0p.js";import{_ as nt,r as g,y as M,u as at,j as b,z as F,o as ot,c as i,A as it,F as y,a as e,s as p,q as _,t as r,k as m,v as A,B as S,n as k,H as G,f as x,i as rt,Q as V,X as ut,p as dt,C as ct,b as o,D as pt,m as vt,E as ft}from"#entry";import{d as bt}from"./D0Dr7phT.js";const mt={class:"tabs-container print-hide"},yt={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},gt=["aria-selected"],_t={class:"badge"},kt=["aria-selected"],ht={class:"badge"},wt=["aria-selected"],At={class:"tab-content"},St={id:"tab-content-lista",role:"tabpanel"},Ct={class:"text-center"},Dt={key:0},Lt={key:1},Tt={key:2},xt={key:3},Vt={key:4},$t={id:"tab-content-filters",role:"tabpanel"},Ot={class:"content"},Et={class:"form-inline"},jt={class:"form-group"},Bt={class:"row"},qt={class:"form-group"},zt={class:"row"},Rt=["value"],It={class:"form-group"},Mt={class:"row"},Ft=["value"],Gt={class:"form-group"},Nt={class:"row gap-xs"},Ut={class:"form-group",style:{"text-align":"right"}},Pt=["disabled"],Ht={class:"form-inline",style:{gap:"1rem","margin-top":"1rem"}},Qt={id:"tab-content-print",role:"tabpanel"},Wt={class:"a4 print-hide"},Xt={class:"settings-list"},Yt={class:"settings-list"},Jt=["onClick"],Kt={key:0,class:"print-page print-layout"},Zt={class:"table-wrapper"},te={colspan:"5",class:"text-center",style:{"text-transform":"uppercase"}},ee=["onDblclick"],se={key:0,class:"nowrap"},le={key:0},ne=["innerHTML"],ae={__name:"calendar",setup(oe){ut(s=>({v14240138:h.value}));const N=rt(),U=dt(),d=g("lista"),C=g(!1),h=g(1),l=M({search:"",title:"",locale:"",date:"",start:"",end:"",calendars:[]}),{$indexedDB:P}=at(),D=g([]),c=M({}),$=g([]),H=b(()=>({fontSize:`${h.value}rem`})),O=s=>s?.replace(/-$/,"").trim(),L=s=>{if(!s)return"";const t=s.split("T")[0];return t?t.split("-").reverse().join("/"):""},T=(s,t)=>Array.from(new Set(s.map(a=>a[t]).filter(a=>typeof a=="string"&&a.trim()))),Q=b(()=>T(f.value,"title")),W=b(()=>T(f.value,"locale"));b(()=>T(D.value,"list"));const X=()=>{const s=N.query||{};["search","title","locale","date","start","end"].forEach(v=>{s[v]!==void 0&&(l[v]=s[v])}),s.calendars&&(l.calendars=Array.isArray(s.calendars)?s.calendars:s.calendars.split(",").filter(Boolean));const{today:a,future:n}=V();l.start||(l.start=a),l.end||(l.end=n)},E=bt(()=>{const s=Object.fromEntries(Object.entries(l).filter(([t,a])=>t==="calendars"?a.length:a!==""&&a!=null).map(([t,a])=>Array.isArray(a)?[t,a.join(",")]:[t,a]));U.replace({query:s})},200),Y=()=>{E()};F(l,E,{deep:!0});function w(s){if(s==="calendars")l.calendars=[];else if(s==="date"){l.date="";const{today:t,future:a}=V();l.start=t,l.end=a}else if(s==="start"||s==="end"){const{today:t,future:a}=V();l.start=t,l.end=a}else l[s]=""}const f=b(()=>{const s=ct(D.value||[],l);return Array.from(new Set(s.map(a=>a.id))).map(a=>s.find(n=>n.id===a))}),J=b(()=>{let s=0;return l.search&&s++,l.title&&s++,l.locale&&s++,l.date&&s++,l.calendars&&l.calendars.length>0&&s++,s}),K=()=>{d.value="lista",setTimeout(()=>{window.print()},1e3)},j=b(()=>{if(!f.value||!f.value.length)return[];const s=f.value.filter(a=>!["AVISOS À IRMANDADE","NOVOS SERVOS PARA O MINISTÉRIO"].includes(a.title)),t=new Map;for(const a of s||[]){if(!a.date)continue;const n=new Date(a.date),v=`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`,u=n.toLocaleDateString("pt-BR",{month:"long",year:"numeric"});t.has(v)||t.set(v,{month:u,items:[]}),t.get(v).items.push(a)}return Array.from(t.entries()).sort(([a],[n])=>a.localeCompare(n)).map(([a,{month:n,items:v}])=>({month:n,items:v.slice().sort((u,I)=>u.onDate-I.onDate)}))}),B=b(()=>{const s={};return f.value.forEach(t=>{const a=t.title||"Sem título";(s[a]||=[]).push(t)}),Object.keys(s).map(t=>({title:t}))}),q=()=>{const s=Array.from(new Set(f.value.map(t=>t.title||"Sem título")));$.value=s},z=()=>{if(!B.value)return;const s=B.value.map(t=>t.title);s.forEach(t=>{t in c||(c[t]=!0)});for(const t in c)s.includes(t)||(c[t]=!1)};ot(async()=>{X();const{events:s}=await P.getEvents(l);D.value=s,q(),z()}),F(f,()=>{q(),z()});const Z=s=>{d.value="print",c[s]=!c[s]},R=b(()=>Object.values(c).length>0&&Object.values(c).every(Boolean)),tt=s=>{for(const t in c)c[t]=s},et=b(()=>Object.values(c).filter(Boolean).length),st=s=>{const t=`https://www.google.com/calendar/event?eid=${s.htmlLink}`;window.open(t,"_blank")};return(s,t)=>{const a=lt;return o(),i("div",null,[C.value?(o(),it(a,{key:0})):(o(),i(y,{key:1},[e("div",mt,[e("nav",yt,[e("span",{id:"tab-filters","aria-selected":d.value==="filters",role:"tab",type:"button",class:_(["tab",{active:d.value==="filters"}]),style:{position:"relative"},onClick:t[0]||(t[0]=n=>d.value="filters")},[e("span",_t,r(J.value),1),t[15]||(t[15]=e("i",{class:"la la-filter z-10"},null,-1))],10,gt),e("span",{id:"tab-print","aria-selected":d.value==="print",role:"tab",type:"button",class:_(["tab",{active:d.value==="print"}]),onClick:t[1]||(t[1]=n=>d.value="print")},[e("span",ht,r(et.value),1),t[16]||(t[16]=e("i",{class:"la la-print"},null,-1))],10,kt),e("span",{id:"tab-lista","aria-selected":d.value==="lista",role:"tab",type:"button",class:_(["tab",{active:d.value==="lista"}]),onClick:t[2]||(t[2]=n=>d.value="lista")}," Calendário ",10,wt)])]),e("div",At,[m(e("div",St,[e("div",Ct,[t[17]||(t[17]=e("div",null,"CALENDÁRIO",-1)),l.calendars.length?(o(),i("div",Dt,[e("b",null,r(l.calendars.map(O).join(", ")),1)])):p("",!0),l.locale?(o(),i("span",Lt,[e("b",null,r(O(l.locale)),1)])):p("",!0),l.date?(o(),i("span",Tt," Data: "+r(L(l.date)),1)):p("",!0),!l.date&&(l.start||l.end)?(o(),i("div",xt," Período: "+r(L(l.start))+" à "+r(L(l.end)),1)):p("",!0),l.search?(o(),i("div",Vt,r(l.search),1)):p("",!0)])],512),[[A,d.value==="lista"]]),m(e("div",$t,[e("div",Ot,[e("div",Et,[e("div",null,[e("div",jt,[t[18]||(t[18]=e("label",{for:"search"},"Pesquisar",-1)),e("div",Bt,[m(e("input",{id:"search","onUpdate:modelValue":t[3]||(t[3]=n=>l.search=n),type:"text",placeholder:"Buscar itens..."},null,512),[[S,l.search]]),l.search?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar pesquisa",type:"button",onClick:t[4]||(t[4]=n=>w("search"))}," × ")):p("",!0)])]),e("div",qt,[t[20]||(t[20]=e("label",{for:"title"},"Título",-1)),e("div",zt,[m(e("select",{id:"title","onUpdate:modelValue":t[5]||(t[5]=n=>l.title=n)},[t[19]||(t[19]=e("option",{value:""},"Todos os títulos",-1)),(o(!0),i(y,null,k(Q.value,n=>(o(),i("option",{key:n,value:n},r(n),9,Rt))),128))],512),[[G,l.title]]),l.title?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar título",type:"button",onClick:t[6]||(t[6]=n=>w("title"))}," × ")):p("",!0)])]),e("div",It,[t[22]||(t[22]=e("label",{for:"locale"},"Local",-1)),e("div",Mt,[m(e("select",{id:"locale","onUpdate:modelValue":t[7]||(t[7]=n=>l.locale=n)},[t[21]||(t[21]=e("option",{value:""},"Todos os locais",-1)),(o(!0),i(y,null,k(W.value,n=>(o(),i("option",{key:n,value:n},r(n),9,Ft))),128))],512),[[G,l.locale]]),l.locale?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar local",type:"button",onClick:t[8]||(t[8]=n=>w("locale"))}," × ")):p("",!0)])]),e("div",Gt,[t[23]||(t[23]=e("label",null,"Entre",-1)),e("div",Nt,[m(e("input",{"onUpdate:modelValue":t[9]||(t[9]=n=>l.start=n),type:"date"},null,512),[[S,l.start]]),m(e("input",{"onUpdate:modelValue":t[10]||(t[10]=n=>l.end=n),type:"date"},null,512),[[S,l.end]]),l.start||l.end?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar datas",type:"button",onClick:t[11]||(t[11]=n=>w("date"))}," × ")):p("",!0)])])]),e("div",null,[e("div",Ut,[t[24]||(t[24]=e("label",null,null,-1)),e("button",{class:"success",disabled:C.value,onClick:t[12]||(t[12]=n=>Y())},r(C.value?"Atualizando...":"Aplicar"),9,Pt)])])]),e("div",Ht,[e("span",null,[t[25]||(t[25]=e("i",{class:"la la-tasks"},null,-1)),x(" "+r(Array.isArray(f.value)?f.value.length:0),1)])])])],512),[[A,d.value==="filters"]]),m(e("div",Qt,[e("div",{class:"text-center flex col items-center gap-4"},[t[27]||(t[27]=e("b",{class:"mb-4 p"},"Ajustes de impressão:",-1)),e("div",{class:"p"},[e("button",{class:"success",onClick:K},[...t[26]||(t[26]=[e("i",{class:"la la-print"},null,-1),x(" Imprimir ",-1)])])])]),e("div",Wt,[e("div",Xt,[t[28]||(t[28]=e("b",null,"Tamanho da Fonte",-1)),m(e("input",{type:"range","onUpdate:modelValue":t[13]||(t[13]=n=>h.value=n),min:"0.8",max:"1.6",step:"0.1"},null,512),[[S,h.value]])]),e("div",Yt,[t[29]||(t[29]=e("b",null,"Lista",-1)),e("div",null,[e("i",{class:_(["la",R.value?"la-toggle-on":"la-toggle-off"]),title:"Ocultar todos",onClick:t[14]||(t[14]=n=>tt(!R.value))},null,2)])]),(o(!0),i(y,null,k($.value,n=>(o(),i("div",{key:n,class:"settings-list print-hide",onClick:v=>Z(n)},[x(r(n)+" ",1),e("i",{class:_(["la",c[n]?"la-toggle-on":"la-toggle-off"]),title:"Alterar visibilidade"},null,2)],8,Jt))),128))])],512),[[A,d.value==="print"]])]),j.value.length?(o(),i("div",Kt,[(o(!0),i(y,null,k(j.value,({month:n,items:v})=>(o(),i("div",{key:n,class:"month-section"},[e("div",Zt,[e("table",{style:pt(H.value)},[e("thead",null,[e("tr",null,[e("th",te,r(n),1)])]),e("tbody",null,[(o(!0),i(y,null,k(v,u=>m((o(),i("tr",{key:u.id,onDblclick:I=>st(u)},[e("td",null,[u.formatDate?(o(),i("span",se,r(u.formatDate.split("/")[0])+" | "+r(u.formatWeek),1)):p("",!0)]),e("td",null,[u.formatTime?(o(),i("span",le,r(u.formatTime),1)):p("",!0)]),e("td",null,r(u.locale),1),e("td",null,r(u.title),1),e("td",null,[u.desc?(o(),i("span",{key:0,innerHTML:vt(ft)(u.desc)},null,8,ne)):p("",!0)])],40,ee)),[[A,c[u.title||"Sem título"]]])),128))])],4)])]))),128))])):p("",!0)],64))])}}},de=nt(ae,[["__scopeId","data-v-78be2c6d"]]);export{de as default};
