import{L as ue}from"./DwxQmGVX.js";import{_ as ie,u as de,r as C,y as ce,h as b,z as k,c as r,A as ve,a as n,t as p,F as g,k as m,e as A,i as he,B as fe,g as pe,C as be,o,n as M,p as V,D as N,l as ge,E as me}from"./DrK86HzD.js";const ye={key:1,class:"calendar-wrapper"},Ce={class:"calendar-header"},De={class:"month-year"},_e={class:"calendar-table"},Ge=["onClick"],ke={class:"day-content"},Me={class:"day-number"},Te={key:0,class:"event-indicators"},we={class:"events-panel"},Ee={class:"events-list-container"},Se={class:"chips-container"},Ae={key:0,class:"las la-toggle-on"},Ne={key:1,class:"las la-toggle-off"},xe=["onClick"],qe={key:0,class:"las la-toggle-on"},Ue={key:1,class:"las la-toggle-off"},Fe={class:"chips-container"},Ye=["onClick"],$e={key:0,class:"las la-toggle-on"},ze={key:1,class:"las la-toggle-off"},Pe={class:"search-container"},Be={key:0},Le={class:"event-date-title"},Oe={class:"events-list"},Re={class:"sub-events-list"},Xe=["innerHTML"],Ie={key:1,class:"no-events-message"},J=50,Ve={__name:"agenda",setup(Je){const{lista:y}=de(),D=pe(),x=C(!0),T=new Date,d=C(T.getMonth()),h=C(T.getFullYear()),v=C(null),l=ce({search:"",title:"",locale:"",date:"",start:"",end:"",enabledGroups:[],disabledGroups:[],enabledCalendars:[],disabledCalendars:[]});function q(){return[]}const _=b(()=>Array.from(new Set(y.allEvents.map(e=>e.group))).filter(e=>e).sort((e,a)=>e.localeCompare(a))),H=b(()=>Array.from(new Set(y.calendars.map(e=>e.calendar))).filter(e=>e).sort((e,a)=>e.localeCompare(a)));k(_,e=>{if(!(D.query.groups&&D.query.groups.length>0)&&l.enabledGroups.length===0&&l.disabledGroups.length===0){const a=q(),s=q();a.length>0||s.length>0?(l.enabledGroups=a.filter(t=>e.includes(t)),l.disabledGroups=s.filter(t=>e.includes(t))):(l.enabledGroups=e.filter(t=>t!=="Rodízios"),l.disabledGroups=e.filter(t=>t==="Rodízios"))}},{immediate:!0}),k(H,e=>{D.query.calendars&&D.query.calendars.length>0||l.enabledCalendars.length===0&&l.disabledCalendars.length===0&&(l.enabledCalendars=[...e],l.disabledCalendars=[])},{immediate:!0}),k([()=>l.enabledGroups,()=>l.disabledGroups],()=>{},{deep:!0});const Q=b(()=>{const e=[...l.enabledGroups,...l.disabledGroups];return Array.from(new Set(e)).sort((s,t)=>s.localeCompare(t))}),j=b(()=>{const e=[...l.enabledCalendars,...l.disabledCalendars];return Array.from(new Set(e)).sort((s,t)=>s.localeCompare(t))}),U=b(()=>l.enabledGroups.length===_.value.length);k(()=>y.allEvents,()=>{const e=D.query||{};if(["search","title","locale","date","start","end"].forEach(s=>{e[s]!==void 0&&(l[s]=e[s])}),e.groups){const s=Array.isArray(e.groups)?e.groups:e.groups.split(",").filter(Boolean);l.enabledGroups=s.filter(t=>_.value.includes(t)),l.disabledGroups=_.value.filter(t=>!s.includes(t))}if(e.calendars){const s=Array.isArray(e.calendars)?e.calendars:e.calendars.split(",").filter(Boolean);console.log("Calendários da URL:",s),l.enabledCalendars=s,l.disabledCalendars=[]}y.allEvents&&y.allEvents.length>0&&(x.value=!1)},{immediate:!0});function K(e){l.enabledGroups.includes(e)?(l.enabledGroups=l.enabledGroups.filter(s=>s!==e),l.disabledGroups.push(e)):(l.disabledGroups=l.disabledGroups.filter(s=>s!==e),l.enabledGroups.push(e)),l.enabledGroups.sort((s,t)=>s.localeCompare(t)),l.disabledGroups.sort((s,t)=>s.localeCompare(t))}function W(){U.value?(l.disabledGroups=[..._.value],l.enabledGroups=[]):(l.enabledGroups=[..._.value],l.disabledGroups=[])}function Z(e){l.enabledCalendars.includes(e)?(l.enabledCalendars=l.enabledCalendars.filter(s=>s!==e),l.disabledCalendars.push(e)):(l.disabledCalendars=l.disabledCalendars.filter(s=>s!==e),l.enabledCalendars.push(e)),l.enabledCalendars.sort((s,t)=>s.localeCompare(t)),l.disabledCalendars.sort((s,t)=>s.localeCompare(t))}const w=b(()=>{const e=l.search.trim();let a=be(y.allEvents||[],l);if(D.query.next==="true"){const t=new Date;a=a.filter(i=>new Date(i.date)>t)}return a=a.filter(t=>l.enabledGroups.includes(t.group)).filter(t=>l.enabledCalendars.includes(t.list)).filter(t=>!t.noDate),a}),F=b(()=>{let e;if(v.value){const s=v.value.date;e=w.value.filter(t=>{const i=new Date(t.date);return i.getUTCFullYear()===s.getFullYear()&&i.getUTCMonth()===s.getMonth()&&i.getUTCDate()===s.getDate()})}else e=w.value.filter(s=>{const t=new Date(s.date);return t.getUTCFullYear()===h.value&&t.getUTCMonth()===d.value});const a=new Map;for(const s of e){const i=new Date(s.date).toISOString().split("T")[0];a.has(i)||a.set(i,new Map);const c=a.get(i);c.has(s.title)||c.set(s.title,[]),c.get(s.title).push(s)}return Array.from(a.entries()).sort(([s],[t])=>new Date(s)-new Date(t))}),Y=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],ee=b(()=>`${Y[d.value]} ${h.value}`),te=b(()=>{const e=[],a=new Date(h.value,d.value,1).getDay(),s=new Date(h.value,d.value+1,0).getDate(),t=new Date(h.value,d.value,0).getDate();for(let u=a-1;u>=0;u--)e.push({dayNumber:t-u,date:new Date(h.value,d.value-1,t-u),isPrevMonth:!0,isNextMonth:!1,isToday:!1,hasEvent:!1,events:[]});for(let u=1;u<=s;u++){const f=new Date(h.value,d.value,u),I=w.value.filter(re=>{const S=new Date(re.date);return S.getUTCDate()===u&&S.getUTCMonth()===d.value&&S.getUTCFullYear()===h.value});e.push({dayNumber:u,date:f,isPrevMonth:!1,isNextMonth:!1,isToday:f.toDateString()===T.toDateString(),hasEvent:I.length>0,events:I})}const i=42-e.length;for(let u=1;u<=i;u++)e.push({dayNumber:u,date:new Date(h.value,d.value+1,u),isPrevMonth:!1,isNextMonth:!0,isToday:!1,hasEvent:!1,events:[]});const c=[];for(;e.length>0;)c.push(e.splice(0,7));return c});function se(e){const a=new Date(e),s=a.getUTCDate(),t=Y[a.getUTCMonth()],i=a.getUTCFullYear();return`${s} de ${t} de ${i}`}function G(e){d.value+=e,d.value<0?(d.value=11,h.value--):d.value>11&&(d.value=0,h.value++),v.value=null}function ae(e){return{"prev-month-day":e.isPrevMonth||e.isNextMonth,today:e.isToday,"has-event":e.hasEvent,"selected-day":v.value&&e.date&&v.value.date&&v.value.date.toDateString()===e.date.toDateString()}}function le(e){e.isPrevMonth?(G(-1),v.value={...e,date:new Date(h.value,d.value,e.dayNumber)}):e.isNextMonth?(G(1),v.value={...e,date:new Date(h.value,d.value,e.dayNumber)}):v.value&&v.value.date.toDateString()===e.date.toDateString()?v.value=null:v.value=e}function ne(e){return v.value?e.some(a=>{const s=new Date(a.date),t=v.value.date;return s.getUTCFullYear()===t.getFullYear()&&s.getUTCMonth()===t.getMonth()&&s.getUTCDate()===t.getDate()}):!1}function oe(e){const a=new Set;for(const s of e)s.group&&a.add(s.group);return[...a]}const $=["#d6b8c1","#d1c965","#cdb8d1","#aed4d7","#b3a9a5","#a9c6aa","#d39a8f","#b0a2cc","#d28fa9","#b2d29f","#d1b05e","#84c9cc","#d1be83","#92c2be","#a3b1b5","#bdc75d"],z={Reuniões:"#c4d7b9",Atendimentos:"#b4d0e3",Rodízios:"#e6b97f",Outros:"#c3bfe0"},E=C({});function P(e){if(z[e])return z[e];if(!E.value[e]){const s=Array.from(new Set(y.allEvents.map(t=>t.group).filter(t=>t!==null))).indexOf(e);E.value[e]=$[s%$.length]}return E.value[e]}function B(e){return{backgroundColor:P(e)}}const L=C(0),O=C(0);function R(e){L.value=e.touches?e.touches[0].clientX:e.clientX}function X(e){O.value=e.changedTouches?e.changedTouches[0].clientX:e.clientX;const a=O.value-L.value;a>J?G(-1):a<-J&&G(1)}return(e,a)=>{const s=ue;return o(),r("div",null,[x.value?(o(),ve(s,{key:0})):(o(),r("div",ye,[n("div",{class:"calendar-panel",onTouchstart:R,onTouchend:X,onMousedown:R,onMouseup:X},[n("div",Ce,[n("i",{class:"las la-chevron-left",onClick:a[0]||(a[0]=t=>G(-1))}),n("h2",De,p(ee.value),1),n("i",{class:"las la-chevron-right",onClick:a[1]||(a[1]=t=>G(1))})]),n("table",_e,[a[3]||(a[3]=n("thead",null,[n("tr",null,[n("th",null,"Dom"),n("th",null,"Seg"),n("th",null,"Ter"),n("th",null,"Qua"),n("th",null,"Qui"),n("th",null,"Sex"),n("th",null,"Sáb")])],-1)),n("tbody",null,[(o(!0),r(g,null,m(te.value,(t,i)=>(o(),r("tr",{key:i},[(o(!0),r(g,null,m(t,c=>(o(),r("td",{key:c.date,class:M(ae(c)),onClick:u=>le(c)},[n("div",ke,[n("div",Me,p(c.dayNumber),1),c.events.length?(o(),r("div",Te,[(o(!0),r(g,null,m(oe(c.events),u=>(o(),r("span",{key:u,class:"event-indicator",style:N({backgroundColor:P(u)})},null,4))),128))])):V("",!0)])],10,Ge))),128))]))),128))])])],32),n("div",we,[n("div",Ee,[a[6]||(a[6]=n("small",{style:{opacity:"0.8"}},"Grupos:",-1)),n("div",Se,[n("span",{class:"chip",onClick:W},[U.value?(o(),r("i",Ae)):(o(),r("i",Ne)),a[4]||(a[4]=A(" Todos os Grupos ",-1))]),(o(!0),r(g,null,m(Q.value,t=>(o(),r("span",{key:t,class:M(["chip",{"chip-disabled":l.disabledGroups.includes(t)}]),style:N(B(t)),onClick:i=>K(t)},[l.enabledGroups.includes(t)?(o(),r("i",qe)):(o(),r("i",Ue)),A(" "+p(t),1)],14,xe))),128))]),a[7]||(a[7]=n("small",{style:{opacity:"0.8"}},"Agenda(s):",-1)),n("div",Fe,[(o(!0),r(g,null,m(j.value,t=>(o(),r("span",{key:t,class:M(["chip",{"chip-disabled":l.disabledCalendars.includes(t)}]),onClick:i=>Z(t)},[l.enabledCalendars.includes(t)?(o(),r("i",$e)):(o(),r("i",ze)),A(" "+p(t),1)],10,Ye))),128))]),n("div",Pe,[he(n("input",{"onUpdate:modelValue":a[2]||(a[2]=t=>l.search=t),type:"text",placeholder:"Buscar eventos...",class:"search-input"},null,512),[[fe,l.search]]),a[5]||(a[5]=n("i",{class:"las la-search search-icon"},null,-1))]),Object.keys(F.value).length?(o(),r("div",Be,[(o(!0),r(g,null,m(F.value,([t,i])=>(o(),r("div",{key:t},[n("h4",Le,p(se(t)),1),n("ul",Oe,[(o(!0),r(g,null,m(i,([c,u])=>(o(),r("li",{key:c,class:M({"selected-event":ne(u)}),style:N(B(u[0].group))},[n("strong",null,p(c),1),n("ul",Re,[(o(!0),r(g,null,m(u,f=>(o(),r("li",{key:f.id},[n("p",null,[n("b",null,[n("i",null,p(f.formatTime)+p(f.formatTime?" - ":"")+p(f.formatDate),1)])]),n("p",null,p(f.locale),1),f.desc?(o(),r("p",{key:0,innerHTML:ge(me)(f.desc)},null,8,Xe)):V("",!0)]))),128))])],6))),128))])]))),128))])):(o(),r("p",Ie,"Nenhum evento agendado."))])])]))])}}},je=ie(Ve,[["__scopeId","data-v-daba6632"]]);export{je as default};
