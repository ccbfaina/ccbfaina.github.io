import{_ as W,r as C,f as ie,B as R,c as w,m as O,o as b,i as _,a as t,D as T,x as ne,y as B,z as ae,p as c,b as F,C as z,H as ce,w as pe,n as L,t as S,T as fe,I as le,g as de,l as me,J as ue,F as V,k as Y,K as ge,e as X,L as ee,h as q,M as ve,E as ye,N as be,j as H,O as J,v as K}from"./CyWUL_Tt.js";import{d as te}from"./BcZQbp_F.js";import{E as $e,a as he,S as we}from"./Uwn1OeAn.js";const De={key:0,class:"space-y-4 max-w-md mx-auto"},ke={__name:"git",setup(U,{expose:$}){const g=C(""),a=C(""),h=C(""),u=C(!1);ie(()=>{const l=localStorage.getItem("git_config");if(l)try{const s=JSON.parse(atob(l));g.value=s.token||"",a.value=s.repoOwner||"",h.value=s.repoName||""}catch(s){console.log("Erro::: ",s)}u.value=!0}),R([g,a,h],()=>{const l={token:g.value,repoOwner:a.value,repoName:h.value};localStorage.setItem("git_config",btoa(JSON.stringify(l)))},{deep:!0});const D=()=>({Authorization:`Bearer ${g.value}`,"Content-Type":"application/json; charset=UTF-8",Accept:"application/vnd.github.v3+json"}),k=async l=>{var f;const s=`https://api.github.com/repos/${a.value}/${h.value}/contents/${l}`,{data:e,error:d}=await ne(s,{method:"GET",headers:D(),pick:["content","sha"],watch:!1},"$9xe66jx9KU");if(d.value)throw new Error(`Erro ao buscar: ${((f=d.value.data)==null?void 0:f.message)||d.value.message}`);return{content:Buffer.from(e.value.content,"base64").toString("utf-8"),sha:e.value.sha}},I=async(l,s)=>{var o;console.log("Solicitacao de atualizacao:: ",l,s);const e=`https://api.github.com/repos/${a.value}/${h.value}/contents/${s}`,d=D();let n=null;try{const v=await k(s);if(v.content===l)return console.info("GIT: Conte√∫do id√™ntico."),!1;n=v.sha}catch(v){if(!v.message.includes("404"))throw v;console.log("GIT: Arquivo ser√° criado.")}const f={message:n?"Atualiza√ß√£o via Nuxt":"Cria√ß√£o via Nuxt",content:Buffer.from(l,"utf-8").toString("base64"),...n&&{sha:n}},{error:i}=await ne(e,{method:"PUT",headers:d,body:f,watch:!1},"$aH25C_JKj4");if(i.value)throw new Error(`Erro ao enviar: ${((o=i.value.data)==null?void 0:o.message)||i.value.message}`);return console.log("GIT: Enviado com sucesso!"),!0},A=async()=>{await I(`# Atualizado em ${new Date().toISOString()}`,"README.md")};return $({getFile:k,pushFile:I}),(l,s)=>u.value?(b(),w("div",De,[_(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>g.value=e),type:"password",placeholder:"Token",class:"input"},null,512),[[T,g.value]]),_(t("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>a.value=e),placeholder:"Owner",class:"input"},null,512),[[T,a.value]]),_(t("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>h.value=e),placeholder:"Repo",class:"input"},null,512),[[T,h.value]]),t("button",{class:"btn",onClick:A},"Sync")])):O("",!0)}},Ee=W(ke,[["__scopeId","data-v-adc87aea"]]),xe={class:"container"},_e={key:0},Ie={class:"dropdown-content"},Se={class:"dropdown-avatar-container"},Te={class:"countdown"},Oe={key:1},Q=!1,Ae={__name:"auth",setup(U){const{auth:$}=B(),{$toast:g}=ae(),a=C(!1),h=C(!1),u=C(!1);function D(){a.value=!a.value}function k(){a.value=!1}async function I(){const e=()=>g.success("Conectando"),d=n=>g.error("Erro ao conectar: "+n);try{await g.promise($.signIn({callback:e,errorCallback:d}),{pending:"Conectando...",success:"Janela de solicita√ß√£o aberta!",error:"Erro ao conectar."})}catch(n){console.error("Erro ao fazer login:",n),d(n)}}async function A(){try{const e=()=>{g.success("At√© logo!",{duration:2e3,position:"top-right"}),k()},d=n=>g.error("Erro ao desconectar: "+n);await $.signOut(e,d)}catch(e){g.error("Erro ao fazer logout: "+e)}}const l=e=>e>0?[e/3600,e%3600/60,e%60].map(d=>String(Math.floor(d)).padStart(2,"0")).join(":"):"00:00:00",s=ce({props:{src:{type:String,default:""},alt:{type:String,default:""},fallback:{type:String,default:""},hovered:Boolean,size:{type:Number,default:2.5},border:{type:String,default:"#d1d5db"}},setup(e){const d=C(!1);return()=>d.value?le("div",{class:"avatar-fallback",style:{width:`${e.size}rem`,height:`${e.size}rem`,borderRadius:"9999px",border:`2px solid ${e.border}`,display:"flex",alignItems:"center",justifyContent:"center",background:"#e5e7eb",color:"#111827",fontSize:e.size===4?"2rem":"1.25rem",fontWeight:600,transition:"border-color 0.2s"},class:{"avatar-hovered":e.hovered}},e.fallback):le("img",{src:e.src,alt:e.alt,class:"avatar",style:{width:`${e.size}rem`,height:`${e.size}rem`,borderRadius:"9999px",border:`2px solid ${e.border}`,transition:"border-color 0.2s"},class:{"avatar-hovered":e.hovered},onError:()=>d.value=!0})}});return(e,d)=>(b(),w("div",xe,[c($).user.token?(b(),w("div",_e,[t("div",{class:"avatar-container",onClick:D,onMouseover:d[0]||(d[0]=n=>h.value=!0),onMouseleave:d[1]||(d[1]=n=>h.value=!1)},[(b(),z(c(s),{key:c($).user.picture,src:c($).user.picture,alt:c($).user.name,fallback:c($).user.name.charAt(0).toUpperCase(),hovered:h.value,size:2.5},null,8,["src","alt","fallback","hovered"]))],32),F(fe,{name:"fade"},{default:pe(()=>[a.value?(b(),w("div",{key:0,class:L(["dropdown",{"dropdown-dark":Q}])},[t("div",Ie,[t("div",Se,[(b(),z(c(s),{key:c($).user.picture,src:c($).user.picture,alt:c($).user.name,fallback:c($).user.name.charAt(0).toUpperCase(),size:4,border:"#3b82f6"},null,8,["src","alt","fallback"]))]),t("div",{class:L(["user-name",{"user-name-dark":Q}])},S(c($).user.name),3),t("div",{class:L(["user-email",{"user-email-dark":Q}])},S(c($).user.email),3),t("button",{class:L(["signout-button",{"signout-button-hovered":u.value}]),onClick:A,onMouseover:d[2]||(d[2]=n=>u.value=!0),onMouseleave:d[3]||(d[3]=n=>u.value=!1)},[d[4]||(d[4]=t("span",null,"Sair",-1)),t("span",Te,S(l(c($).user.expires_countdown)),1)],34)])],2)):O("",!0)]),_:1}),a.value?(b(),w("div",{key:0,class:"overlay",onClick:k})):O("",!0)])):(b(),w("div",Oe,[t("button",{class:"gsi-material-button",type:"button",onClick:I},d[5]||(d[5]=[t("div",{class:"gsi-material-button-state"},null,-1),t("div",{class:"gsi-material-button-content-wrapper"},[t("div",{class:"gsi-material-button-icon"}),t("span",{class:"gsi-material-button-contents"},"Entrar com Google")],-1)]))]))]))}},Me=W(Ae,[["__scopeId","data-v-d834dc4c"]]),Ce={class:"form-inline"},Le={class:"form-group"},Ue={class:"row"},Fe={class:"form-group"},Re={class:"row"},Ne={class:"form-group"},ze={class:"row"},Ve=["value"],Ye={class:"form-group"},je={class:"flex gap-xs"},qe={class:"form-group"},Be={class:"flex gap-xs"},Ge={class:"form-group",style:{"align-items":"flex-start"}},He=["id","value"],Ke=["for"],We={class:"form-group",style:{"text-align":"right"}},Pe=["disabled"],Je={class:"form-inline",style:{gap:"1rem","margin-top":"1rem"}},Qe={__name:"filters-agenda",setup(U){const $=de(),g=me(),{agenda:a,auth:h}=B(),{$toast:u}=ae(),D=C(!1),k={formatISOToInput(i){if(!i)return"";const o=new Date(i);return i.length>10?o.toISOString().slice(0,16):o.toISOString().slice(0,10)},getDefaultDates(){const i=new Date,o=new Date;return o.setDate(i.getDate()+70),{today:this.formatISOToInput(i),future:this.formatISOToInput(o)}},getFriendlyErrorMessage(i){var v,x,E,m;const o=((x=(v=i==null?void 0:i.result)==null?void 0:v.error)==null?void 0:x.message)||(i==null?void 0:i.message)||(i==null?void 0:i.toString())||"";return o.includes("Request is missing required authentication credential")?"Sua sess√£o expirou. Por favor, fa√ßa login novamente para acessar os eventos.":`Erro (${((m=(E=i==null?void 0:i.result)==null?void 0:E.error)==null?void 0:m.code)||""}) ao carregar eventos: ${o}`},sleep(i){return new Promise(o=>setTimeout(o,i))}},{today:I,future:A}=k.getDefaultDates();(()=>{const i=$.query||{};if(i.calendar){const o=Array.isArray(i.calendar)?i.calendar:i.calendar.split(",").filter(Boolean);a.filters.calendarIDs=o}else a.filters.calendarIDs=[];a.filters.title=i.title||"",a.filters.locale=i.locale||"",a.filters.search=i.search||"",a.filters.date=i.date||"",a.filters.start=i.start||I,a.filters.end=i.end||A})();const s=te(()=>{const i=Object.fromEntries(Object.entries(a.filters).filter(([o,v])=>o==="calendarIDs"?Array.isArray(v)&&v.length>0:v!==""&&v!==null&&v!==void 0).map(([o,v])=>o==="calendarIDs"&&Array.isArray(v)?["calendar",v.join(",")]:[o,v]));g.replace({query:{...i}})},300);function e(i){a.filters[i]="",i==="date"&&(a.filters.start=k.formatISOToInput(I),a.filters.end=k.formatISOToInput(A)),i==="calendarIDs"&&(a.filters.calendarIDs=[]),s()}async function d(){var i,o,v,x,E,m;try{if(window&&!((o=(i=window==null?void 0:window.gapi)==null?void 0:i.client)!=null&&o.calendar)){u.error("Google Calendar API n√£o est√° dispon√≠vel. Fa√ßa login ou aguarde o carregamento.");return}await k.sleep(200),await u.promise(a.fetchGoogleCalendars(),{pending:"Carregando eventos...",success:"Eventos carregados com sucesso!",error:{render({data:M}){return k.getFriendlyErrorMessage(M)}}})}catch(M){u.error(k.getFriendlyErrorMessage(M)),console.error(`Erro (${(x=(v=M.result)==null?void 0:v.error)==null?void 0:x.code}) ao carregar eventos: ${(m=(E=M.result)==null?void 0:E.error)==null?void 0:m.message}`,M)}finally{D.value=!1}}async function n(){await a.fetchGoogleEvents()}const f=te(async()=>{try{D.value=!0,await a.awaitGapi(),await d(),await n()}catch{u.error("Google Calendar API n√£o foi carregada. Tente recarregar a p√°gina ou aguarde.")}finally{D.value=!1}},400);return R(()=>h.user.token,async i=>{i&&f()},{immediate:!0}),ie(()=>{f()}),R(()=>({...a.filters}),()=>{s()},{deep:!0}),(i,o)=>{var v,x,E;return b(),w("div",null,[F(Me,{style:{"margin-bottom":"8px"}}),t("div",Ce,[t("div",null,[t("div",Le,[o[11]||(o[11]=t("label",{for:"search",class:"text-sm font-medium text-gray-700 mb-1"},"Pesquisar",-1)),t("div",Ue,[_(t("input",{id:"search","onUpdate:modelValue":o[0]||(o[0]=m=>c(a).filters.search=m),type:"text",placeholder:"Buscar eventos..."},null,512),[[T,c(a).filters.search]]),c(a).filters.search?(b(),w("button",{key:0,"aria-label":"Limpar pesquisa",type:"button",onClick:o[1]||(o[1]=m=>e("search"))}," √ó ")):O("",!0)])]),t("div",Fe,[o[12]||(o[12]=t("label",{for:"title",class:"text-sm font-medium text-gray-700 mb-1"},"T√≠tulo",-1)),t("div",Re,[_(t("input",{id:"title","onUpdate:modelValue":o[2]||(o[2]=m=>c(a).filters.title=m),type:"text",placeholder:"Filtrar por t√≠tulo..."},null,512),[[T,c(a).filters.title]]),c(a).filters.title?(b(),w("button",{key:0,"aria-label":"Limpar t√≠tulo",type:"button",onClick:o[3]||(o[3]=m=>e("title"))}," √ó ")):O("",!0)])]),t("div",Ne,[o[14]||(o[14]=t("label",{for:"locale",class:"text-sm font-medium text-gray-700 mb-1"},"Local",-1)),t("div",ze,[_(t("select",{id:"locale","onUpdate:modelValue":o[4]||(o[4]=m=>c(a).filters.locale=m)},[o[13]||(o[13]=t("option",{value:""},"Todos os locais",-1)),(b(!0),w(V,null,Y(c(a).eventsLocales,m=>(b(),w("option",{key:m,value:m},S(m),9,Ve))),128))],512),[[ue,c(a).filters.locale]]),c(a).filters.locale?(b(),w("button",{key:0,"aria-label":"Limpar local",type:"button",onClick:o[5]||(o[5]=m=>e("locale"))}," √ó ")):O("",!0)])]),t("div",Ye,[o[15]||(o[15]=t("label",{for:"date",class:"text-sm font-medium text-gray-700 mb-1"},"Data",-1)),t("div",je,[_(t("input",{id:"date","onUpdate:modelValue":o[6]||(o[6]=m=>c(a).filters.date=m),type:"date"},null,512),[[T,c(a).filters.date]]),c(a).filters.date?(b(),w("button",{key:0,"aria-label":"Limpar data",type:"button",onClick:o[7]||(o[7]=m=>e("date"))}," √ó ")):O("",!0)])]),t("div",qe,[o[16]||(o[16]=t("label",null,"Intervalo de Datas",-1)),t("div",Be,[_(t("input",{id:"datepicker-range-start","onUpdate:modelValue":o[8]||(o[8]=m=>c(a).filters.start=m),type:"date"},null,512),[[T,c(a).filters.start]]),_(t("input",{id:"datepicker-range-end","onUpdate:modelValue":o[9]||(o[9]=m=>c(a).filters.end=m),type:"date"},null,512),[[T,c(a).filters.end]])])])]),t("div",null,[t("div",Ge,[o[17]||(o[17]=t("label",null,"Calend√°rios",-1)),t("div",null,[(b(!0),w(V,null,Y(c(a).calendars,m=>(b(),w("div",{key:m.id,style:{"margin-bottom":"2px"}},[_(t("input",{id:"calendar-"+m.id,"onUpdate:modelValue":o[10]||(o[10]=M=>c(a).filters.calendarIDs=M),type:"checkbox",value:m.id,style:{margin:"5px 5px 0 0"}},null,8,He),[[ge,c(a).filters.calendarIDs]]),t("label",{for:"calendar-"+m.id,style:{"margin-bottom":"0"}},S(m.summary),9,Ke)]))),128))])]),t("div",We,[o[18]||(o[18]=t("label",null,null,-1)),t("button",{class:"success",disabled:c(D)||c(a).loading,onClick:n},S(c(D)||c(a).loading?"Atualizando...":"Aplicar"),9,Pe)])])]),t("div",Je,[t("span",null,[o[19]||(o[19]=t("i",{class:"la la-calendar-check"},null,-1)),X(" "+S((x=(v=c(a))==null?void 0:v.calendars)==null?void 0:x.length),1)]),t("span",null,[o[20]||(o[20]=t("i",{class:"la la-tasks"},null,-1)),X(" "+S((E=c(a).eventsFiltered)==null?void 0:E.length),1)])])])}}},Ze={colspan:"8"},Xe=["onDblclick"],et={key:0,class:"la la-redo-alt print-hide",style:{color:"#9e9e9e"}},tt={class:"tooltip","data-tooltip":"Data fim"},at=["onUpdate:modelValue","onFocusout"],ot=["onFocusout"],rt=["onFocusout"],st={class:"print-hide"},nt=["onClick"],lt={__name:"edit",setup(U){const{agenda:$,lista:g}=B(),a=ee({}),h={formatISOToInput(l){if(!l)return"";const s=new Date(l),e=d=>d.toString().padStart(2,"0");return l.length>10?`${s.getFullYear()}-${e(s.getMonth()+1)}-${e(s.getDate())}T${e(s.getHours())}:${e(s.getMinutes())}`:`${s.getFullYear()}-${e(s.getMonth()+1)}-${e(s.getDate())}`}},u={grouped:q(()=>{const l=g.titles||[],s=($.eventsFiltered||[]).reduce((d,n)=>{var i,o,v,x;const f=n.summary||n.title||"";return d[f]||(d[f]=[]),d[f].push({...n,startEvent:h.formatISOToInput(((i=n.start)==null?void 0:i.dateTime)||((o=n.start)==null?void 0:o.date)),endEvent:h.formatISOToInput(((v=n.end)==null?void 0:v.dateTime)||((x=n.end)==null?void 0:x.date))}),d},{}),e={};return l.forEach(d=>{s[d]&&(e[d]=s[d])}),Object.keys(s).forEach(d=>{e[d]||(e[d]=s[d])}),e}),_debouncers:{},handleEdit(l,s,e){if(e!==(l[s]||"")){const d=`${l.id}_${s}`;a[l.id]=!0,this._debouncers[d]||(this._debouncers[d]=te((n,f,i)=>{const o={summary:f==="summary"?i:n.summary,location:f==="location"?i:n.location,description:f==="description"?i:n.description,start:n.start,end:n.end},v=n.calendarId;$.updateGoogleEvent(v,n.id,o).then(()=>{a[n.id]=!1}).catch(x=>{a[n.id]=!1,console.warn("Erro ao editar evento:",x)})},3e3)),this._debouncers[d](l,s,e)}},updateDate(l,s,e){var n,f;if(h.formatISOToInput(((n=l.start)==null?void 0:n.dateTime)||((f=l.start)==null?void 0:f.date))!==e){a[l.id]=!0;let i=l.start,o=l.end;const v=Intl.DateTimeFormat().resolvedOptions().timeZone;if(s==="startEvent"){const E=new Date(e),m=new Date(E.getTime()+2*60*60*1e3);m.setMinutes(0,0,0),i={...i,dateTime:E.toISOString(),timeZone:v},o={...o,dateTime:m.toISOString(),timeZone:v}}else if(s==="endEvent"){const E=new Date(e);o={...o,dateTime:E.toISOString(),timeZone:v}}const x={summary:l.summary,location:l.location,description:l.description,start:i,end:o};$.updateGoogleEvent(l.calendarId,l.id,x).then(E=>{a[l.id]=!1,console.log("Evento atualizado com sucesso:",E)}).catch(E=>{a[l.id]=!1,console.warn("Erro ao editar data do evento:",E)})}},openEventLink(l){l&&window.open(l,"_blank")},handleDelete(l){confirm("Tem certeza que deseja excluir este evento?")&&(a[l.id]=!0,$.deleteGoogleEvent(l.calendarId,l.id).then(()=>{a[l.id]=!1}).catch(s=>{a[l.id]=!1,console.warn("Erro ao excluir evento:",s)}))}},D=ee({});function k(){Object.values(u.grouped.value).flat().forEach(s=>{D[s.id]?D[s.id].getHTML()!==(s.description||"")&&D[s.id].commands.setContent(s.description||"",!1):D[s.id]=new he({content:`${s.description||""}`.trim().replace(/[\n\r]/g,`
<br />`),extensions:[we],editorProps:{attributes:{class:"focus:outline-none min-h-[60px] p-2"}},onUpdate:({editor:e})=>{console.log("Atualizando::: ",e.getHTML()),u.handleEdit(s,"description",e.getHTML())}})})}R(()=>u.grouped.value,()=>{ve(()=>{k()})},{immediate:!0,deep:!0});function I(l){const s=D[l.id];if(!s)return;const e=s.getHTML();u.handleEdit(l,"description",e)}const A=u.grouped;return(l,s)=>(b(),w("div",null,[(b(!0),w(V,null,Y(c(A),(e,d)=>(b(),w("div",{key:d,class:"table-container"},[t("table",null,[t("thead",null,[t("tr",null,[t("th",Ze,S(d||"(sem t√≠tulo)"),1)])]),t("tbody",null,[(b(!0),w(V,null,Y(e,n=>(b(),w("tr",{key:n.id,onDblclick:f=>u.openEventLink(n.htmlLink)},[t("td",null,[n.recurringEventId?(b(),w("i",et)):O("",!0)]),t("td",tt,[_(t("input",{"onUpdate:modelValue":f=>n.startEvent=f,type:"datetime-local",class:L([{updating:a[n.id]},"date-clean"]),onFocusout:f=>u.updateDate(n,"startEvent",f.target.value)},null,42,at),[[T,n.startEvent]])]),t("td",{contenteditable:"true",class:L([{updating:a[n.id]},"print-hide tooltip"]),"data-tooltip":"Grupo",onFocusout:f=>u.handleEdit(n,"summary",f.target.innerText.trim())},S(n.summary),43,ot),t("td",{contenteditable:"true",class:L(["tooltip",{updating:a[n.id]}]),"data-tooltip":"Local",onFocusout:f=>u.handleEdit(n,"location",f.target.innerText.trim())},S(n.location||""),43,rt),t("td",{class:L(["tooltip",{updating:a[n.id]}]),"data-tooltip":"Descri√ß√£o"},[F(c($e),{editor:D[n.id],onBlur:f=>I(n)},null,8,["editor","onBlur"])],2),t("td",st,[t("button",{title:"Excluir evento",class:"btn-clean",onClick:f=>u.handleDelete(n)}," üóëÔ∏è ",8,nt)])],40,Xe))),128))])])]))),128))]))}},it=W(lt,[["__scopeId","data-v-ffe01c44"]]),dt={class:"suggestion-container"},ut=["onClick"],ct={__name:"suggestion",props:{suggestions:{type:Array,required:!0}},emits:["select"],setup(U,{emit:$}){const g=$,a=u=>typeof u=="string"?u:JSON.stringify(u),h=u=>{g("select",u)};return(u,D)=>(b(),w("ul",dt,[(b(!0),w(V,null,Y(U.suggestions,k=>(b(),w("li",{key:a(k),class:"suggestion-item",onClick:I=>h(k)},S(k),9,ut))),128))]))}},Z=W(ct,[["__scopeId","data-v-b2c7e18e"]]),pt={class:"border shadow",style:{width:"100%"}},ft={key:0,style:{padding:"1rem",background:"#fff","border-radius":"0 0 0.5rem 0.5rem"}},mt=["value"],gt={style:{display:"block","margin-top":"0.25rem","font-size":"0.85em",color:"#6b7280"}},vt={__name:"recurrence",props:{rrule:{type:String,default:""},data:{type:Object,default:()=>({})},recurrence:{type:String,default:""}},emits:["update:rrule","update:recurrence"],setup(U,{emit:$}){const g=C(!1),a=U,h=$,u=C(a.rrule||""),D=C("");R(()=>a.rrule,l=>{u.value=l||""});const k=q(()=>{var s;if(!((s=a.data)!=null&&s.date))return null;const l=new Date(a.data.date);return isNaN(l.getTime())?null:l});function I(l){u.value=l.target.value,h("update:rrule",u.value),A()}function A(){var v;D.value="";const l=((v=u.value)==null?void 0:v.toUpperCase())||"",s=/^(\d+)([DSMA])$/.exec(l);if(!a.data||!k.value){D.value="Data inv√°lida.",h("update:recurrence","");return}if(!s){D.value="Express√£o de recorr√™ncia inv√°lida. Use [n√∫mero][D/S/M/A]",h("update:recurrence","");return}const e=+s[1],n={D:"DAILY",S:"WEEKLY",M:"MONTHLY",A:"YEARLY"}[s[2]];if(!n||e<=0){D.value="Tipo ou intervalo inv√°lido.",h("update:recurrence","");return}const f=k.value,o=["SU","MO","TU","WE","TH","FR","SA"][f.getDay()];if(n==="WEEKLY")h("update:recurrence",`RRULE:FREQ=${n};INTERVAL=${e};BYDAY=${o}`);else if(n==="MONTHLY"){let x=Math.floor((f.getDate()-1)/7)+1;const E=new Date(f);E.setDate(f.getDate()+7),E.getMonth()!==f.getMonth()&&(x=-1);const m=(x===-1?"-1":x)+o;h("update:recurrence",`RRULE:FREQ=${n};INTERVAL=${e};BYDAY=${m}`)}else if(n==="YEARLY"){const x=f.getMonth()+1,E=f.getDate();let m=Math.floor((E-1)/7)+1;const M=new Date(f);M.setDate(E+7),M.getMonth()!==f.getMonth()&&(m=-1);const G=(m===-1?"-1":m)+o;h("update:recurrence",`RRULE:FREQ=YEARLY;INTERVAL=${e};BYMONTH=${x};BYDAY=${G}`)}else h("update:recurrence",`RRULE:FREQ=${n};INTERVAL=${e}`)}return R(()=>{var l;return(l=a.data)==null?void 0:l.date},A,{immediate:!0}),(l,s)=>(b(),w("div",pt,[t("button",{type:"button",style:{display:"flex","align-items":"center",width:"100%",padding:"1rem","text-align":"left",color:"#374151",background:"none",border:"none",cursor:"pointer"},onClick:s[0]||(s[0]=e=>g.value=!g.value)},[s[1]||(s[1]=t("i",{class:"la la-tools"},null,-1)),s[2]||(s[2]=t("span",{style:{"margin-left":"0.5rem"}},"Outras op√ß√µes",-1)),t("i",{class:"la la-angle-double-down",style:ye([{"margin-left":"auto",transition:"transform 0.2s"},{transform:g.value?"rotate(180deg)":""}])},null,4)]),g.value?(b(),w("div",ft,[s[3]||(s[3]=t("label",{for:"rrule-input",style:{display:"block","font-size":"0.95em","font-weight":"500",color:"#374151","margin-bottom":"0.25rem"}},"Recorr√™ncia",-1)),t("input",{id:"rrule-input",value:u.value,type:"text",style:{width:"100%",border:"1px solid #d1d5db","border-radius":"0.375rem",padding:"0.5rem 0.75rem","font-size":"0.95em"},placeholder:"Ex: 2S para cada 2 semanas ou 1M para cada m√™s",autocomplete:"off",onInput:I},null,40,mt),t("small",gt,S(D.value)+" "+S(U.recurrence),1)])):O("",!0)]))}},yt={class:"form-group"},bt=["value"],$t={class:"form-group"},ht={class:"form-group"},wt={class:"form-group"},Dt={class:"row"},kt={class:"form-group"},Et={class:"row"},xt={class:"form-group",style:{flex:"1 1 100%"}},_t={class:"form-group",style:{flex:"1 1 100%"}},It={__name:"create",setup(U){var G,oe;const{$toast:$}=ae(),{lista:g,agenda:a}=B(),h=de(),u=y=>String(y).padStart(2,"0");function D(y){return(y||"").toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").trim()}function k(y,r,p=4){if(!r)return y.slice(0,p);const N=D(r);return y.filter(j=>r!==j).filter(j=>N.split(" ").every(P=>D(j).includes(P))).slice(0,p)}function I(y){if(!y)return"";const r=new Date(y);return`${r.getFullYear()}-${u(r.getMonth()+1)}-${u(r.getDate())}T${u(r.getHours())}:${u(r.getMinutes())}`}function A(){const y=new Date,r=new Date;r.setDate(y.getDate()+70);const p=new Date(y);return p.setHours(19,0,0,0),{today:I(p),future:I(r)}}const{today:l}=A(),s=l,e=ee({calendarId:"",date:"",end:"",title:"",locale:((G=h.query)==null?void 0:G.locale)||"",desc:"",recurrence:""});R(()=>e.date,y=>{if(!y)return;const r=new Date(y),p=r.getMinutes()===0?2:1.5;e.end=I(new Date(r.getTime()+p*36e5))}),e.date=((oe=h.query)==null?void 0:oe.date)||s,be(()=>{const y=a.calendars.filter(r=>a.filters.calendarIDs.includes(r.id));y.length===1&&(e.calendarId=y[0].id)});const d=g.titles,n=g.locales,f=g.desc,i=q(()=>k(d,e.title,3)),o=q(()=>k(n,e.locale,3)),v=q(()=>{if(!e.desc)return[];const y=e.desc.trim().split(/\s+/),r=y.slice(-2).join(" "),p=y.slice(-1).join(" "),N=new Set([...k(f,r),...k(f,p)]);return Array.from(N).slice(0,3)});function x(y,r){r&&(e[y]=r)}function E(y,r){r&&r.length>0&&(e[y]=r[0])}function m(){}async function M(){if(!e.calendarId||!a.calendars.some(y=>y.id===e.calendarId)){alert("Selecione um calend√°rio v√°lido.");return}if(e.date&&e.title&&e.locale){const y={...e};try{const r=new Date(y.date);if(isNaN(r.getTime())){alert("Data inv√°lida.");return}const p=new Date(y.end||r.getTime()+2*60*60*1e3);if(isNaN(r.getTime())){alert("Data inv√°lida.");return}if(p<r){alert("A data de t√©rmino n√£o pode ser anterior √† data de in√≠cio.");return}const N=Intl.DateTimeFormat().resolvedOptions().timeZone,j=r.toISOString(),P=p.toISOString(),re={summary:y.title,location:y.locale,description:y.desc,start:{dateTime:j,timeZone:N},end:{dateTime:P,timeZone:N}};y.recurrence&&(re.recurrence=[y.recurrence]);const se=await a.createGoogleEvent(y.calendarId,re);$.success(se.summary+" criado com sucesso: "+se.description),e.date=s,e.locale="",e.desc="",e.rrule="",e.recurring=""}catch(r){$.error("Erro ao criar evento: "+((r==null?void 0:r.message)||r)),console.log("Erro ao criar evento: ",r)}}else alert("Por favor, preencha todos os campos obrigat√≥rios.")}return(y,r)=>(b(),w("div",null,[t("form",{class:"form-inline",onSubmit:J(M,["prevent"])},[t("div",yt,[r[15]||(r[15]=t("label",{for:"calendar"},"Calend√°rio:",-1)),_(t("select",{id:"calendar","onUpdate:modelValue":r[0]||(r[0]=p=>e.calendarId=p),required:""},[(b(!0),w(V,null,Y(c(a).calendars.filter(p=>c(a).filters.calendarIDs.includes(p.id)),p=>(b(),w("option",{key:p.id,value:p.id},S(p.summary),9,bt))),128))],512),[[ue,e.calendarId]])]),t("div",$t,[r[16]||(r[16]=t("label",{for:"date"},"Data:",-1)),_(t("input",{id:"date","onUpdate:modelValue":r[1]||(r[1]=p=>e.date=p),type:"datetime-local",required:""},null,512),[[T,e.date]])]),t("div",ht,[r[17]||(r[17]=t("label",{for:"end"},"Fim:",-1)),_(t("input",{id:"end","onUpdate:modelValue":r[2]||(r[2]=p=>e.end=p),type:"datetime-local",required:""},null,512),[[T,e.end]])]),t("div",wt,[r[18]||(r[18]=t("label",{for:"title"},"T√≠tulo:",-1)),t("div",Dt,[_(t("input",{id:"title","onUpdate:modelValue":r[3]||(r[3]=p=>e.title=p),type:"text",placeholder:"Digite para buscar...",autocomplete:"off",onKeydown:[r[4]||(r[4]=H(J(p=>E("title",i.value),["prevent"]),["enter"])),r[5]||(r[5]=H(p=>void 0,["tab"]))]},null,544),[[T,e.title]]),e.title.length>0&&i.value.length?(b(),z(Z,{key:0,suggestions:i.value,onSelect:r[6]||(r[6]=p=>x("title",p))},null,8,["suggestions"])):O("",!0)])]),t("div",kt,[r[19]||(r[19]=t("label",{for:"locale"},"Local:",-1)),t("div",Et,[_(t("input",{id:"locale","onUpdate:modelValue":r[7]||(r[7]=p=>e.locale=p),type:"text",placeholder:"Digite para buscar...",autocomplete:"off",onKeydown:[r[8]||(r[8]=H(J(p=>E("locale",o.value),["prevent"]),["enter"])),r[9]||(r[9]=H(p=>void 0,["tab"]))]},null,544),[[T,e.locale]]),e.locale.length>0&&o.value.length?(b(),z(Z,{key:0,suggestions:o.value,onSelect:r[10]||(r[10]=p=>x("locale",p))},null,8,["suggestions"])):O("",!0)])]),t("div",xt,[r[20]||(r[20]=t("label",{for:"desc",style:{display:"flex","align-items":"center",gap:"0.5rem"}},[t("span",{class:"tooltip","data-tooltip":"!nodate para n√£o mostrar a data e hora. "},[X(" Descri√ß√£o: "),t("i",{class:"la la-info-circle",style:{color:"#2563eb",cursor:"pointer"}})])],-1)),_(t("textarea",{id:"desc","onUpdate:modelValue":r[11]||(r[11]=p=>e.desc=p),rows:"4"},null,512),[[T,e.desc]]),e.desc.length>0&&v.value.length?(b(),z(Z,{key:0,suggestions:v.value,onSelect:r[12]||(r[12]=p=>x("desc",p))},null,8,["suggestions"])):O("",!0)]),t("div",_t,[r[21]||(r[21]=t("label",null,null,-1)),F(vt,{rrule:e.rrule,"onUpdate:rrule":r[13]||(r[13]=p=>e.rrule=p),recurrence:e.recurrence,"onUpdate:recurrence":r[14]||(r[14]=p=>e.recurrence=p),msg:c(g).msg,data:e},null,8,["rrule","recurrence","msg","data"])]),r[22]||(r[22]=t("div",{class:"form-group",style:{flex:"1 1 100%","text-align":"right"}},[t("label"),t("button",{type:"submit",class:"success",style:{width:"100%","max-width":"200px"}}," Adicionar ")],-1))],32)]))}},St={class:"print-hide"},Tt={class:"tabs-container print-hide"},Ot={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},At=["aria-selected"],Mt=["aria-selected"],Ct=["aria-selected"],Lt={class:"tab-content"},Ut={id:"tab-content-filters",role:"tabpanel"},Ft={key:0,id:"tab-content-create",role:"tabpanel"},Rt={id:"tab-content-git",role:"tabpanel"},Yt={__name:"eventos",setup(U){const{auth:$}=B(),g=C("filters");function a(h){g.value=h}return(h,u)=>{const D=Ee;return b(),w("div",null,[t("div",St,[t("div",Tt,[t("nav",Ot,[_(t("span",{id:"tab-create","aria-selected":g.value==="git",role:"tab",type:"button",class:L(["tab",{active:g.value==="git"}]),onClick:u[0]||(u[0]=k=>a("git"))},u[3]||(u[3]=[t("i",{class:"la la-git"},null,-1)]),10,At),[[K,c($).user.token]]),_(t("span",{id:"tab-create","aria-selected":g.value==="create",role:"tab",type:"button",class:L(["tab",{active:g.value==="create"}]),onClick:u[1]||(u[1]=k=>a("create"))},u[4]||(u[4]=[t("i",{class:"la la-plus"},null,-1)]),10,Mt),[[K,c($).user.token]]),t("span",{id:"tab-filters","aria-selected":g.value==="filters",role:"tab",type:"button",class:L(["tab",{active:g.value==="filters"}]),onClick:u[2]||(u[2]=k=>a("filters"))},u[5]||(u[5]=[t("i",{class:"la la-filter icon"},null,-1)]),10,Ct)])]),t("div",Lt,[_(t("div",Ut,[F(Qe)],512),[[K,g.value==="filters"]]),g.value==="create"?(b(),w("div",Ft,[F(It)])):O("",!0),_(t("div",Rt,[F(D)],512),[[K,g.value==="git"]])])]),c($).user.token?(b(),z(it,{key:0})):O("",!0)])}}};export{Yt as default};
