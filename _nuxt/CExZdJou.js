import{_ as G,r as A,f as ne,z as U,c as h,p as S,o as y,i as k,a as t,B as I,s as oe,u as j,x as te,l as p,b as L,A as R,G as de,w as ue,n as M,t as _,T as ce,H as se,g as le,m as pe,I as ie,F as z,k as N,J as fe,e as Z,y as X,h as Y,K as me,D as ge,L as ve,j as q,M as P,v as B}from"./CoNwJIvt.js";import{d as ee}from"./BcZQbp_F.js";import{E as ye,a as be,S as $e}from"./B2_r5nk8.js";const he={key:0,class:"space-y-4 max-w-md mx-auto"},we={__name:"git",setup(O,{expose:b}){const g=A(""),a=A(""),$=A(""),c=A(!1);ne(()=>{const l=localStorage.getItem("git_config");if(l)try{const s=JSON.parse(atob(l));g.value=s.token||"",a.value=s.repoOwner||"",$.value=s.repoName||""}catch(s){console.log("Erro::: ",s)}c.value=!0}),U([g,a,$],()=>{const l={token:g.value,repoOwner:a.value,repoName:$.value};localStorage.setItem("git_config",btoa(JSON.stringify(l)))},{deep:!0});const w=()=>({Authorization:`Bearer ${g.value}`,"Content-Type":"application/json; charset=UTF-8",Accept:"application/vnd.github.v3+json"}),D=async l=>{const s=`https://api.github.com/repos/${a.value}/${$.value}/contents/${l}`,{data:e,error:d}=await oe(s,{method:"GET",headers:w(),pick:["content","sha"],watch:!1},"$9xe66jx9KU");if(d.value)throw new Error(`Erro ao buscar: ${d.value.data?.message||d.value.message}`);return{content:Buffer.from(e.value.content,"base64").toString("utf-8"),sha:e.value.sha}},E=async(l,s)=>{console.log("Solicitacao de atualizacao:: ",l,s);const e=`https://api.github.com/repos/${a.value}/${$.value}/contents/${s}`,d=w();let n=null;try{const o=await D(s);if(o.content===l)return console.info("GIT: Conte√∫do id√™ntico."),!1;n=o.sha}catch(o){if(!o.message.includes("404"))throw o;console.log("GIT: Arquivo ser√° criado.")}const m={message:n?"Atualiza√ß√£o via Nuxt":"Cria√ß√£o via Nuxt",content:Buffer.from(l,"utf-8").toString("base64"),...n&&{sha:n}},{error:i}=await oe(e,{method:"PUT",headers:d,body:m,watch:!1},"$aH25C_JKj4");if(i.value)throw new Error(`Erro ao enviar: ${i.value.data?.message||i.value.message}`);return console.log("GIT: Enviado com sucesso!"),!0},T=async()=>{await E(`# Atualizado em ${new Date().toISOString()}`,"README.md")};return b({getFile:D,pushFile:E}),(l,s)=>c.value?(y(),h("div",he,[k(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>g.value=e),type:"password",placeholder:"Token",class:"input"},null,512),[[I,g.value]]),k(t("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>a.value=e),placeholder:"Owner",class:"input"},null,512),[[I,a.value]]),k(t("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>$.value=e),placeholder:"Repo",class:"input"},null,512),[[I,$.value]]),t("button",{class:"btn",onClick:T},"Sync")])):S("",!0)}},De=G(we,[["__scopeId","data-v-adc87aea"]]),ke={class:"container"},Ee={key:0},xe={class:"dropdown-content"},_e={class:"dropdown-avatar-container"},Ie={class:"countdown"},Se={key:1},J=!1,Te={__name:"auth",setup(O){const{auth:b}=j(),{$toast:g}=te(),a=A(!1),$=A(!1),c=A(!1);function w(){a.value=!a.value}function D(){a.value=!1}async function E(){const e=()=>g.success("Conectando"),d=n=>g.error("Erro ao conectar: "+n);try{await g.promise(b.signIn({callback:e,errorCallback:d}),{pending:"Conectando...",success:"Janela de solicita√ß√£o aberta!",error:"Erro ao conectar."})}catch(n){console.error("Erro ao fazer login:",n),d(n)}}async function T(){try{const e=()=>{g.success("At√© logo!",{duration:2e3,position:"top-right"}),D()},d=n=>g.error("Erro ao desconectar: "+n);await b.signOut(e,d)}catch(e){g.error("Erro ao fazer logout: "+e)}}const l=e=>e>0?[e/3600,e%3600/60,e%60].map(d=>String(Math.floor(d)).padStart(2,"0")).join(":"):"00:00:00",s=de({props:{src:{type:String,default:""},alt:{type:String,default:""},fallback:{type:String,default:""},hovered:Boolean,size:{type:Number,default:2.5},border:{type:String,default:"#d1d5db"}},setup(e){const d=A(!1);return()=>d.value?se("div",{class:"avatar-fallback",style:{width:`${e.size}rem`,height:`${e.size}rem`,borderRadius:"9999px",border:`2px solid ${e.border}`,display:"flex",alignItems:"center",justifyContent:"center",background:"#e5e7eb",color:"#111827",fontSize:e.size===4?"2rem":"1.25rem",fontWeight:600,transition:"border-color 0.2s"},class:{"avatar-hovered":e.hovered}},e.fallback):se("img",{src:e.src,alt:e.alt,class:"avatar",style:{width:`${e.size}rem`,height:`${e.size}rem`,borderRadius:"9999px",border:`2px solid ${e.border}`,transition:"border-color 0.2s"},class:{"avatar-hovered":e.hovered},onError:()=>d.value=!0})}});return(e,d)=>(y(),h("div",ke,[p(b).user.token?(y(),h("div",Ee,[t("div",{class:"avatar-container",onClick:w,onMouseover:d[0]||(d[0]=n=>$.value=!0),onMouseleave:d[1]||(d[1]=n=>$.value=!1)},[(y(),R(p(s),{key:p(b).user.picture,src:p(b).user.picture,alt:p(b).user.name,fallback:p(b).user.name.charAt(0).toUpperCase(),hovered:$.value,size:2.5},null,8,["src","alt","fallback","hovered"]))],32),L(ce,{name:"fade"},{default:ue(()=>[a.value?(y(),h("div",{key:0,class:M(["dropdown",{"dropdown-dark":J}])},[t("div",xe,[t("div",_e,[(y(),R(p(s),{key:p(b).user.picture,src:p(b).user.picture,alt:p(b).user.name,fallback:p(b).user.name.charAt(0).toUpperCase(),size:4,border:"#3b82f6"},null,8,["src","alt","fallback"]))]),t("div",{class:M(["user-name",{"user-name-dark":J}])},_(p(b).user.name),3),t("div",{class:M(["user-email",{"user-email-dark":J}])},_(p(b).user.email),3),t("button",{class:M(["signout-button",{"signout-button-hovered":c.value}]),onClick:T,onMouseover:d[2]||(d[2]=n=>c.value=!0),onMouseleave:d[3]||(d[3]=n=>c.value=!1)},[d[4]||(d[4]=t("span",null,"Sair",-1)),t("span",Ie,_(l(p(b).user.expires_countdown)),1)],34)])],2)):S("",!0)]),_:1}),a.value?(y(),h("div",{key:0,class:"overlay",onClick:D})):S("",!0)])):(y(),h("div",Se,[t("button",{class:"gsi-material-button",type:"button",onClick:E},d[5]||(d[5]=[t("div",{class:"gsi-material-button-state"},null,-1),t("div",{class:"gsi-material-button-content-wrapper"},[t("div",{class:"gsi-material-button-icon"}),t("span",{class:"gsi-material-button-contents"},"Entrar com Google")],-1)]))]))]))}},Ae=G(Te,[["__scopeId","data-v-d834dc4c"]]),Me={class:"form-inline"},Oe={class:"form-group"},Ce={class:"row"},Le={class:"form-group"},Ue={class:"row"},Fe={class:"form-group"},Re={class:"row"},ze=["value"],Ne={class:"form-group"},Ve={class:"flex gap-xs"},Ye={class:"form-group"},je={class:"flex gap-xs"},qe={class:"form-group",style:{"align-items":"flex-start"}},Be=["id","value"],Ge=["for"],He={class:"form-group",style:{"text-align":"right"}},Ke=["disabled"],We={class:"form-inline",style:{gap:"1rem","margin-top":"1rem"}},Pe={__name:"filters-agenda",setup(O){const b=le(),g=pe(),{agenda:a,auth:$}=j(),{$toast:c}=te(),w=A(!1),D={formatISOToInput(i){if(!i)return"";const o=new Date(i);return i.length>10?o.toISOString().slice(0,16):o.toISOString().slice(0,10)},getDefaultDates(){const i=new Date,o=new Date;return o.setDate(i.getDate()+70),{today:this.formatISOToInput(i),future:this.formatISOToInput(o)}},getFriendlyErrorMessage(i){const o=i?.result?.error?.message||i?.message||i?.toString()||"";return o.includes("Request is missing required authentication credential")?"Sua sess√£o expirou. Por favor, fa√ßa login novamente para acessar os eventos.":`Erro (${i?.result?.error?.code||""}) ao carregar eventos: ${o}`},sleep(i){return new Promise(o=>setTimeout(o,i))}},{today:E,future:T}=D.getDefaultDates();(()=>{const i=b.query||{};if(i.calendar){const o=Array.isArray(i.calendar)?i.calendar:i.calendar.split(",").filter(Boolean);a.filters.calendarIDs=o}else a.filters.calendarIDs=[];a.filters.title=i.title||"",a.filters.locale=i.locale||"",a.filters.search=i.search||"",a.filters.date=i.date||"",a.filters.start=i.start||E,a.filters.end=i.end||T})();const s=ee(()=>{const i=Object.fromEntries(Object.entries(a.filters).filter(([o,u])=>o==="calendarIDs"?Array.isArray(u)&&u.length>0:u!==""&&u!==null&&u!==void 0).map(([o,u])=>o==="calendarIDs"&&Array.isArray(u)?["calendar",u.join(",")]:[o,u]));g.replace({query:{...i}})},300);function e(i){a.filters[i]="",i==="date"&&(a.filters.start=D.formatISOToInput(E),a.filters.end=D.formatISOToInput(T)),i==="calendarIDs"&&(a.filters.calendarIDs=[]),s()}async function d(){try{if(window&&!window?.gapi?.client?.calendar){c.error("Google Calendar API n√£o est√° dispon√≠vel. Fa√ßa login ou aguarde o carregamento.");return}await D.sleep(200),await c.promise(a.fetchGoogleCalendars(),{pending:"Carregando eventos...",success:"Eventos carregados com sucesso!",error:{render({data:i}){return D.getFriendlyErrorMessage(i)}}})}catch(i){c.error(D.getFriendlyErrorMessage(i)),console.error(`Erro (${i.result?.error?.code}) ao carregar eventos: ${i.result?.error?.message}`,i)}finally{w.value=!1}}async function n(){await a.fetchGoogleEvents()}const m=ee(async()=>{try{w.value=!0,await a.awaitGapi(),await d(),await n()}catch{c.error("Google Calendar API n√£o foi carregada. Tente recarregar a p√°gina ou aguarde.")}finally{w.value=!1}},400);return U(()=>$.user.token,async i=>{i&&m()},{immediate:!0}),ne(()=>{m()}),U(()=>({...a.filters}),()=>{s()},{deep:!0}),(i,o)=>(y(),h("div",null,[L(Ae,{style:{"margin-bottom":"8px"}}),t("div",Me,[t("div",null,[t("div",Oe,[o[11]||(o[11]=t("label",{for:"search",class:"text-sm font-medium text-gray-700 mb-1"},"Pesquisar",-1)),t("div",Ce,[k(t("input",{id:"search","onUpdate:modelValue":o[0]||(o[0]=u=>p(a).filters.search=u),type:"text",placeholder:"Buscar eventos..."},null,512),[[I,p(a).filters.search]]),p(a).filters.search?(y(),h("button",{key:0,"aria-label":"Limpar pesquisa",type:"button",onClick:o[1]||(o[1]=u=>e("search"))}," √ó ")):S("",!0)])]),t("div",Le,[o[12]||(o[12]=t("label",{for:"title",class:"text-sm font-medium text-gray-700 mb-1"},"T√≠tulo",-1)),t("div",Ue,[k(t("input",{id:"title","onUpdate:modelValue":o[2]||(o[2]=u=>p(a).filters.title=u),type:"text",placeholder:"Filtrar por t√≠tulo..."},null,512),[[I,p(a).filters.title]]),p(a).filters.title?(y(),h("button",{key:0,"aria-label":"Limpar t√≠tulo",type:"button",onClick:o[3]||(o[3]=u=>e("title"))}," √ó ")):S("",!0)])]),t("div",Fe,[o[14]||(o[14]=t("label",{for:"locale",class:"text-sm font-medium text-gray-700 mb-1"},"Local",-1)),t("div",Re,[k(t("select",{id:"locale","onUpdate:modelValue":o[4]||(o[4]=u=>p(a).filters.locale=u)},[o[13]||(o[13]=t("option",{value:""},"Todos os locais",-1)),(y(!0),h(z,null,N(p(a).eventsLocales,u=>(y(),h("option",{key:u,value:u},_(u),9,ze))),128))],512),[[ie,p(a).filters.locale]]),p(a).filters.locale?(y(),h("button",{key:0,"aria-label":"Limpar local",type:"button",onClick:o[5]||(o[5]=u=>e("locale"))}," √ó ")):S("",!0)])]),t("div",Ne,[o[15]||(o[15]=t("label",{for:"date",class:"text-sm font-medium text-gray-700 mb-1"},"Data",-1)),t("div",Ve,[k(t("input",{id:"date","onUpdate:modelValue":o[6]||(o[6]=u=>p(a).filters.date=u),type:"date"},null,512),[[I,p(a).filters.date]]),p(a).filters.date?(y(),h("button",{key:0,"aria-label":"Limpar data",type:"button",onClick:o[7]||(o[7]=u=>e("date"))}," √ó ")):S("",!0)])]),t("div",Ye,[o[16]||(o[16]=t("label",null,"Intervalo de Datas",-1)),t("div",je,[k(t("input",{id:"datepicker-range-start","onUpdate:modelValue":o[8]||(o[8]=u=>p(a).filters.start=u),type:"date"},null,512),[[I,p(a).filters.start]]),k(t("input",{id:"datepicker-range-end","onUpdate:modelValue":o[9]||(o[9]=u=>p(a).filters.end=u),type:"date"},null,512),[[I,p(a).filters.end]])])])]),t("div",null,[t("div",qe,[o[17]||(o[17]=t("label",null,"Calend√°rios",-1)),t("div",null,[(y(!0),h(z,null,N(p(a).calendars,u=>(y(),h("div",{key:u.id,style:{"margin-bottom":"2px"}},[k(t("input",{id:"calendar-"+u.id,"onUpdate:modelValue":o[10]||(o[10]=x=>p(a).filters.calendarIDs=x),type:"checkbox",value:u.id,style:{margin:"5px 5px 0 0"}},null,8,Be),[[fe,p(a).filters.calendarIDs]]),t("label",{for:"calendar-"+u.id,style:{"margin-bottom":"0"}},_(u.summary),9,Ge)]))),128))])]),t("div",He,[o[18]||(o[18]=t("label",null,null,-1)),t("button",{class:"success",disabled:p(w)||p(a).loading,onClick:n},_(p(w)||p(a).loading?"Atualizando...":"Aplicar"),9,Ke)])])]),t("div",We,[t("span",null,[o[19]||(o[19]=t("i",{class:"la la-calendar-check"},null,-1)),Z(" "+_(p(a)?.calendars?.length),1)]),t("span",null,[o[20]||(o[20]=t("i",{class:"la la-tasks"},null,-1)),Z(" "+_(p(a).eventsFiltered?.length),1)])])]))}},Je={colspan:"8"},Qe=["onDblclick"],Ze={key:0,class:"la la-redo-alt print-hide",style:{color:"#9e9e9e"}},Xe={class:"tooltip","data-tooltip":"Data fim"},et=["onUpdate:modelValue","onFocusout"],tt=["onFocusout"],at=["onFocusout"],rt={class:"print-hide"},ot=["onClick"],st={__name:"edit",setup(O){const{agenda:b,lista:g}=j(),a=X({}),$={formatISOToInput(l){if(!l)return"";const s=new Date(l),e=d=>d.toString().padStart(2,"0");return l.length>10?`${s.getFullYear()}-${e(s.getMonth()+1)}-${e(s.getDate())}T${e(s.getHours())}:${e(s.getMinutes())}`:`${s.getFullYear()}-${e(s.getMonth()+1)}-${e(s.getDate())}`}},c={grouped:Y(()=>{const l=g.titles||[],s=(b.eventsFiltered||[]).reduce((d,n)=>{const m=n.summary||n.title||"";return d[m]||(d[m]=[]),d[m].push({...n,startEvent:$.formatISOToInput(n.start?.dateTime||n.start?.date),endEvent:$.formatISOToInput(n.end?.dateTime||n.end?.date)}),d},{}),e={};return l.forEach(d=>{s[d]&&(e[d]=s[d])}),Object.keys(s).forEach(d=>{e[d]||(e[d]=s[d])}),e}),_debouncers:{},handleEdit(l,s,e){if(e!==(l[s]||"")){const d=`${l.id}_${s}`;a[l.id]=!0,this._debouncers[d]||(this._debouncers[d]=ee((n,m,i)=>{const o={summary:m==="summary"?i:n.summary,location:m==="location"?i:n.location,description:m==="description"?i:n.description,start:n.start,end:n.end},u=n.calendarId;b.updateGoogleEvent(u,n.id,o).then(()=>{a[n.id]=!1}).catch(x=>{a[n.id]=!1,console.warn("Erro ao editar evento:",x)})},3e3)),this._debouncers[d](l,s,e)}},updateDate(l,s,e){if($.formatISOToInput(l.start?.dateTime||l.start?.date)!==e){a[l.id]=!0;let n=l.start,m=l.end;const i=Intl.DateTimeFormat().resolvedOptions().timeZone;if(s==="startEvent"){const u=new Date(e),x=new Date(u.getTime()+7200*1e3);x.setMinutes(0,0,0),n={...n,dateTime:u.toISOString(),timeZone:i},m={...m,dateTime:x.toISOString(),timeZone:i}}else if(s==="endEvent"){const u=new Date(e);m={...m,dateTime:u.toISOString(),timeZone:i}}const o={summary:l.summary,location:l.location,description:l.description,start:n,end:m};b.updateGoogleEvent(l.calendarId,l.id,o).then(u=>{a[l.id]=!1,console.log("Evento atualizado com sucesso:",u)}).catch(u=>{a[l.id]=!1,console.warn("Erro ao editar data do evento:",u)})}},openEventLink(l){l&&window.open(l,"_blank")},handleDelete(l){confirm("Tem certeza que deseja excluir este evento?")&&(a[l.id]=!0,b.deleteGoogleEvent(l.calendarId,l.id).then(()=>{a[l.id]=!1}).catch(s=>{a[l.id]=!1,console.warn("Erro ao excluir evento:",s)}))}},w=X({});function D(){Object.values(c.grouped.value).flat().forEach(s=>{w[s.id]?w[s.id].getHTML()!==(s.description||"")&&w[s.id].commands.setContent(s.description||"",!1):w[s.id]=new be({content:`${s.description||""}`.trim().replace(/[\n\r]/g,`
<br />`),extensions:[$e],editorProps:{attributes:{class:"focus:outline-none min-h-[60px] p-2"}},onUpdate:({editor:e})=>{console.log("Atualizando::: ",e.getHTML()),c.handleEdit(s,"description",e.getHTML())}})})}U(()=>c.grouped.value,()=>{me(()=>{D()})},{immediate:!0,deep:!0});function E(l){const s=w[l.id];if(!s)return;const e=s.getHTML();c.handleEdit(l,"description",e)}const T=c.grouped;return(l,s)=>(y(),h("div",null,[(y(!0),h(z,null,N(p(T),(e,d)=>(y(),h("div",{key:d,class:"table-container"},[t("table",null,[t("thead",null,[t("tr",null,[t("th",Je,_(d||"(sem t√≠tulo)"),1)])]),t("tbody",null,[(y(!0),h(z,null,N(e,n=>(y(),h("tr",{key:n.id,onDblclick:m=>c.openEventLink(n.htmlLink)},[t("td",null,[n.recurringEventId?(y(),h("i",Ze)):S("",!0)]),t("td",Xe,[k(t("input",{"onUpdate:modelValue":m=>n.startEvent=m,type:"datetime-local",class:M([{updating:a[n.id]},"date-clean"]),onFocusout:m=>c.updateDate(n,"startEvent",m.target.value)},null,42,et),[[I,n.startEvent]])]),t("td",{contenteditable:"true",class:M([{updating:a[n.id]},"print-hide tooltip"]),"data-tooltip":"Grupo",onFocusout:m=>c.handleEdit(n,"summary",m.target.innerText.trim())},_(n.summary),43,tt),t("td",{contenteditable:"true",class:M(["tooltip",{updating:a[n.id]}]),"data-tooltip":"Local",onFocusout:m=>c.handleEdit(n,"location",m.target.innerText.trim())},_(n.location||""),43,at),t("td",{class:M(["tooltip",{updating:a[n.id]}]),"data-tooltip":"Descri√ß√£o"},[L(p(ye),{editor:w[n.id],onBlur:m=>E(n)},null,8,["editor","onBlur"])],2),t("td",rt,[t("button",{title:"Excluir evento",class:"btn-clean",onClick:m=>c.handleDelete(n)}," üóëÔ∏è ",8,ot)])],40,Qe))),128))])])]))),128))]))}},nt=G(st,[["__scopeId","data-v-ffe01c44"]]),lt={class:"suggestion-container"},it=["onClick"],dt={__name:"suggestion",props:{suggestions:{type:Array,required:!0}},emits:["select"],setup(O,{emit:b}){const g=b,a=c=>typeof c=="string"?c:JSON.stringify(c),$=c=>{g("select",c)};return(c,w)=>(y(),h("ul",lt,[(y(!0),h(z,null,N(O.suggestions,D=>(y(),h("li",{key:a(D),class:"suggestion-item",onClick:E=>$(D)},_(D),9,it))),128))]))}},Q=G(dt,[["__scopeId","data-v-b2c7e18e"]]),ut={class:"border shadow",style:{width:"100%"}},ct={key:0,style:{padding:"1rem",background:"#fff","border-radius":"0 0 0.5rem 0.5rem"}},pt=["value"],ft={style:{display:"block","margin-top":"0.25rem","font-size":"0.85em",color:"#6b7280"}},mt={__name:"recurrence",props:{rrule:{type:String,default:""},data:{type:Object,default:()=>({})},recurrence:{type:String,default:""}},emits:["update:rrule","update:recurrence"],setup(O,{emit:b}){const g=A(!1),a=O,$=b,c=A(a.rrule||""),w=A("");U(()=>a.rrule,l=>{c.value=l||""});const D=Y(()=>{if(!a.data?.date)return null;const l=new Date(a.data.date);return isNaN(l.getTime())?null:l});function E(l){c.value=l.target.value,$("update:rrule",c.value),T()}function T(){w.value="";const l=c.value?.toUpperCase()||"",s=/^(\d+)([DSMA])$/.exec(l);if(!a.data||!D.value){w.value="Data inv√°lida.",$("update:recurrence","");return}if(!s){w.value="Express√£o de recorr√™ncia inv√°lida. Use [n√∫mero][D/S/M/A]",$("update:recurrence","");return}const e=+s[1],n={D:"DAILY",S:"WEEKLY",M:"MONTHLY",A:"YEARLY"}[s[2]];if(!n||e<=0){w.value="Tipo ou intervalo inv√°lido.",$("update:recurrence","");return}const m=D.value,o=["SU","MO","TU","WE","TH","FR","SA"][m.getDay()];if(n==="WEEKLY")$("update:recurrence",`RRULE:FREQ=${n};INTERVAL=${e};BYDAY=${o}`);else if(n==="MONTHLY"){let u=Math.floor((m.getDate()-1)/7)+1;const x=new Date(m);x.setDate(m.getDate()+7),x.getMonth()!==m.getMonth()&&(u=-1);const C=(u===-1?"-1":u)+o;$("update:recurrence",`RRULE:FREQ=${n};INTERVAL=${e};BYDAY=${C}`)}else if(n==="YEARLY"){const u=m.getMonth()+1,x=m.getDate();let C=Math.floor((x-1)/7)+1;const H=new Date(m);H.setDate(x+7),H.getMonth()!==m.getMonth()&&(C=-1);const K=(C===-1?"-1":C)+o;$("update:recurrence",`RRULE:FREQ=YEARLY;INTERVAL=${e};BYMONTH=${u};BYDAY=${K}`)}else $("update:recurrence",`RRULE:FREQ=${n};INTERVAL=${e}`)}return U(()=>a.data?.date,T,{immediate:!0}),(l,s)=>(y(),h("div",ut,[t("button",{type:"button",style:{display:"flex","align-items":"center",width:"100%",padding:"1rem","text-align":"left",color:"#374151",background:"none",border:"none",cursor:"pointer"},onClick:s[0]||(s[0]=e=>g.value=!g.value)},[s[1]||(s[1]=t("i",{class:"la la-tools"},null,-1)),s[2]||(s[2]=t("span",{style:{"margin-left":"0.5rem"}},"Outras op√ß√µes",-1)),t("i",{class:"la la-angle-double-down",style:ge([{"margin-left":"auto",transition:"transform 0.2s"},{transform:g.value?"rotate(180deg)":""}])},null,4)]),g.value?(y(),h("div",ct,[s[3]||(s[3]=t("label",{for:"rrule-input",style:{display:"block","font-size":"0.95em","font-weight":"500",color:"#374151","margin-bottom":"0.25rem"}},"Recorr√™ncia",-1)),t("input",{id:"rrule-input",value:c.value,type:"text",style:{width:"100%",border:"1px solid #d1d5db","border-radius":"0.375rem",padding:"0.5rem 0.75rem","font-size":"0.95em"},placeholder:"Ex: 2S para cada 2 semanas ou 1M para cada m√™s",autocomplete:"off",onInput:E},null,40,pt),t("small",ft,_(w.value)+" "+_(O.recurrence),1)])):S("",!0)]))}},gt={class:"form-group"},vt=["value"],yt={class:"form-group"},bt={class:"form-group"},$t={class:"form-group"},ht={class:"row"},wt={class:"form-group"},Dt={class:"row"},kt={class:"form-group",style:{flex:"1 1 100%"}},Et={class:"form-group",style:{flex:"1 1 100%"}},xt={__name:"create",setup(O){const{$toast:b}=te(),{lista:g,agenda:a}=j(),$=le(),c=v=>String(v).padStart(2,"0");function w(v){return(v||"").toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").trim()}function D(v,r,f=4){if(!r)return v.slice(0,f);const F=w(r);return v.filter(V=>r!==V).filter(V=>F.split(" ").every(W=>w(V).includes(W))).slice(0,f)}function E(v){if(!v)return"";const r=new Date(v);return`${r.getFullYear()}-${c(r.getMonth()+1)}-${c(r.getDate())}T${c(r.getHours())}:${c(r.getMinutes())}`}function T(){const v=new Date,r=new Date;r.setDate(v.getDate()+70);const f=new Date(v);return f.setHours(19,0,0,0),{today:E(f),future:E(r)}}const{today:l}=T(),s=l,e=X({calendarId:"",date:"",end:"",title:"",locale:$.query?.locale||"",desc:"",recurrence:""});U(()=>e.date,v=>{if(!v)return;const r=new Date(v),f=r.getMinutes()===0?2:1.5;e.end=E(new Date(r.getTime()+f*36e5))}),e.date=$.query?.date||s,ve(()=>{const v=a.calendars.filter(r=>a.filters.calendarIDs.includes(r.id));v.length===1&&(e.calendarId=v[0].id)});const d=g.titles,n=g.locales,m=g.desc,i=Y(()=>D(d,e.title,3)),o=Y(()=>D(n,e.locale,3)),u=Y(()=>{if(!e.desc)return[];const v=e.desc.trim().split(/\s+/),r=v.slice(-2).join(" "),f=v.slice(-1).join(" "),F=new Set([...D(m,r),...D(m,f)]);return Array.from(F).slice(0,3)});function x(v,r){r&&(e[v]=r)}function C(v,r){r&&r.length>0&&(e[v]=r[0])}function H(){}async function K(){if(!e.calendarId||!a.calendars.some(v=>v.id===e.calendarId)){alert("Selecione um calend√°rio v√°lido.");return}if(e.date&&e.title&&e.locale){const v={...e};try{const r=new Date(v.date);if(isNaN(r.getTime())){alert("Data inv√°lida.");return}const f=new Date(v.end||r.getTime()+7200*1e3);if(isNaN(r.getTime())){alert("Data inv√°lida.");return}if(f<r){alert("A data de t√©rmino n√£o pode ser anterior √† data de in√≠cio.");return}const F=Intl.DateTimeFormat().resolvedOptions().timeZone,V=r.toISOString(),W=f.toISOString(),ae={summary:v.title,location:v.locale,description:v.desc,start:{dateTime:V,timeZone:F},end:{dateTime:W,timeZone:F}};v.recurrence&&(ae.recurrence=[v.recurrence]);const re=await a.createGoogleEvent(v.calendarId,ae);b.success(re.summary+" criado com sucesso: "+re.description),e.date=s,e.locale="",e.desc="",e.rrule="",e.recurring=""}catch(r){b.error("Erro ao criar evento: "+(r?.message||r)),console.log("Erro ao criar evento: ",r)}}else alert("Por favor, preencha todos os campos obrigat√≥rios.")}return(v,r)=>(y(),h("div",null,[t("form",{class:"form-inline",onSubmit:P(K,["prevent"])},[t("div",gt,[r[15]||(r[15]=t("label",{for:"calendar"},"Calend√°rio:",-1)),k(t("select",{id:"calendar","onUpdate:modelValue":r[0]||(r[0]=f=>e.calendarId=f),required:""},[(y(!0),h(z,null,N(p(a).calendars.filter(f=>p(a).filters.calendarIDs.includes(f.id)),f=>(y(),h("option",{key:f.id,value:f.id},_(f.summary),9,vt))),128))],512),[[ie,e.calendarId]])]),t("div",yt,[r[16]||(r[16]=t("label",{for:"date"},"Data:",-1)),k(t("input",{id:"date","onUpdate:modelValue":r[1]||(r[1]=f=>e.date=f),type:"datetime-local",required:""},null,512),[[I,e.date]])]),t("div",bt,[r[17]||(r[17]=t("label",{for:"end"},"Fim:",-1)),k(t("input",{id:"end","onUpdate:modelValue":r[2]||(r[2]=f=>e.end=f),type:"datetime-local",required:""},null,512),[[I,e.end]])]),t("div",$t,[r[18]||(r[18]=t("label",{for:"title"},"T√≠tulo:",-1)),t("div",ht,[k(t("input",{id:"title","onUpdate:modelValue":r[3]||(r[3]=f=>e.title=f),type:"text",placeholder:"Digite para buscar...",autocomplete:"off",onKeydown:[r[4]||(r[4]=q(P(f=>C("title",i.value),["prevent"]),["enter"])),r[5]||(r[5]=q(f=>void 0,["tab"]))]},null,544),[[I,e.title]]),e.title.length>0&&i.value.length?(y(),R(Q,{key:0,suggestions:i.value,onSelect:r[6]||(r[6]=f=>x("title",f))},null,8,["suggestions"])):S("",!0)])]),t("div",wt,[r[19]||(r[19]=t("label",{for:"locale"},"Local:",-1)),t("div",Dt,[k(t("input",{id:"locale","onUpdate:modelValue":r[7]||(r[7]=f=>e.locale=f),type:"text",placeholder:"Digite para buscar...",autocomplete:"off",onKeydown:[r[8]||(r[8]=q(P(f=>C("locale",o.value),["prevent"]),["enter"])),r[9]||(r[9]=q(f=>void 0,["tab"]))]},null,544),[[I,e.locale]]),e.locale.length>0&&o.value.length?(y(),R(Q,{key:0,suggestions:o.value,onSelect:r[10]||(r[10]=f=>x("locale",f))},null,8,["suggestions"])):S("",!0)])]),t("div",kt,[r[20]||(r[20]=t("label",{for:"desc",style:{display:"flex","align-items":"center",gap:"0.5rem"}},[t("span",{class:"tooltip","data-tooltip":"!nodate para n√£o mostrar a data e hora. "},[Z(" Descri√ß√£o: "),t("i",{class:"la la-info-circle",style:{color:"#2563eb",cursor:"pointer"}})])],-1)),k(t("textarea",{id:"desc","onUpdate:modelValue":r[11]||(r[11]=f=>e.desc=f),rows:"4"},null,512),[[I,e.desc]]),e.desc.length>0&&u.value.length?(y(),R(Q,{key:0,suggestions:u.value,onSelect:r[12]||(r[12]=f=>x("desc",f))},null,8,["suggestions"])):S("",!0)]),t("div",Et,[r[21]||(r[21]=t("label",null,null,-1)),L(mt,{rrule:e.rrule,"onUpdate:rrule":r[13]||(r[13]=f=>e.rrule=f),recurrence:e.recurrence,"onUpdate:recurrence":r[14]||(r[14]=f=>e.recurrence=f),msg:p(g).msg,data:e},null,8,["rrule","recurrence","msg","data"])]),r[22]||(r[22]=t("div",{class:"form-group",style:{flex:"1 1 100%","text-align":"right"}},[t("label"),t("button",{type:"submit",class:"success",style:{width:"100%","max-width":"200px"}}," Adicionar ")],-1))],32)]))}},_t={class:"print-hide"},It={class:"tabs-container print-hide"},St={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},Tt=["aria-selected"],At=["aria-selected"],Mt=["aria-selected"],Ot={class:"tab-content"},Ct={id:"tab-content-filters",role:"tabpanel"},Lt={key:0,id:"tab-content-create",role:"tabpanel"},Ut={id:"tab-content-git",role:"tabpanel"},Nt={__name:"eventos",setup(O){const{auth:b}=j(),g=A("filters");function a($){g.value=$}return($,c)=>{const w=De;return y(),h("div",null,[t("div",_t,[t("div",It,[t("nav",St,[k(t("span",{id:"tab-create","aria-selected":g.value==="git",role:"tab",type:"button",class:M(["tab",{active:g.value==="git"}]),onClick:c[0]||(c[0]=D=>a("git"))},c[3]||(c[3]=[t("i",{class:"la la-git"},null,-1)]),10,Tt),[[B,p(b).user.token]]),k(t("span",{id:"tab-create","aria-selected":g.value==="create",role:"tab",type:"button",class:M(["tab",{active:g.value==="create"}]),onClick:c[1]||(c[1]=D=>a("create"))},c[4]||(c[4]=[t("i",{class:"la la-plus"},null,-1)]),10,At),[[B,p(b).user.token]]),t("span",{id:"tab-filters","aria-selected":g.value==="filters",role:"tab",type:"button",class:M(["tab",{active:g.value==="filters"}]),onClick:c[2]||(c[2]=D=>a("filters"))},c[5]||(c[5]=[t("i",{class:"la la-filter icon"},null,-1)]),10,Mt)])]),t("div",Ot,[k(t("div",Ct,[L(Pe)],512),[[B,g.value==="filters"]]),g.value==="create"?(y(),h("div",Lt,[L(xt)])):S("",!0),k(t("div",Ut,[L(w)],512),[[B,g.value==="git"]])])]),p(b).user.token?(y(),R(nt,{key:0})):S("",!0)])}}};export{Nt as default};
