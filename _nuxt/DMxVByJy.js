import{L as te}from"./BXVbbdtd.js";import{_ as ne,y as ae,A as se,r as D,h as b,B as P,c as u,C as le,a,t as m,F as y,k as _,e as z,i as oe,D as re,o,n as I,m as O,E,p as ue,G as ie}from"./CyWUL_Tt.js";const ce={key:1,class:"calendar-wrapper"},de={class:"calendar-panel"},ve={class:"calendar-header"},he={class:"month-year"},ge={class:"calendar-table"},fe=["onClick"],pe={class:"day-content"},me={class:"day-number"},De={key:0,class:"event-indicators"},ye={class:"events-panel"},_e={class:"events-list-container"},be={class:"chips-container"},ke={key:0,class:"las la-toggle-on"},Ce={key:1,class:"las la-toggle-off"},we=["onClick"],Me={key:0,class:"las la-toggle-on"},Te={key:1,class:"las la-toggle-off"},xe={class:"search-container"},Se={key:0},Ne={class:"event-date-title"},Ee={class:"events-list"},Ue={class:"sub-events-list"},$e=["onClick"],Fe=["innerHTML"],Ge={key:1,class:"no-events-message"},Le={__name:"agenda",setup(Ye){const{lista:C}=ae(),R=se(),U=D(!0),T=new Date,v=D(T.getMonth()),p=D(T.getFullYear()),h=D(null),x=D(""),f=D([]),w=b(()=>Array.from(new Set(C.allEvents.map(e=>e.group))).filter(e=>e).sort((e,t)=>e.localeCompare(t))),$=b(()=>f.value.length===w.value.length);P(w,e=>{f.value.length===0&&(f.value=[...e])},{immediate:!0});function q(e){const t=f.value.indexOf(e);t===-1?f.value.push(e):f.value.splice(t,1)}function V(){$.value?f.value=[]:f.value=[...w.value]}const S=b(()=>{const e=x.value.trim();let t=C.allEvents;if(R.query.next==="true"){const l=new Date;t=t.filter(d=>new Date(d.date)>l)}if(t=t.filter(l=>f.value.includes(l.group)),!e)return t;const n=l=>`${M(l.title||"")} ${M(l.locale||"")} ${M(l.desc||"")} ${new Date(l.date).toLocaleDateString("pt-BR")}`,i=(l,d)=>d.every(ee=>ee.test(l)),c=(l,d)=>d.test(l),r=t.map(l=>({event:l,text:n(l)}));if(e.includes("|"))try{const l=new RegExp(e,"i");return r.filter(({text:d})=>c(d,l)).map(({event:d})=>d)}catch(l){return console.error("Regex inválida:",l),[]}const k=M(e).replace(/\bou/gi,",").split(/,|\s+/).filter(Boolean).map(l=>new RegExp(l,"i"));return r.filter(({text:l})=>i(l,k)).map(({event:l})=>l)}),F=b(()=>{let e;if(h.value){const s=h.value.date;e=S.value.filter(n=>{const i=new Date(n.date);return i.getUTCFullYear()===s.getFullYear()&&i.getUTCMonth()===s.getMonth()&&i.getUTCDate()===s.getDate()})}else e=S.value.filter(s=>{const n=new Date(s.date);return n.getUTCFullYear()===p.value&&n.getUTCMonth()===v.value});const t=new Map;for(const s of e){const i=new Date(s.date).toISOString().split("T")[0];t.has(i)||t.set(i,new Map);const c=t.get(i);c.has(s.title)||c.set(s.title,[]),c.get(s.title).push(s)}return Array.from(t.entries()).sort(([s],[n])=>new Date(s)-new Date(n))}),G=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],J=b(()=>`${G[v.value]} ${p.value}`),Q=b(()=>{const e=[],t=new Date(p.value,v.value,1).getDay(),s=new Date(p.value,v.value+1,0).getDate(),n=new Date(p.value,v.value,0).getDate();for(let r=t-1;r>=0;r--)e.push({dayNumber:n-r,isPrevMonth:!0,isNextMonth:!1,isToday:!1,hasEvent:!1,events:[]});for(let r=1;r<=s;r++){const g=new Date(p.value,v.value,r),k=S.value.filter(l=>{const d=new Date(l.date);return d.getUTCDate()===r&&d.getUTCMonth()===v.value&&d.getUTCFullYear()===p.value});e.push({dayNumber:r,date:g,isPrevMonth:!1,isNextMonth:!1,isToday:g.toDateString()===T.toDateString(),hasEvent:k.length>0,events:k})}const i=42-e.length;for(let r=1;r<=i;r++)e.push({dayNumber:r,isPrevMonth:!1,isNextMonth:!0,isToday:!1,hasEvent:!1,events:[]});const c=[];for(;e.length>0;)c.push(e.splice(0,7));return c});function H(e){const t=new Date(e),s=t.getUTCDate(),n=G[t.getUTCMonth()],i=t.getUTCFullYear();return`${s} de ${n} de ${i}`}function L(e){v.value+=e,v.value<0?(v.value=11,p.value--):v.value>11&&(v.value=0,p.value++),h.value=null}function j(e){return{"prev-month-day":e.isPrevMonth||e.isNextMonth,today:e.isToday,"has-event":e.hasEvent,"selected-day":h.value&&h.value.date&&e.date&&h.value.date.toDateString()===e.date.toDateString()}}function K(e){!e.isPrevMonth&&!e.isNextMonth&&(h.value&&h.value.date.toDateString()===e.date.toDateString()?h.value=null:h.value=e)}function W(e){return h.value?e.some(t=>{const s=new Date(t.date),n=h.value.date;return s.getUTCFullYear()===n.getFullYear()&&s.getUTCMonth()===n.getMonth()&&s.getUTCDate()===n.getDate()}):!1}function M(e){return e?e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""):""}const X=e=>{const t=`https://www.google.com/calendar/event?eid=${e.htmlLink}`;window.open(t,"_blank")};function Z(e){const t=new Set;for(const s of e)s.group&&t.add(s.group);return[...t]}const Y=["#c4d7b9","#b4d0e3","#d6b8c1","#d1c965","#cdb8d1","#c3bfe0","#e6b97f","#aed4d7","#b3a9a5","#a9c6aa","#d39a8f","#b0a2cc","#d28fa9","#b2d29f","#d1b05e","#84c9cc","#d1be83","#92c2be","#a3b1b5","#bdc75d"],N=D({});function A(e){if(!N.value[e]){const s=Array.from(new Set(C.allEvents.map(n=>n.group).filter(n=>n!==null))).indexOf(e);N.value[e]=Y[s%Y.length]}return N.value[e]}function B(e){return{backgroundColor:A(e)}}return P(()=>C.allEvents,e=>{e&&e.length>0&&(U.value=!1)},{immediate:!0}),(e,t)=>{const s=te;return o(),u("div",null,[U.value?(o(),le(s,{key:0})):(o(),u("div",ce,[a("div",de,[a("div",ve,[a("i",{class:"las la-chevron-left",onClick:t[0]||(t[0]=n=>L(-1))}),a("h2",he,m(J.value),1),a("i",{class:"las la-chevron-right",onClick:t[1]||(t[1]=n=>L(1))})]),a("table",ge,[t[3]||(t[3]=a("thead",null,[a("tr",null,[a("th",null,"Dom"),a("th",null,"Seg"),a("th",null,"Ter"),a("th",null,"Qua"),a("th",null,"Qui"),a("th",null,"Sex"),a("th",null,"Sáb")])],-1)),a("tbody",null,[(o(!0),u(y,null,_(Q.value,(n,i)=>(o(),u("tr",{key:i},[(o(!0),u(y,null,_(n,c=>(o(),u("td",{key:c.date,class:I(j(c)),onClick:r=>K(c)},[a("div",pe,[a("div",me,m(c.dayNumber),1),c.events.length?(o(),u("div",De,[(o(!0),u(y,null,_(Z(c.events),r=>(o(),u("span",{key:r,class:"event-indicator",style:E({backgroundColor:A(r)})},null,4))),128))])):O("",!0)])],10,fe))),128))]))),128))])])]),a("div",ye,[a("div",_e,[a("div",be,[a("span",{class:"chip",onClick:V},[$.value?(o(),u("i",ke)):(o(),u("i",Ce)),t[4]||(t[4]=z(" Todos "))]),(o(!0),u(y,null,_(w.value,n=>(o(),u("span",{key:n,class:"chip",style:E(B(n)),onClick:i=>q(n)},[f.value.includes(n)?(o(),u("i",Me)):(o(),u("i",Te)),z(" "+m(n),1)],12,we))),128))]),a("div",xe,[oe(a("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>x.value=n),type:"text",placeholder:"Buscar eventos...",class:"search-input"},null,512),[[re,x.value]]),t[5]||(t[5]=a("i",{class:"las la-search search-icon"},null,-1))]),Object.keys(F.value).length?(o(),u("div",Se,[(o(!0),u(y,null,_(F.value,([n,i])=>(o(),u("div",{key:n},[a("h4",Ne,m(H(n)),1),a("ul",Ee,[(o(!0),u(y,null,_(i,([c,r])=>(o(),u("li",{key:c,class:I({"selected-event":W(r)}),style:E(B(r[0].group))},[a("strong",null,m(c),1),a("ul",Ue,[(o(!0),u(y,null,_(r,g=>(o(),u("li",{key:g.id,onClick:k=>X(g)},[a("p",null,[a("b",null,[a("i",null,m(g.formatTime)+m(g.formatTime?" - ":"")+m(g.formatDate),1)])]),a("p",null,m(g.locale),1),g.desc?(o(),u("p",{key:0,innerHTML:ue(ie)(g.desc)},null,8,Fe)):O("",!0)],8,$e))),128))])],6))),128))])]))),128))])):(o(),u("p",Ge,"Nenhum evento agendado."))])])]))])}}},Pe=ne(Le,[["__scopeId","data-v-46f37b62"]]);export{Pe as default};
