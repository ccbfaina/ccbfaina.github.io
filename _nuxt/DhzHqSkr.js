import{L as re}from"./BOE-s5tW.js";import{_ as ue,u as ce,y as ie,r as m,h as b,z as X,c as u,A as de,a,t as D,F as y,k as _,e as q,i as ve,B as he,o,n as V,m as J,C as U,p as fe,D as ge}from"./B1Iik-RR.js";const pe={key:1,class:"calendar-wrapper"},me={class:"calendar-header"},De={class:"month-year"},ye={class:"calendar-table"},_e=["onClick"],be={class:"day-content"},ke={class:"day-number"},Ce={key:0,class:"event-indicators"},Me={class:"events-panel"},we={class:"events-list-container"},Te={class:"chips-container"},xe={key:0,class:"las la-toggle-on"},Se={key:1,class:"las la-toggle-off"},Ee=["onClick"],Ne={key:0,class:"las la-toggle-on"},Ue={key:1,class:"las la-toggle-off"},$e={class:"search-container"},Fe={key:0},Ge={class:"event-date-title"},Le={class:"events-list"},Ye={class:"sub-events-list"},Ae=["onClick"],ze=["innerHTML"],Re={key:1,class:"no-events-message"},Q=50,Be={__name:"agenda",setup(Oe){const{lista:C}=ce(),H=ie(),$=m(!0),x=new Date,v=m(x.getMonth()),p=m(x.getFullYear()),h=m(null),S=m(""),g=m([]),M=b(()=>Array.from(new Set(C.allEvents.map(e=>e.group))).filter(e=>e).sort((e,t)=>e.localeCompare(t))),F=b(()=>g.value.length===M.value.length);X(M,e=>{g.value.length===0&&(g.value=[...e])},{immediate:!0});function j(e){const t=g.value.indexOf(e);t===-1?g.value.push(e):g.value.splice(t,1)}function K(){F.value?g.value=[]:g.value=[...M.value]}const E=b(()=>{const e=S.value.trim();let t=C.allEvents;if(H.query.next==="true"){const l=new Date;t=t.filter(d=>new Date(d.date)>l)}if(t=t.filter(l=>g.value.includes(l.group)),!e)return t;const n=l=>`${T(l.title||"")} ${T(l.locale||"")} ${T(l.desc||"")} ${new Date(l.date).toLocaleDateString("pt-BR")}`,c=(l,d)=>d.every(oe=>oe.test(l)),i=(l,d)=>d.test(l),r=t.map(l=>({event:l,text:n(l)}));if(e.includes("|"))try{const l=new RegExp(e,"i");return r.filter(({text:d})=>i(d,l)).map(({event:d})=>d)}catch(l){return console.error("Regex inválida:",l),[]}const k=T(e).replace(/\bou/gi,",").split(/,|\s+/).filter(Boolean).map(l=>new RegExp(l,"i"));return r.filter(({text:l})=>c(l,k)).map(({event:l})=>l)}),G=b(()=>{let e;if(h.value){const s=h.value.date;e=E.value.filter(n=>{const c=new Date(n.date);return c.getUTCFullYear()===s.getFullYear()&&c.getUTCMonth()===s.getMonth()&&c.getUTCDate()===s.getDate()})}else e=E.value.filter(s=>{const n=new Date(s.date);return n.getUTCFullYear()===p.value&&n.getUTCMonth()===v.value});const t=new Map;for(const s of e){const c=new Date(s.date).toISOString().split("T")[0];t.has(c)||t.set(c,new Map);const i=t.get(c);i.has(s.title)||i.set(s.title,[]),i.get(s.title).push(s)}return Array.from(t.entries()).sort(([s],[n])=>new Date(s)-new Date(n))}),L=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],W=b(()=>`${L[v.value]} ${p.value}`),Z=b(()=>{const e=[],t=new Date(p.value,v.value,1).getDay(),s=new Date(p.value,v.value+1,0).getDate(),n=new Date(p.value,v.value,0).getDate();for(let r=t-1;r>=0;r--)e.push({dayNumber:n-r,isPrevMonth:!0,isNextMonth:!1,isToday:!1,hasEvent:!1,events:[]});for(let r=1;r<=s;r++){const f=new Date(p.value,v.value,r),k=E.value.filter(l=>{const d=new Date(l.date);return d.getUTCDate()===r&&d.getUTCMonth()===v.value&&d.getUTCFullYear()===p.value});e.push({dayNumber:r,date:f,isPrevMonth:!1,isNextMonth:!1,isToday:f.toDateString()===x.toDateString(),hasEvent:k.length>0,events:k})}const c=42-e.length;for(let r=1;r<=c;r++)e.push({dayNumber:r,isPrevMonth:!1,isNextMonth:!0,isToday:!1,hasEvent:!1,events:[]});const i=[];for(;e.length>0;)i.push(e.splice(0,7));return i});function ee(e){const t=new Date(e),s=t.getUTCDate(),n=L[t.getUTCMonth()],c=t.getUTCFullYear();return`${s} de ${n} de ${c}`}function w(e){v.value+=e,v.value<0?(v.value=11,p.value--):v.value>11&&(v.value=0,p.value++),h.value=null}function te(e){return{"prev-month-day":e.isPrevMonth||e.isNextMonth,today:e.isToday,"has-event":e.hasEvent,"selected-day":h.value&&h.value.date&&e.date&&h.value.date.toDateString()===e.date.toDateString()}}function ne(e){!e.isPrevMonth&&!e.isNextMonth&&(h.value&&h.value.date.toDateString()===e.date.toDateString()?h.value=null:h.value=e)}function ae(e){return h.value?e.some(t=>{const s=new Date(t.date),n=h.value.date;return s.getUTCFullYear()===n.getFullYear()&&s.getUTCMonth()===n.getMonth()&&s.getUTCDate()===n.getDate()}):!1}function T(e){return e?e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""):""}const se=e=>{const t=`https://www.google.com/calendar/event?eid=${e.htmlLink}`;window.open(t,"_blank")};function le(e){const t=new Set;for(const s of e)s.group&&t.add(s.group);return[...t]}const Y=["#d6b8c1","#d1c965","#cdb8d1","#aed4d7","#b3a9a5","#a9c6aa","#d39a8f","#b0a2cc","#d28fa9","#b2d29f","#d1b05e","#84c9cc","#d1be83","#92c2be","#a3b1b5","#bdc75d"],A={Reuniões:"#c4d7b9",Atendimentos:"#b4d0e3",Rodízios:"#e6b97f",Outros:"#c3bfe0"},N=m({});function z(e){if(A[e])return A[e];if(!N.value[e]){const s=Array.from(new Set(C.allEvents.map(n=>n.group).filter(n=>n!==null))).indexOf(e);N.value[e]=Y[s%Y.length]}return N.value[e]}function R(e){return{backgroundColor:z(e)}}X(()=>C.allEvents,e=>{e&&e.length>0&&($.value=!1)},{immediate:!0});const B=m(0),O=m(0);function P(e){B.value=e.touches?e.touches[0].clientX:e.clientX}function I(e){O.value=e.changedTouches?e.changedTouches[0].clientX:e.clientX;const t=O.value-B.value;t>Q?w(-1):t<-Q&&w(1)}return(e,t)=>{const s=re;return o(),u("div",null,[$.value?(o(),de(s,{key:0})):(o(),u("div",pe,[a("div",{class:"calendar-panel",onTouchstart:P,onTouchend:I,onMousedown:P,onMouseup:I},[a("div",me,[a("i",{class:"las la-chevron-left",onClick:t[0]||(t[0]=n=>w(-1))}),a("h2",De,D(W.value),1),a("i",{class:"las la-chevron-right",onClick:t[1]||(t[1]=n=>w(1))})]),a("table",ye,[t[3]||(t[3]=a("thead",null,[a("tr",null,[a("th",null,"Dom"),a("th",null,"Seg"),a("th",null,"Ter"),a("th",null,"Qua"),a("th",null,"Qui"),a("th",null,"Sex"),a("th",null,"Sáb")])],-1)),a("tbody",null,[(o(!0),u(y,null,_(Z.value,(n,c)=>(o(),u("tr",{key:c},[(o(!0),u(y,null,_(n,i=>(o(),u("td",{key:i.date,class:V(te(i)),onClick:r=>ne(i)},[a("div",be,[a("div",ke,D(i.dayNumber),1),i.events.length?(o(),u("div",Ce,[(o(!0),u(y,null,_(le(i.events),r=>(o(),u("span",{key:r,class:"event-indicator",style:U({backgroundColor:z(r)})},null,4))),128))])):J("",!0)])],10,_e))),128))]))),128))])])],32),a("div",Me,[a("div",we,[a("div",Te,[a("span",{class:"chip",onClick:K},[F.value?(o(),u("i",xe)):(o(),u("i",Se)),t[4]||(t[4]=q(" Todos "))]),(o(!0),u(y,null,_(M.value,n=>(o(),u("span",{key:n,class:"chip",style:U(R(n)),onClick:c=>j(n)},[g.value.includes(n)?(o(),u("i",Ne)):(o(),u("i",Ue)),q(" "+D(n),1)],12,Ee))),128))]),a("div",$e,[ve(a("input",{"onUpdate:modelValue":t[2]||(t[2]=n=>S.value=n),type:"text",placeholder:"Buscar eventos...",class:"search-input"},null,512),[[he,S.value]]),t[5]||(t[5]=a("i",{class:"las la-search search-icon"},null,-1))]),Object.keys(G.value).length?(o(),u("div",Fe,[(o(!0),u(y,null,_(G.value,([n,c])=>(o(),u("div",{key:n},[a("h4",Ge,D(ee(n)),1),a("ul",Le,[(o(!0),u(y,null,_(c,([i,r])=>(o(),u("li",{key:i,class:V({"selected-event":ae(r)}),style:U(R(r[0].group))},[a("strong",null,D(i),1),a("ul",Ye,[(o(!0),u(y,null,_(r,f=>(o(),u("li",{key:f.id,onClick:k=>se(f)},[a("p",null,[a("b",null,[a("i",null,D(f.formatTime)+D(f.formatTime?" - ":"")+D(f.formatDate),1)])]),a("p",null,D(f.locale),1),f.desc?(o(),u("p",{key:0,innerHTML:fe(ge)(f.desc)},null,8,ze)):J("",!0)],8,Ae))),128))])],6))),128))])]))),128))])):(o(),u("p",Re,"Nenhum evento agendado."))])])]))])}}},Xe=ue(Be,[["__scopeId","data-v-0c5d75ba"]]);export{Xe as default};
