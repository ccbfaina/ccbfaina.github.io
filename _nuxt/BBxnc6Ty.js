import{_ as H,r as S,f as j,H as J,i as N,j as f,c as n,a as t,m,t as O,e as p,x as u,N as W,k as E,I as k,F as I,n as A,C as w,a0 as Z,a1 as K,a2 as Q,q as X,o as l,a3 as Y,a4 as ee,a5 as T,a6 as te,a7 as ae,a8 as oe,a9 as se,aa as ne}from"./lSMWsiWr.js";const le={id:"app"},ie={"aria-labelledby":"auth-heading",class:"auth-section"},re={key:1,class:"user-info"},de=["src"],ue={key:0},ce={"aria-labelledby":"form-heading",class:"form-section"},ve={id:"form-heading"},ge={class:"form-group"},me=["value"],pe={class:"form-group"},Se={class:"form-group"},fe=["value"],Ee={class:"form-group"},Ie={class:"success",type:"submit"},Ae={"aria-labelledby":"events-heading",class:"events-list"},ye={key:0},he={key:1,class:"no-events-message"},Oe={key:2},be={class:"event-items"},Re={key:0},De={class:"event-actions"},_e=["onClick","aria-label"],Ce=["onClick","aria-label"],Ne={key:1,class:"no-events-message"},ke={__name:"solicitar",setup(we){const g=S([]),c=S(!1),y=S(!1),s=S({regional:"",title:"",desc:"",date:"",userId:null,status:""}),{$session:U}=j(),{firebaseAuth:b,firebaseDb:R,eventsCollection:D}=U,{user:r}=J(),L=X(),v=localStorage.getItem("selectedRegional")||"";v&&(s.value.regional=v),N(()=>s.value.regional,o=>{o&&localStorage.setItem("selectedRegional",o)});const _=()=>{const o=localStorage.getItem("selectedRegional")||"";s.value={regional:o,title:"",desc:"",date:"",userId:r?.uid||null};const e=new Date;e.setHours(16,0,0,0),s.value.date=e.toISOString().slice(0,16),c.value=!1},V=async o=>{try{o?await Z(b,new K):await Q(b)}catch(e){console.error("Erro ao fazer login com Google:",e),alert("Ocorreu um erro ao fazer login. Tente novamente.")}},h=async o=>{if(!o){g.value=[];return}y.value=!0;try{const e=oe(D,se("userId","==",o)),a=await ne(e);g.value=a.docs.map(d=>{const i=d.data();return i.date=i.date?.seconds?new Date(i.date.seconds*1e3).toISOString().slice(0,16):new Date().toISOString().slice(0,16),{id:d.id,...i}})}catch(e){console.error("Erro ao buscar eventos:",e)}finally{y.value=!1}},M=async()=>{if(!r||!s.value.title||!s.value.date)return;s.value.date||(s.value.date=new Date().toISOString().slice(0,16));const o={...s.value,date:Y.fromDate(new Date(s.value.date)),userId:r.uid};try{c.value?await ee(T(R,"events",s.value.id),o):await te(D,o),_(),await h(r.uid)}catch(e){console.error(`Erro ao ${c.value?"atualizar":"adicionar"} evento:`,e),alert(`Ocorreu um erro ao ${c.value?"atualizar":"adicionar"} o evento.`)}},G=o=>{c.value=!0,s.value={...o},s.value.date=new Date(o.date).toISOString().slice(0,16),document.querySelector("#event-form").scrollIntoView({behavior:"smooth"})},q=async o=>{if(confirm("Tem certeza que deseja deletar este evento?"))try{await ae(T(R,"events",o)),await h(r.uid)}catch(e){console.error("Erro ao deletar evento:",e),alert("Ocorreu um erro ao deletar o evento.")}};N(()=>r,o=>{if(o){const e=new Date;e.setHours(16,0,0,0),s.value.date=e.toISOString().slice(0,16),h(o.uid)}else g.value=[]},{immediate:!0,deep:!0});const C=f(()=>!!r),x=f(()=>c.value?"Editando Evento":"Novo Evento"),$=f(()=>c.value?"Atualizar Evento":"Adicionar Evento"),B=["Regional Faina","Regional Goiânia","Regional Catalão","Regional Bom Jesus","Regional Uruaçu"],F=["BATISMOS","SANTAS CEIAS","AVISOS À IRMANDADE","CULTO PARA A MOCIDADE","REUNIÕES PARA A MOCIDADE","ENSAIOS REGIONAIS","ENSAIO REGIONAL","ASSUNTOS MUSICAIS","REUNIÕES REGIONAIS","REUNIÕES DIVERSAS","CULTO PARA JOVENS","VIAGENS MISSIONÁRIAS","VERIFICAÇÕES","CULTO ESPECIAL","ENSAIO COM A IRMANDADE","ENSAIO LOCAL","REUNIÃO DE EVANGELIZAÇÃO","OUTROS"],P=f(()=>{const o=g.value.reduce((a,d)=>(a[d.regional]||(a[d.regional]=[]),a[d.regional].push(d),a),{}),e={};return v&&o[v]&&(e[v]=o[v]),{...e,...o}});return(o,e)=>(l(),n("div",le,[t("main",null,[t("section",ie,[e[9]||(e[9]=t("h2",{id:"auth-heading",class:"sr-only"},"Autenticação",-1)),C.value?(l(),n("div",re,[m(r).photoURL?(l(),n("img",{key:0,src:m(r).photoURL,alt:"Foto do usuário",width:"40",height:"40","aria-hidden":"true"},null,8,de)):O("",!0),t("p",null,[e[7]||(e[7]=p("Bem-vindo(a), ",-1)),t("span",null,u(m(r).displayName||m(r).email),1),e[8]||(e[8]=p("!",-1))])])):(l(),n("div",{key:0,onClick:e[1]||(e[1]=a=>m(L).push("/perfil"))},[e[6]||(e[6]=t("p",null,"Faça login para gerenciar seus eventos:",-1)),t("button",{onClick:e[0]||(e[0]=a=>V(!0)),"aria-label":"Entrar com o Google"},"Login com Google")]))]),C.value?(l(),n("div",ue,[t("section",ce,[t("h2",ve,u(x.value),1),t("form",{id:"event-form",onSubmit:W(M,["prevent"])},[t("div",ge,[e[11]||(e[11]=t("label",{for:"event-regional"},[p("Regional "),t("span",{"aria-hidden":"true"},"*")],-1)),E(t("select",{id:"event-regional","onUpdate:modelValue":e[2]||(e[2]=a=>s.value.regional=a),required:""},[e[10]||(e[10]=t("option",{disabled:"",value:""},"Selecione uma regional",-1)),(l(),n(I,null,A(B,a=>t("option",{key:a,value:a},u(a),9,me)),64))],512),[[k,s.value.regional]])]),t("div",pe,[e[12]||(e[12]=t("label",{for:"event-date"},[p("Data do Evento "),t("span",{"aria-hidden":"true"},"*")],-1)),E(t("input",{type:"datetime-local",id:"event-date","onUpdate:modelValue":e[3]||(e[3]=a=>s.value.date=a),required:""},null,512),[[w,s.value.date]])]),t("div",Se,[e[14]||(e[14]=t("label",{for:"event-title"},[p("Título do Evento "),t("span",{"aria-hidden":"true"},"*")],-1)),E(t("select",{id:"event-title","onUpdate:modelValue":e[4]||(e[4]=a=>s.value.title=a),required:""},[e[13]||(e[13]=t("option",{disabled:"",value:""},"Selecione um título",-1)),(l(),n(I,null,A(F,a=>t("option",{key:a,value:a},u(a),9,fe)),64))],512),[[k,s.value.title]])]),t("div",Ee,[e[15]||(e[15]=t("label",{for:"event-desc"},"Descrição / Atendimento",-1)),E(t("input",{type:"text",id:"event-desc","onUpdate:modelValue":e[5]||(e[5]=a=>s.value.desc=a)},null,512),[[w,s.value.desc]])]),t("button",Ie,u($.value),1),c.value?(l(),n("button",{key:0,class:"warn",type:"button",onClick:_},"Cancelar")):O("",!0)],32)]),t("section",Ae,[y.value?(l(),n("div",ye,"Carregando eventos...")):g.value.length===0?(l(),n("div",he," Nenhum evento cadastrado. Comece adicionando um novo! ")):(l(),n("div",Oe,[(l(!0),n(I,null,A(P.value,(a,d)=>(l(),n("div",{key:d,class:"regional-group"},[t("h3",null,u(d),1),t("ul",be,[(l(!0),n(I,null,A(a,i=>(l(),n("li",{key:i.id,class:"event-item"},[t("p",null,u(new Date(i.date).toLocaleString("pt-BR")),1),t("p",null,[t("strong",null,u(i.title),1)]),i.desc?(l(),n("p",Re,u(i.desc),1)):O("",!0),t("div",De,[t("button",{class:"info",onClick:z=>G(i),"aria-label":"Editar evento: "+i.title},"Editar",8,_e),t("button",{class:"error",onClick:z=>q(i.id),"aria-label":"Cancelar pedido: "+i.title},"Cancelar",8,Ce)])]))),128))])]))),128))]))])])):(l(),n("div",Ne," Por favor, faça login para ver e gerenciar seus eventos. "))])]))}},Ue=H(ke,[["__scopeId","data-v-b0dd3f55"]]);export{Ue as default};
