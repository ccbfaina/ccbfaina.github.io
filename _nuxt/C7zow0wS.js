import{L as ue}from"./DzZZpedU.js";import{_ as ie,u as de,r as _,y as ce,g as ve,h as m,z as M,c as u,A as he,a as n,t as g,F as y,k as C,e as N,i as fe,B as pe,C as ge,o as r,n as w,p as H,D as q,b as be,w as me,l as ye,E as Ce,d as De}from"./DagaZP-C.js";const _e={key:1,class:"calendar-wrapper"},Ge={class:"calendar-header"},ke={class:"month-year"},Me={class:"calendar-table"},we=["onClick"],Te={class:"day-content"},Se={class:"day-number"},Ee={key:0,class:"event-indicators"},xe={class:"events-panel"},Ne={class:"events-list-container"},qe={class:"chips-container"},Ae={key:0,class:"las la-toggle-on"},Ue={key:1,class:"las la-toggle-off"},Fe=["onClick"],Re={key:0,class:"las la-toggle-on"},Ye={key:1,class:"las la-toggle-off"},$e={class:"chips-container"},ze=["onClick"],Be={key:0,class:"las la-toggle-on"},Le={key:1,class:"las la-toggle-off"},Pe={class:"search-container"},Oe={key:0},Xe={class:"event-date-title"},Ie={class:"events-list"},Ve={class:"sub-events-list"},Je=["innerHTML"],He={key:1,class:"no-events-message"},Q=50,Qe={__name:"agenda",setup(je){const{lista:D}=de(),b=ve(),A=_(!0),T=new Date,d=_(T.getMonth()),v=_(T.getFullYear()),c=_(null),s=ce({search:"",title:"",locale:"",date:"",start:"",end:"",enabledGroups:[],disabledGroups:[],enabledCalendars:[],disabledCalendars:[]});b.query?.regionais==="true"&&s.enabledCalendars.push("Regional Faina","Regional Goiânia","Regional Uruaçu","Regional Bom Jesus","Regional Catalão");function U(){return[]}const G=m(()=>Array.from(new Set(D.allEvents.map(e=>e.group))).filter(e=>e).sort((e,a)=>e.localeCompare(a))),j=m(()=>Array.from(new Set(D.calendars.map(e=>e.calendar))).filter(e=>e).sort((e,a)=>e.localeCompare(a)));M(G,e=>{if(!(b.query.groups&&b.query.groups.length>0)&&s.enabledGroups.length===0&&s.disabledGroups.length===0){const a=U(),t=U();a.length>0||t.length>0?(s.enabledGroups=a.filter(l=>e.includes(l)),s.disabledGroups=t.filter(l=>e.includes(l))):(s.enabledGroups=e.filter(l=>l!=="Rodízios"),s.disabledGroups=e.filter(l=>l==="Rodízios"))}},{immediate:!0}),M(j,e=>{b.query.calendars&&b.query.calendars.length>0||s.enabledCalendars.length===0&&s.disabledCalendars.length===0&&(s.enabledCalendars=[...e],s.disabledCalendars=[])},{immediate:!0}),M([()=>s.enabledGroups,()=>s.disabledGroups],()=>{},{deep:!0});const K=m(()=>{const e=[...s.enabledGroups,...s.disabledGroups];return Array.from(new Set(e)).sort((t,l)=>t.localeCompare(l))}),W=m(()=>{const e=[...s.enabledCalendars,...s.disabledCalendars];return Array.from(new Set(e)).sort((t,l)=>t.localeCompare(l))}),F=m(()=>s.enabledGroups.length===G.value.length);M(()=>D.allEvents,()=>{const e=b.query||{};if(["search","title","locale","date","start","end"].forEach(t=>{e[t]!==void 0&&(s[t]=e[t])}),e.groups){const t=Array.isArray(e.groups)?e.groups:e.groups.split(",").filter(Boolean);s.enabledGroups=t.filter(l=>G.value.includes(l)),s.disabledGroups=G.value.filter(l=>!t.includes(l))}if(e.calendars){const t=Array.isArray(e.calendars)?e.calendars:e.calendars.split(",").filter(Boolean);console.log("Calendários da URL:",t),s.enabledCalendars=t,s.disabledCalendars=[]}D.allEvents&&D.allEvents.length>0&&(A.value=!1)},{immediate:!0});function Z(e){s.enabledGroups.includes(e)?(s.enabledGroups=s.enabledGroups.filter(t=>t!==e),s.disabledGroups.push(e)):(s.disabledGroups=s.disabledGroups.filter(t=>t!==e),s.enabledGroups.push(e)),s.enabledGroups.sort((t,l)=>t.localeCompare(l)),s.disabledGroups.sort((t,l)=>t.localeCompare(l))}function ee(){F.value?(s.disabledGroups=[...G.value],s.enabledGroups=[]):(s.enabledGroups=[...G.value],s.disabledGroups=[])}function te(e){s.enabledCalendars.includes(e)?(s.enabledCalendars=s.enabledCalendars.filter(t=>t!==e),s.disabledCalendars.push(e)):(s.disabledCalendars=s.disabledCalendars.filter(t=>t!==e),s.enabledCalendars.push(e)),s.enabledCalendars.sort((t,l)=>t.localeCompare(l)),s.disabledCalendars.sort((t,l)=>t.localeCompare(l))}const S=m(()=>{const e=s.search.trim();let a=ge(D.allEvents||[],s);if(b.query.next==="true"){const l=new Date;a=a.filter(o=>new Date(o.date)>l)}return a=a.filter(l=>s.enabledGroups.includes(l.group)).filter(l=>s.enabledCalendars.includes(l.list)).filter(l=>!l.noDate),a}),R=m(()=>{let e;if(c.value){const t=c.value.date;e=S.value.filter(l=>{const o=new Date(l.date);return o.getUTCFullYear()===t.getFullYear()&&o.getUTCMonth()===t.getMonth()&&o.getUTCDate()===t.getDate()})}else e=S.value.filter(t=>{const l=new Date(t.date);return l.getUTCFullYear()===v.value&&l.getUTCMonth()===d.value});const a=new Map;for(const t of e){const o=new Date(t.date).toISOString().split("T")[0];a.has(o)||a.set(o,new Map);const h=a.get(o);h.has(t.title)||h.set(t.title,[]),h.get(t.title).push(t)}return Array.from(a.entries()).sort(([t],[l])=>new Date(t)-new Date(l))}),Y=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],ae=m(()=>`${Y[d.value]} ${v.value}`),$=m(()=>{const e=[],a=new Date(v.value,d.value,1).getDay(),t=new Date(v.value,d.value+1,0).getDate(),l=new Date(v.value,d.value,0).getDate();for(let i=a-1;i>=0;i--)e.push({dayNumber:l-i,date:new Date(v.value,d.value-1,l-i),isPrevMonth:!0,isNextMonth:!1,isToday:!1,hasEvent:!1,events:[]});for(let i=1;i<=t;i++){const p=new Date(v.value,d.value,i),f=S.value.filter(re=>{const x=new Date(re.date);return x.getUTCDate()===i&&x.getUTCMonth()===d.value&&x.getUTCFullYear()===v.value});e.push({dayNumber:i,date:p,isPrevMonth:!1,isNextMonth:!1,isToday:p.toDateString()===T.toDateString(),hasEvent:f.length>0,events:f})}const o=42-e.length;for(let i=1;i<=o;i++)e.push({dayNumber:i,date:new Date(v.value,d.value+1,i),isPrevMonth:!1,isNextMonth:!0,isToday:!1,hasEvent:!1,events:[]});const h=[];for(;e.length>0;)h.push(e.splice(0,7));return h});function se(e){const a=new Date(e),t=a.getUTCDate(),l=Y[a.getUTCMonth()],o=a.getUTCFullYear();return`${t} de ${l} de ${o}`}function k(e){d.value+=e,d.value<0?(d.value=11,v.value--):d.value>11&&(d.value=0,v.value++),c.value=null}function le(e){return{"prev-month-day":e.isPrevMonth||e.isNextMonth,today:e.isToday,"has-event":e.hasEvent,"selected-day":c.value&&e.date&&c.value.date&&c.value.date.toDateString()===e.date.toDateString()}}function z(e){console.log("Dia selecionado:",e),e.isPrevMonth?(k(-1),c.value={...e,date:new Date(v.value,d.value,e.dayNumber)}):e.isNextMonth?(k(1),c.value={...e,date:new Date(v.value,d.value,e.dayNumber)}):c.value&&c.value.date.toDateString()===e.date.toDateString()?c.value=null:c.value=e}if(b.query?.data){const e=$.value[0].find(a=>a.date?.toDateString()===new Date(b.query?.data+" 03:00:00")?.toDateString());e&&z(e)}function ne(e){return c.value?e.some(a=>{const t=new Date(a.date),l=c.value.date;return t.getUTCFullYear()===l.getFullYear()&&t.getUTCMonth()===l.getMonth()&&t.getUTCDate()===l.getDate()}):!1}function oe(e){const a=new Set;for(const t of e)t.group&&a.add(t.group);return[...a]}const B=["#d6b8c1","#d1c965","#cdb8d1","#aed4d7","#b3a9a5","#a9c6aa","#d39a8f","#b0a2cc","#d28fa9","#b2d29f","#d1b05e","#84c9cc","#d1be83","#92c2be","#a3b1b5","#bdc75d"],L={Reuniões:"#c4d7b9",Atendimentos:"#b4d0e3",Rodízios:"#e6b97f",Outros:"#c3bfe0"},E=_({});function P(e){if(L[e])return L[e];if(!E.value[e]){const t=Array.from(new Set(D.allEvents.map(l=>l.group).filter(l=>l!==null))).indexOf(e);E.value[e]=B[t%B.length]}return E.value[e]}function O(e){return{backgroundColor:P(e)}}const X=_(0),I=_(0);function V(e){X.value=e.touches?e.touches[0].clientX:e.clientX}function J(e){I.value=e.changedTouches?e.changedTouches[0].clientX:e.clientX;const a=I.value-X.value;a>Q?k(-1):a<-Q&&k(1)}return(e,a)=>{const t=ue,l=De;return r(),u("div",null,[A.value?(r(),he(t,{key:0})):(r(),u("div",_e,[n("div",{class:"calendar-panel",onTouchstart:V,onTouchend:J,onMousedown:V,onMouseup:J},[n("div",Ge,[n("i",{class:"las la-chevron-left",onClick:a[0]||(a[0]=o=>k(-1))}),n("h2",ke,g(ae.value),1),n("i",{class:"las la-chevron-right",onClick:a[1]||(a[1]=o=>k(1))})]),n("table",Me,[a[3]||(a[3]=n("thead",null,[n("tr",null,[n("th",null,"Dom"),n("th",null,"Seg"),n("th",null,"Ter"),n("th",null,"Qua"),n("th",null,"Qui"),n("th",null,"Sex"),n("th",null,"Sáb")])],-1)),n("tbody",null,[(r(!0),u(y,null,C($.value,(o,h)=>(r(),u("tr",{key:h},[(r(!0),u(y,null,C(o,i=>(r(),u("td",{key:i.date,class:w(le(i)),onClick:p=>z(i)},[n("div",Te,[n("div",Se,g(i.dayNumber),1),i.events.length?(r(),u("div",Ee,[(r(!0),u(y,null,C(oe(i.events),p=>(r(),u("span",{key:p,class:"event-indicator",style:q({backgroundColor:P(p)})},null,4))),128))])):H("",!0)])],10,we))),128))]))),128))])])],32),n("div",xe,[n("div",Ne,[a[6]||(a[6]=n("small",{style:{opacity:"0.8"}},"Grupos:",-1)),n("div",qe,[n("span",{class:"chip",onClick:ee},[F.value?(r(),u("i",Ae)):(r(),u("i",Ue)),a[4]||(a[4]=N(" Todos os Grupos ",-1))]),(r(!0),u(y,null,C(K.value,o=>(r(),u("span",{key:o,class:w(["chip",{"chip-disabled":s.disabledGroups.includes(o)}]),style:q(O(o)),onClick:h=>Z(o)},[s.enabledGroups.includes(o)?(r(),u("i",Re)):(r(),u("i",Ye)),N(" "+g(o),1)],14,Fe))),128))]),a[7]||(a[7]=n("small",{style:{opacity:"0.8"}},"Agenda(s):",-1)),n("div",$e,[(r(!0),u(y,null,C(W.value,o=>(r(),u("span",{key:o,class:w(["chip",{"chip-disabled":s.disabledCalendars.includes(o)}]),onClick:h=>te(o)},[s.enabledCalendars.includes(o)?(r(),u("i",Be)):(r(),u("i",Le)),N(" "+g(o),1)],10,ze))),128))]),n("div",Pe,[fe(n("input",{"onUpdate:modelValue":a[2]||(a[2]=o=>s.search=o),type:"text",placeholder:"Buscar eventos...",class:"search-input"},null,512),[[pe,s.search]]),a[5]||(a[5]=n("i",{class:"las la-search search-icon"},null,-1))]),Object.keys(R.value).length?(r(),u("div",Oe,[(r(!0),u(y,null,C(R.value,([o,h])=>(r(),u("div",{key:o},[n("h4",Xe,g(se(o)),1),n("ul",Ie,[(r(!0),u(y,null,C(h,([i,p])=>(r(),u("li",{key:i,class:w({"selected-event":ne(p)}),style:q(O(p[0].group))},[n("strong",null,g(i),1),n("ul",Ve,[(r(!0),u(y,null,C(p,f=>(r(),u("li",{key:f.id},[be(l,{to:{path:"/evento",query:{id:f.id}}},{default:me(()=>[n("p",null,[n("b",null,[n("i",null,g(f.formatTime)+g(f.formatTime?" - ":"")+g(f.formatDate),1)])]),n("p",null,g(f.locale),1),f.desc?(r(),u("p",{key:0,innerHTML:ye(Ce)(f.desc)},null,8,Je)):H("",!0)]),_:2},1032,["to"])]))),128))])],6))),128))])]))),128))])):(r(),u("p",He,"Nenhum evento agendado."))])])]))])}}},Ze=ie(Qe,[["__scopeId","data-v-55bf3c34"]]);export{Ze as default};
