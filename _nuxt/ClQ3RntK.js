import{L as at}from"./BLgmXT4i.js";import{_ as nt,r as _,y as M,u as ot,i as m,z as F,o as it,c as i,A as rt,F as y,a as e,q as p,p as h,t as r,j as f,v as A,B as C,l as g,I as U,f as V,h as ut,R as T,n as dt,X as ct,C as pt,b as o,Y as vt,D as ft,m as bt,E as mt}from"./BVHrepzW.js";import{d as yt}from"./BcZQbp_F.js";const gt={class:"tabs-container print-hide"},kt={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},_t=["aria-selected"],ht={class:"badge"},Ct=["aria-selected"],xt={class:"badge"},At=["aria-selected"],wt={class:"tab-content"},St={id:"tab-content-lista",role:"tabpanel"},Dt={class:"text-center"},Lt={key:0},Vt={key:1},Tt={key:2},$t={key:3},Ot={key:4},Et={id:"tab-content-filters",role:"tabpanel"},jt={class:"content"},qt={class:"form-inline"},It={class:"form-group"},Rt={class:"row"},zt={class:"form-group"},Bt={class:"row"},Mt=["value"],Ft={class:"form-group"},Ut={class:"row"},Gt=["value"],Nt={class:"form-group"},Pt={class:"flex gap-xs"},Ht={class:"form-group"},Yt={class:"flex gap-xs"},Wt={class:"form-group",style:{"align-items":"flex-start"}},Xt=["id","value"],Jt=["for"],Kt={class:"form-group",style:{"text-align":"right"}},Qt=["disabled"],Zt={class:"form-inline",style:{gap:"1rem","margin-top":"1rem"}},te={id:"tab-content-print",role:"tabpanel"},ee={class:"a4 print-hide"},se={class:"settings-list"},le={class:"settings-list"},ae=["onClick"],ne={key:0,class:"print-page print-layout"},oe={class:"table-wrapper"},ie={colspan:"5",class:"text-center",style:{"text-transform":"uppercase"}},re=["onDblclick"],ue={key:0,class:"nowrap"},de={key:0},ce=["innerHTML"],pe={__name:"calendar",setup(ve){ct(a=>({"0ba5d6f8":x.value}));const G=ut(),N=dt(),d=_("lista"),w=_(!1),x=_(1),l=M({search:"",title:"",locale:"",date:"",start:"",end:"",calendars:[]}),{$sw:P}=ot(),S=_([]),v=M({}),$=_([]),H=m(()=>({fontSize:`${x.value}rem`})),O=a=>a?.replace(/-$/,"").trim(),D=a=>{if(!a)return"";const t=a.split("T")[0];return t?t.split("-").reverse().join("/"):""},L=(a,t)=>Array.from(new Set(a.map(n=>n[t]).filter(n=>typeof n=="string"&&n.trim()))),Y=m(()=>L(b.value,"title")),W=m(()=>L(b.value,"locale")),X=m(()=>L(S.value,"list")),J=()=>{const a=G.query||{};["search","title","locale","date","start","end"].forEach(c=>{a[c]!==void 0&&(l[c]=a[c])}),a.calendars&&(l.calendars=Array.isArray(a.calendars)?a.calendars:a.calendars.split(",").filter(Boolean));const{today:n,future:s}=T();l.start||(l.start=n),l.end||(l.end=s)},E=yt(()=>{const a=Object.fromEntries(Object.entries(l).filter(([t,n])=>t==="calendars"?n.length:n!==""&&n!=null).map(([t,n])=>Array.isArray(n)?[t,n.join(",")]:[t,n]));N.replace({query:a})},200),K=()=>{E()};F(l,E,{deep:!0});function k(a){if(a==="calendars")l.calendars=[];else if(a==="date"){l.date="";const{today:t,future:n}=T();l.start=t,l.end=n}else if(a==="start"||a==="end"){const{today:t,future:n}=T();l.start=t,l.end=n}else l[a]=""}const b=m(()=>{const a=pt(S.value||[],l);return Array.from(new Set(a.map(n=>n.id))).map(n=>a.find(s=>s.id===n))}),Q=m(()=>{let a=0;return l.search&&a++,l.title&&a++,l.locale&&a++,l.date&&a++,l.calendars&&l.calendars.length>0&&a++,a}),Z=()=>{d.value="lista",setTimeout(()=>{window.print()},1e3)},j=m(()=>{if(!b.value||!b.value.length)return[];const a=b.value.filter(n=>!["AVISOS À IRMANDADE","NOVOS SERVOS PARA O MINISTÉRIO"].includes(n.title)),t=new Map;for(const n of a||[]){if(!n.date)continue;const s=new Date(n.date),c=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`,u=s.toLocaleDateString("pt-BR",{month:"long",year:"numeric"});t.has(c)||t.set(c,{month:u,items:[]}),t.get(c).items.push(n)}return Array.from(t.entries()).sort(([n],[s])=>n.localeCompare(s)).map(([n,{month:s,items:c}])=>({month:s,items:c.slice().sort((u,B)=>u.onDate-B.onDate)}))}),q=m(()=>{const a={};return b.value.forEach(t=>{const n=t.title||"Sem título";(a[n]||=[]).push(t)}),Object.keys(a).map(t=>({title:t}))}),I=()=>{const a=Array.from(new Set(b.value.map(t=>t.title||"Sem título")));$.value=a},R=()=>{if(!q.value)return;const a=q.value.map(t=>t.title);a.forEach(t=>{t in v||(v[t]=!0)});for(const t in v)a.includes(t)||(v[t]=!1)};it(async()=>{J();const{events:a}=await P.getEvents(l);S.value=a,I(),R()}),F(b,()=>{I(),R()});const tt=a=>{d.value="print",v[a]=!v[a]},z=m(()=>Object.values(v).length>0&&Object.values(v).every(Boolean)),et=a=>{for(const t in v)v[t]=a},st=m(()=>Object.values(v).filter(Boolean).length),lt=a=>{const t=`https://www.google.com/calendar/event?eid=${a.htmlLink}`;window.open(t,"_blank")};return(a,t)=>{const n=at;return o(),i("div",null,[w.value?(o(),rt(n,{key:0})):(o(),i(y,{key:1},[e("div",gt,[e("nav",kt,[e("span",{id:"tab-filters","aria-selected":d.value==="filters",role:"tab",type:"button",class:h(["tab",{active:d.value==="filters"}]),style:{position:"relative"},onClick:t[0]||(t[0]=s=>d.value="filters")},[e("span",ht,r(Q.value),1),t[18]||(t[18]=e("i",{class:"la la-filter z-10"},null,-1))],10,_t),e("span",{id:"tab-print","aria-selected":d.value==="print",role:"tab",type:"button",class:h(["tab",{active:d.value==="print"}]),onClick:t[1]||(t[1]=s=>d.value="print")},[e("span",xt,r(st.value),1),t[19]||(t[19]=e("i",{class:"la la-print"},null,-1))],10,Ct),e("span",{id:"tab-lista","aria-selected":d.value==="lista",role:"tab",type:"button",class:h(["tab",{active:d.value==="lista"}]),onClick:t[2]||(t[2]=s=>d.value="lista")}," Calendário ",10,At)])]),e("div",wt,[f(e("div",St,[e("div",Dt,[t[20]||(t[20]=e("div",null,"CALENDÁRIO",-1)),l.calendars.length?(o(),i("div",Lt,[e("b",null,r(l.calendars.map(O).join(", ")),1)])):p("",!0),l.locale?(o(),i("span",Vt,[e("b",null,r(O(l.locale)),1)])):p("",!0),l.date?(o(),i("span",Tt," Data: "+r(D(l.date)),1)):p("",!0),!l.date&&(l.start||l.end)?(o(),i("div",$t," Período: "+r(D(l.start))+" à "+r(D(l.end)),1)):p("",!0),l.search?(o(),i("div",Ot,r(l.search),1)):p("",!0)])],512),[[A,d.value==="lista"]]),f(e("div",Et,[e("div",jt,[e("div",qt,[e("div",null,[e("div",It,[t[21]||(t[21]=e("label",{for:"search"},"Pesquisar",-1)),e("div",Rt,[f(e("input",{id:"search","onUpdate:modelValue":t[3]||(t[3]=s=>l.search=s),type:"text",placeholder:"Buscar itens..."},null,512),[[C,l.search]]),l.search?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar pesquisa",type:"button",onClick:t[4]||(t[4]=s=>k("search"))}," × ")):p("",!0)])]),e("div",zt,[t[23]||(t[23]=e("label",{for:"title"},"Título",-1)),e("div",Bt,[f(e("select",{id:"title","onUpdate:modelValue":t[5]||(t[5]=s=>l.title=s)},[t[22]||(t[22]=e("option",{value:""},"Todos os títulos",-1)),(o(!0),i(y,null,g(Y.value,s=>(o(),i("option",{key:s,value:s},r(s),9,Mt))),128))],512),[[U,l.title]]),l.title?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar título",type:"button",onClick:t[6]||(t[6]=s=>k("title"))}," × ")):p("",!0)])]),e("div",Ft,[t[25]||(t[25]=e("label",{for:"locale"},"Local",-1)),e("div",Ut,[f(e("select",{id:"locale","onUpdate:modelValue":t[7]||(t[7]=s=>l.locale=s)},[t[24]||(t[24]=e("option",{value:""},"Todos os locais",-1)),(o(!0),i(y,null,g(W.value,s=>(o(),i("option",{key:s,value:s},r(s),9,Gt))),128))],512),[[U,l.locale]]),l.locale?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar local",type:"button",onClick:t[8]||(t[8]=s=>k("locale"))}," × ")):p("",!0)])]),e("div",Nt,[t[26]||(t[26]=e("label",{for:"date"},"Data",-1)),e("div",Pt,[f(e("input",{id:"date","onUpdate:modelValue":t[9]||(t[9]=s=>l.date=s),type:"date"},null,512),[[C,l.date]]),l.date?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar data",type:"button",onClick:t[10]||(t[10]=s=>k("date"))}," × ")):p("",!0)])]),e("div",Ht,[t[27]||(t[27]=e("label",null,"Intervalo de Datas",-1)),e("div",Yt,[f(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>l.start=s),type:"date"},null,512),[[C,l.start]]),f(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>l.end=s),type:"date"},null,512),[[C,l.end]]),l.start||l.end?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar datas",type:"button",onClick:t[13]||(t[13]=s=>k("date"))}," × ")):p("",!0)])])]),e("div",null,[e("div",Wt,[t[28]||(t[28]=e("label",null,"Agendas",-1)),e("div",null,[(o(!0),i(y,null,g(X.value,s=>(o(),i("div",{key:s},[f(e("input",{id:"cat-"+s,"onUpdate:modelValue":t[14]||(t[14]=c=>l.calendars=c),type:"checkbox",value:s,style:{margin:"5px 5px 0 0"}},null,8,Xt),[[vt,l.calendars]]),e("label",{for:"cat-"+s,style:{"margin-bottom":"0"}},r(s),9,Jt)]))),128))])]),e("div",Kt,[t[29]||(t[29]=e("label",null,null,-1)),e("button",{class:"success",disabled:w.value,onClick:t[15]||(t[15]=s=>K())},r(w.value?"Atualizando...":"Aplicar"),9,Qt)])])]),e("div",Zt,[e("span",null,[t[30]||(t[30]=e("i",{class:"la la-tasks"},null,-1)),V(" "+r(Array.isArray(b.value)?b.value.length:0),1)])])])],512),[[A,d.value==="filters"]]),f(e("div",te,[e("div",{class:"text-center flex col items-center gap-4"},[t[32]||(t[32]=e("b",{class:"mb-4 p"},"Ajustes de impressão:",-1)),e("div",{class:"p"},[e("button",{class:"success",onClick:Z},t[31]||(t[31]=[e("i",{class:"la la-print"},null,-1),V(" Imprimir ",-1)]))])]),e("div",ee,[e("div",se,[t[33]||(t[33]=e("b",null,"Tamanho da Fonte",-1)),f(e("input",{type:"range","onUpdate:modelValue":t[16]||(t[16]=s=>x.value=s),min:"0.8",max:"1.6",step:"0.1"},null,512),[[C,x.value]])]),e("div",le,[t[34]||(t[34]=e("b",null,"Lista",-1)),e("div",null,[e("i",{class:h(["la",z.value?"la-toggle-on":"la-toggle-off"]),title:"Ocultar todos",onClick:t[17]||(t[17]=s=>et(!z.value))},null,2)])]),(o(!0),i(y,null,g($.value,s=>(o(),i("div",{key:s,class:"settings-list print-hide",onClick:c=>tt(s)},[V(r(s)+" ",1),e("i",{class:h(["la",v[s]?"la-toggle-on":"la-toggle-off"]),title:"Alterar visibilidade"},null,2)],8,ae))),128))])],512),[[A,d.value==="print"]])]),j.value.length?(o(),i("div",ne,[(o(!0),i(y,null,g(j.value,({month:s,items:c})=>(o(),i("div",{key:s,class:"month-section"},[e("div",oe,[e("table",{style:ft(H.value)},[e("thead",null,[e("tr",null,[e("th",ie,r(s),1)])]),e("tbody",null,[(o(!0),i(y,null,g(c,u=>f((o(),i("tr",{key:u.id,onDblclick:B=>lt(u)},[e("td",null,[u.formatDate?(o(),i("span",ue,r(u.formatDate.split("/")[0])+" | "+r(u.formatWeek),1)):p("",!0)]),e("td",null,[u.formatTime?(o(),i("span",de,r(u.formatTime),1)):p("",!0)]),e("td",null,r(u.locale),1),e("td",null,r(u.title),1),e("td",null,[u.desc?(o(),i("span",{key:0,innerHTML:bt(mt)(u.desc)},null,8,ce)):p("",!0)])],40,re)),[[A,v[u.title||"Sem título"]]])),128))])],4)])]))),128))])):p("",!0)],64))])}}},ye=nt(pe,[["__scopeId","data-v-0dcaf4d3"]]);export{ye as default};
