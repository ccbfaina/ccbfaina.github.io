import{_ as E,u as F,r as m,y as P,j as _,o as V,z as w,c as u,a as o,k as p,B as x,H as j,t as n,s as D,F as L,n as S,i as I,p as U,b as c,f as v}from"#entry";import{d as C}from"./D0Dr7phT.js";const z={class:"page-relatorio"},O={class:"filters"},H={class:"form-group"},W={class:"form-group"},G={class:"form-group"},J={class:"row gap flex-end",style:{"justify-content":"flex-end","margin-bottom":"1em","align-items":"center"}},K=["disabled"],Q={class:"table-container"},X=["onClick"],Y={class:"cursor"},Z=["data-tooltip"],ee={key:0},oe={class:"row gap-xs text-center flex-end"},te=["disabled"],se=["disabled"],le={__name:"relatorio",setup(ne){const{$indexedDB:N}=F(),b=I(),M=U(),r=m([]),a=m(0),i=m(!1),e=P({nome:"",cidade:"",offset:0,limit:50}),k=_(()=>Math.floor(e.offset/e.limit)+1),R=_(()=>a.value?Math.ceil(a.value/e.limit):1),f=async()=>{i.value=!0;try{const s=await N.getRelatorio({nome:e.nome,cidade:e.cidade,locale:"",offset:e.offset,limit:e.limit});r.value=s?.items||[],a.value=s?.total||0}catch{r.value=[],a.value=0}finally{i.value=!1}},g=C(f,300),T=()=>{e.offset=0,d()},A=()=>{e.nome="",e.cidade="",e.offset=0,d()},y=()=>{if(typeof window>"u"||typeof document>"u")return;const s=document.querySelector(".content");s?typeof s.scrollTo=="function"?s.scrollTo({top:0,behavior:"smooth"}):s.scrollTop=0:typeof window.scrollTo=="function"&&window.scrollTo({top:0,behavior:"smooth"})},$=()=>{e.offset=Math.max(0,e.offset-e.limit),d(),y()},q=()=>{e.offset+e.limit<a.value&&(e.offset=e.offset+e.limit,d(),y())},d=C(()=>{const s=Object.fromEntries(Object.entries(e).filter(([,t])=>t!==""&&t!==0&&t!=null).map(([t,l])=>[t,Array.isArray(l)?l.join(","):String(l)]));M.replace({query:s}),g()},400),h=()=>{const s=b.query||{};e.nome=s.search||"",e.offset=s.offset&&parseInt(s.offset,10)||0,e.limit=s.limit&&parseInt(s.limit,10)||100};V(async()=>{h(),await f()}),w(()=>b.query,()=>{h(),f()}),w([()=>[e.nome,e.cidade],()=>e.limit,()=>e.offset],()=>{g()});const B=s=>{window.open(`https://www.google.com/maps/search/?api=1&query=CCB Congrega√ß√£o ${s.NomeLocalidade} ${s.NomeCidade} ${s.NomeEstado} ${s.NomePais}`,"_blank","noopener noreferrer")};return(s,t)=>(c(),u("div",z,[o("div",O,[o("div",H,[t[3]||(t[3]=o("label",{for:"search"},"Cidade",-1)),p(o("input",{id:"search","onUpdate:modelValue":t[0]||(t[0]=l=>e.cidade=l),type:"text",placeholder:"Cidade"},null,512),[[x,e.cidade]])]),o("div",W,[t[4]||(t[4]=o("label",{for:"search"},"Minist√©rio",-1)),p(o("input",{id:"search","onUpdate:modelValue":t[1]||(t[1]=l=>e.nome=l),type:"text",placeholder:"Nome"},null,512),[[x,e.nome]])]),o("div",G,[t[6]||(t[6]=o("label",null,"Resultados por p√°gina",-1)),p(o("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>e.limit=l)},[...t[5]||(t[5]=[o("option",{value:50},"50",-1),o("option",{value:100},"100",-1),o("option",{value:200},"200",-1)])],512),[[j,e.limit,void 0,{number:!0}]])])]),o("div",J,[o("small",null,"Total: "+n(a.value),1),o("button",{class:"success",disabled:i.value,onClick:T},n(i.value?"Aguarde...":"Aplicar"),9,K),o("button",{onClick:A},"Limpar")]),o("div",Q,[o("table",null,[t[10]||(t[10]=o("thead",null,[o("tr",null,[o("th",null,"Local"),o("th",null,"Minist√©rio"),o("th",null,"Endere√ßo")])],-1)),o("tbody",null,[(c(!0),u(L,null,S(r.value,l=>(c(),u("tr",{key:l.Codigo,onClick:ae=>B(l)},[o("td",Y,[v(n(l.NomeCidade)+" ",1),t[7]||(t[7]=o("br",null,null,-1)),v(" üìç "+n(l.NomeLocalidade)+" ",1),t[8]||(t[8]=o("br",null,null,-1)),v(" üåê "+n(l.NomeEstado),1)]),o("td",null,n(l.CargoNome)+" "+n(l.Nome),1),o("td",{class:"tooltip","data-tooltip":`ADM: ${l.NomeADM} 
RRM: ${l.NomeRRM}`},n(l.Endereco),9,Z)],8,X))),128)),!r.value.length&&!i.value?(c(),u("tr",ee,[...t[9]||(t[9]=[o("td",{colspan:"6"},"Nenhum registro encontrado.",-1)])])):D("",!0)])])]),o("div",oe,[o("small",null,"P√°gina: "+n(k.value)+" / "+n(R.value),1),o("button",{disabled:e.offset===0,onClick:$},"Anterior",8,te),o("button",{disabled:e.offset+e.limit>=a.value,onClick:q},"Pr√≥xima",8,se)])]))}},de=E(le,[["__scopeId","data-v-aa60ad0f"]]);export{de as default};
