import{L as it}from"./DwxQmGVX.js";import{_ as rt,u as ut,r as y,y as K,h as b,f as W,z as V,Q as dt,c as i,A as Q,l as x,F as g,a as e,p,n as k,t as u,i as c,v as z,D as I,B as q,k as _,I as J,e as L,g as pt,R as O,m as vt,C as ct,o,S as ft,K as X,E as mt}from"./DrK86HzD.js";import{a as bt,S as gt,E as yt}from"./Bf6xU37T.js";import{d as kt}from"./BcZQbp_F.js";const _t={class:"tabs-container print-hide"},Dt={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},ht=["aria-selected"],Ct={class:"badge"},St=["aria-selected"],Tt={class:"badge"},xt=["aria-selected"],Et={class:"tab-content"},At={id:"tab-content-lista",role:"tabpanel"},$t={key:0},qt={key:1},Lt={key:2},Vt={key:3},zt={key:4},wt={id:"tab-content-filters",role:"tabpanel"},jt={class:"content"},It={class:"form-inline"},Ot={class:"form-group"},Bt={class:"row"},Ut={class:"form-group"},Ft={class:"row"},Gt=["value"],Mt={class:"form-group"},Rt={class:"row"},Nt=["value"],Pt={class:"form-group"},Ht={class:"flex gap-xs"},Kt={class:"form-group"},Wt={class:"flex gap-xs"},Qt={class:"form-group",style:{"align-items":"flex-start"}},Jt=["id","value"],Xt=["for"],Yt={class:"form-group",style:{"text-align":"right"}},Zt=["disabled"],te={class:"form-inline",style:{gap:"1rem","margin-top":"1rem"}},ee={id:"tab-content-print",role:"tabpanel"},le={class:"a4 print-hide"},se={class:"settings-list"},ne={id:"fontSteps"},ae=["value"],oe={class:"settings-list print-hide"},ie=["onDragstart","onDragover","onDrop","onClick"],re={key:0,class:"print-page"},ue=["onDragstart","onDragover","onDrop"],de={colspan:"5"},pe={class:"flex items-center aling-center justify-center"},ve=["onClick"],ce={key:0},fe={key:0},me={key:0},be=["innerHTML"],ge={__name:"index",setup(ye){const{lista:D}=ut(),v=y("lista"),n=K({search:"",title:"",locale:"",date:"",start:"",end:"",calendars:[]}),h=y(1),w=pt(),B=vt(),U=y(!1),Y=()=>{const s=w.query||{};["search","title","locale","date","start","end"].forEach(r=>{s[r]!==void 0&&(n[r]=s[r])}),s.calendars&&(n.calendars=Array.isArray(s.calendars)?s.calendars:s.calendars.split(",").filter(Boolean));const{today:a,future:l}=O();n.start||(n.start=a),n.end||(n.end=l)},F=kt(()=>{const s=Object.fromEntries(Object.entries(n).filter(([t,a])=>t==="calendars"?a.length:a!==""&&a!=null).map(([t,a])=>Array.isArray(a)?[t,a.join(",")]:[t,a]));B.replace({query:s})},200),C=b(()=>{const s=ct(D.allEvents||[],n);return Array.from(new Set(s.map(a=>a.id))).map(a=>s.find(l=>l.id===a))});function Z(){F()}W(()=>{Y()}),V([n,h],F,{deep:!0});function E(s){if(s==="calendars")n.calendars=[];else if(s==="date"){n.date="";const{today:t,future:a}=O();n.start=t,n.end=a}else if(s==="start"||s==="end"){const{today:t,future:a}=O();n.start=t,n.end=a}else n[s]=""}function j(s,t){return Array.from(new Set(s.map(a=>a[t]).filter(a=>typeof a=="string"&&a.trim())))}const tt=b(()=>j(C.value,"title")),et=b(()=>j(C.value,"locale")),lt=b(()=>j(D.allEvents,"list")),S=y([]);V(C,s=>{const t=Array.from(new Set(s.map(r=>r.title||"Sem título"))),l=(w.query.order?.split(",").filter(Boolean)||[]).filter(r=>t.includes(r));t.forEach(r=>{l.includes(r)||l.push(r)}),S.value=l},{immediate:!0}),V(S,s=>{const t={...w.query};s&&s.length>0?t.order=s.join(","):delete t.order,B.replace({query:t})});const m=b(()=>{const s={};return C.value.forEach(t=>{const a=t.title||"Sem título";(s[a]||=[]).push(t)}),S.value.filter(t=>s[t]).map(t=>({title:t,items:s[t].slice().sort((a,l)=>a.onDate&&l.onDate?a.onDate-l.onDate:0)}))}),G=s=>s?.replace(/-$/,"")?.trim(),st=b(()=>{let s=0;return n.search&&s++,n.title&&s++,n.locale&&s++,n.date&&s++,n.calendars&&n.calendars.length>0&&s++,s}),nt=()=>{v.value="lista",setTimeout(()=>{window.print()},1e3)},T=y(null),A=y(null),M=s=>{T.value=s},R=s=>{A.value=s},N=s=>{if(T.value===null||T.value===s){T.value=null,A.value=null;return}const t=[...S.value],[a]=t.splice(T.value,1);t.splice(s,0,a),S.value=t,T.value=null,A.value=null},f=K({});V(m,()=>{if(!m.value)return;const s=m.value.map(t=>t.title);s.forEach(t=>{t in f||(f[t]=!0)});for(const t in f)s.includes(t)||delete f[t]},{immediate:!0});const P=s=>{v.value="print",f[s]=!f[s]},H=b(()=>m.value.length>0&&m.value.every(s=>f[s.title])),at=s=>{m.value.forEach(t=>{f[t.title]=s})},$=y(null),ot=b(()=>Object.values(f).filter(Boolean).length);return W(()=>{$.value=new bt({extensions:[gt],content:`
      <p>Oração Santa Ceia</p>
      <p><strong>Pão:</strong> "Senhor, abençoa este Pão que vamos comer, que é a comunhão do Corpo de Cristo."</p>
      <p><strong>Cálice:</strong> "Senhor, abençoa o Cálice que vamos beber, que é a comunhão do Sangue de Cristo."</p>
    `,editable:!0})}),dt(()=>{$.value&&$.value.destroy()}),(s,t)=>{const a=it;return o(),i("div",null,[x(D).loading?(o(),Q(a,{key:0})):(o(),i(g,{key:1},[e("div",_t,[e("nav",Dt,[e("span",{id:"tab-filters","aria-selected":v.value==="filters",role:"tab",type:"button",class:k(["tab",{active:v.value==="filters"}]),style:{position:"relative"},onClick:t[0]||(t[0]=l=>v.value="filters")},[e("span",Ct,u(st.value),1),t[18]||(t[18]=e("i",{class:"la la-filter z-10"},null,-1))],10,ht),e("span",{id:"tab-print","aria-selected":v.value==="print",role:"tab",type:"button",class:k(["tab",{active:v.value==="print"}]),onClick:t[1]||(t[1]=l=>v.value="print")},[e("span",Tt,u(ot.value),1),t[19]||(t[19]=e("i",{class:"la la-print"},null,-1))],10,St),e("span",{id:"tab-lista","aria-selected":v.value==="lista",role:"tab",type:"button",class:k(["tab",{active:v.value==="lista"}]),onClick:t[2]||(t[2]=l=>v.value="lista")}," Lista ",10,xt)])]),e("div",null,[e("div",Et,[c(e("div",At,[e("div",{class:"text-center",style:I({fontSize:h.value+"em"})},[t[20]||(t[20]=e("div",null,"LISTA DE ATENDIMENTO E DIVERSOS",-1)),n.calendars.length?(o(),i("div",$t,[e("b",null,u(n.calendars.map(G).join(", ")),1)])):p("",!0),n.locale?(o(),i("span",qt,[e("b",null,u(G(n.locale)),1)])):p("",!0),n.date?(o(),i("span",Lt," Data: "+u(n.date?.split("T")[0]?.split("-")?.reverse()?.join("/")),1)):p("",!0),!n.date&&(n.start||n.end)?(o(),i("div",Vt," Período: "+u(n.start?.split("T")[0]?.split("-")?.reverse()?.join("/"))+" à "+u(n.end?.split("T")[0]?.split("-")?.reverse()?.join("/")),1)):p("",!0),n.search?(o(),i("div",zt,u(n.search),1)):p("",!0)],4)],512),[[z,v.value==="lista"]]),c(e("div",wt,[e("div",jt,[e("div",It,[e("div",null,[e("div",Ot,[t[21]||(t[21]=e("label",{for:"search"},"Pesquisar",-1)),e("div",Bt,[c(e("input",{id:"search","onUpdate:modelValue":t[3]||(t[3]=l=>n.search=l),type:"text",placeholder:"Buscar itens..."},null,512),[[q,n.search]]),n.search?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar pesquisa",type:"button",onClick:t[4]||(t[4]=l=>E("search"))}," × ")):p("",!0)])]),e("div",Ut,[t[23]||(t[23]=e("label",{for:"title"},"Título",-1)),e("div",Ft,[c(e("select",{id:"title","onUpdate:modelValue":t[5]||(t[5]=l=>n.title=l)},[t[22]||(t[22]=e("option",{value:""},"Todos os títulos",-1)),(o(!0),i(g,null,_(tt.value,l=>(o(),i("option",{key:l,value:l},u(l),9,Gt))),128))],512),[[J,n.title]]),n.title?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar título",type:"button",onClick:t[6]||(t[6]=l=>E("title"))}," × ")):p("",!0)])]),e("div",Mt,[t[25]||(t[25]=e("label",{for:"locale"},"Local",-1)),e("div",Rt,[c(e("select",{id:"locale","onUpdate:modelValue":t[7]||(t[7]=l=>n.locale=l)},[t[24]||(t[24]=e("option",{value:""},"Todos os locais",-1)),(o(!0),i(g,null,_(et.value,l=>(o(),i("option",{key:l,value:l},u(l),9,Nt))),128))],512),[[J,n.locale]]),n.locale?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar local",type:"button",onClick:t[8]||(t[8]=l=>E("locale"))}," × ")):p("",!0)])]),e("div",Pt,[t[26]||(t[26]=e("label",{for:"date"},"Data",-1)),e("div",Ht,[c(e("input",{id:"date","onUpdate:modelValue":t[9]||(t[9]=l=>n.date=l),type:"date"},null,512),[[q,n.date]]),n.date?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar data",type:"button",onClick:t[10]||(t[10]=l=>E("date"))}," × ")):p("",!0)])]),e("div",Kt,[t[27]||(t[27]=e("label",null,"Intervalo de Datas",-1)),e("div",Wt,[c(e("input",{"onUpdate:modelValue":t[11]||(t[11]=l=>n.start=l),type:"date"},null,512),[[q,n.start]]),c(e("input",{"onUpdate:modelValue":t[12]||(t[12]=l=>n.end=l),type:"date"},null,512),[[q,n.end]]),n.start||n.end?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar datas",type:"button",onClick:t[13]||(t[13]=l=>E("date"))}," × ")):p("",!0)])])]),e("div",null,[e("div",Qt,[t[28]||(t[28]=e("label",null,"Agendas",-1)),e("div",null,[(o(!0),i(g,null,_(lt.value,l=>(o(),i("div",{key:l},[c(e("input",{id:"cat-"+l,"onUpdate:modelValue":t[14]||(t[14]=r=>n.calendars=r),type:"checkbox",value:l,style:{margin:"5px 5px 0 0"}},null,8,Jt),[[ft,n.calendars]]),e("label",{for:"cat-"+l,style:{"margin-bottom":"0"}},u(l),9,Xt)]))),128))])]),e("div",Yt,[t[29]||(t[29]=e("label",null,null,-1)),e("button",{class:"success",disabled:U.value||x(D).loading,onClick:t[15]||(t[15]=l=>Z())},u(U.value||x(D).loading?"Atualizando...":"Aplicar"),9,Zt)])])]),e("div",te,[e("span",null,[t[30]||(t[30]=e("i",{class:"la la-calendar-check"},null,-1)),L(" "+u(x(D)?.calendars?.length||0),1)]),e("span",null,[t[31]||(t[31]=e("i",{class:"la la-tasks"},null,-1)),L(" "+u(Array.isArray(C.value)?C.value.length:0),1)])])])],512),[[z,v.value==="filters"]]),c(e("div",ee,[e("div",{class:"text-center flex col items-center gap-4"},[t[33]||(t[33]=e("b",{class:"mb-4 p"},"Ajustes de impressão:",-1)),e("div",{class:"p"},[e("button",{class:"success",onClick:nt},t[32]||(t[32]=[e("i",{class:"la la-print"},null,-1),L(" Imprimir ",-1)]))])]),e("div",le,[e("div",se,[t[34]||(t[34]=e("b",null,"Tamanho da Fonte",-1)),c(e("input",{id:"fontSizeSlider",type:"range","onUpdate:modelValue":t[16]||(t[16]=l=>h.value=l),min:"0.5",max:"1.6",step:"0.05",list:"fontSteps"},null,512),[[q,h.value,void 0,{number:!0}]]),e("datalist",ne,[(o(),i(g,null,_(15,l=>e("option",{key:l,value:(l*.1).toFixed(1)},null,8,ae)),64))])]),e("div",oe,[t[35]||(t[35]=e("b",null,"Lista",-1)),e("div",null,[e("i",{class:k(["la",H.value?"la-toggle-on":"la-toggle-off"]),title:"Ocultar todos",onClick:t[17]||(t[17]=l=>at(!H.value))},null,2)])]),(o(!0),i(g,null,_(S.value,(l,r)=>(o(),i("div",{key:l,class:k(["settings-list print-hide",{"drag-over":A.value===r}]),draggable:"true",onDragstart:d=>M(r),onDragover:X(d=>R(r),["prevent"]),onDrop:d=>N(r),onClick:d=>P(l)},[L(u(l)+" ",1),e("i",{class:k(["la",f[l]?"la-toggle-on":"la-toggle-off"]),title:"Alterar visibilidade"},null,2)],42,ie))),128))])],512),[[z,v.value==="print"]])])]),m.value.length?(o(),i("div",re,[(o(!0),i(g,null,_(m.value,(l,r)=>c((o(),i("div",{key:l.title,class:k(["table-list",{"drag-over":A.value===r}]),draggable:"true",style:{cursor:"move"},onDragstart:d=>M(r),onDragover:X(d=>R(r),["prevent"]),onDrop:d=>N(r)},[e("div",{class:"table-container",style:I({fontSize:h.value+"em"})},[e("table",null,[e("thead",null,[e("tr",null,[e("th",de,[e("div",pe,[L(u(l.title)+" ",1),e("i",{class:"la la-toggle-on print-hide",style:{cursor:"pointer"},onClick:d=>P(l.title)},null,8,ve)])])])]),e("tbody",null,[(o(!0),i(g,null,_(l.items,d=>(o(),i("tr",{key:d.id},[e("td",null,[d.formatDate?(o(),i("span",ce,u(d.formatDate),1)):p("",!0)]),e("td",null,[d.formatWeek?(o(),i("span",fe,u(d.formatWeek),1)):p("",!0)]),e("td",null,[d.formatTime?(o(),i("span",me,u(d.formatTime),1)):p("",!0)]),e("td",null,u(d.locale),1),e("td",null,[d.desc?(o(),i("span",{key:0,innerHTML:x(mt)(d.desc)},null,8,be)):p("",!0)])]))),128))])])],4)],42,ue)),[[z,f[l.title]]])),128)),$.value?(o(),Q(x(yt),{key:0,editor:$.value,class:"editable",style:I({fontSize:h.value+"em"})},null,8,["editor","style"])):p("",!0)])):p("",!0)],64))])}}},Se=rt(ge,[["__scopeId","data-v-718345ef"]]);export{Se as default};
