import{L as ot}from"./Cojtx5tD.js";import{_ as it,y as rt,r as D,I as R,h as y,f as U,B as N,c as i,C as ut,p as x,F as g,a as e,m as c,n as A,t as r,i as b,v as S,A as w,k as C,G as H,e as T,g as dt,Q as O,l as ct,W as pt,R as vt,o,H as ft,O as bt,K as mt}from"./B9qtw-Ye.js";import{d as yt}from"./BcZQbp_F.js";const gt={class:"tabs-container print-hide"},kt={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},_t=["aria-selected"],Ct={class:"badge"},ht=["aria-selected"],xt={class:"badge"},At=["aria-selected"],wt={class:"tab-content"},Lt={id:"tab-content-lista",role:"tabpanel"},Dt={class:"text-center"},St={key:0},Tt={key:1},Vt={key:2},$t={key:3},Ot={key:4},jt={id:"tab-content-filters",role:"tabpanel"},qt={class:"content"},Bt={class:"form-inline"},Et={class:"form-group"},zt={class:"row"},Mt={class:"form-group"},Ft={class:"row"},Gt=["value"],It={class:"form-group"},Rt={class:"row"},Ut=["value"],Nt={class:"form-group"},Ht={class:"flex gap-xs"},Pt={class:"form-group"},Wt={class:"flex gap-xs"},Kt={class:"form-group",style:{"align-items":"flex-start"}},Qt=["id","value"],Yt=["for"],Jt={class:"form-group",style:{"text-align":"right"}},Xt=["disabled"],Zt={class:"form-inline",style:{gap:"1rem","margin-top":"1rem"}},te={id:"tab-content-print",role:"tabpanel"},ee={class:"a4 print-hide"},se={class:"settings-list"},le={class:"settings-list"},ne=["onClick"],ae={key:0,class:"print-page print-layout"},oe={colspan:"5",class:"text-center",style:{"text-transform":"uppercase"}},ie=["onDblclick"],re={key:0,class:"nowrap"},ue={key:0},de=["innerHTML"],ce={__name:"calendar",setup(pe){pt(l=>({"44ac113b":L.value}));const{lista:k}=rt(),P=dt(),W=ct(),u=D("lista"),j=D(!1),L=D(1),s=R({search:"",title:"",locale:"",date:"",start:"",end:"",calendars:[]}),p=R({}),q=D([]),K=y(()=>({fontSize:`${L.value}rem`})),B=l=>l==null?void 0:l.replace(/-$/,"").trim(),V=l=>{if(!l)return"";const t=l.split("T")[0];return t?t.split("-").reverse().join("/"):""},$=(l,t)=>Array.from(new Set(l.map(a=>a[t]).filter(a=>typeof a=="string"&&a.trim()))),Q=y(()=>$(m.value,"title")),Y=y(()=>$(m.value,"locale")),J=y(()=>$(k.allEvents,"list")),X=()=>{const l=P.query||{};["search","title","locale","date","start","end"].forEach(v=>{l[v]!==void 0&&(s[v]=l[v])}),l.calendars&&(s.calendars=Array.isArray(l.calendars)?l.calendars:l.calendars.split(",").filter(Boolean));const{today:a,future:d}=O();s.start||(s.start=a),s.end||(s.end=d)},E=yt(()=>{const l=Object.fromEntries(Object.entries(s).filter(([t,a])=>t==="calendars"?a.length:a!==""&&a!=null).map(([t,a])=>Array.isArray(a)?[t,a.join(",")]:[t,a]));W.replace({query:l})},200),Z=()=>{E()};U(()=>{X()}),N(s,E,{deep:!0});function h(l){if(l==="calendars")s.calendars=[];else if(l==="date"){s.date="";const{today:t,future:a}=O();s.start=t,s.end=a}else if(l==="start"||l==="end"){const{today:t,future:a}=O();s.start=t,s.end=a}else s[l]=""}const m=y(()=>{const l=vt(k.allEvents||[],s);return Array.from(new Set(l.map(a=>a.id))).map(a=>l.find(d=>d.id===a))}),tt=y(()=>{let l=0;return s.search&&l++,s.title&&l++,s.locale&&l++,s.date&&l++,s.calendars&&s.calendars.length>0&&l++,l}),et=()=>{u.value="lista",setTimeout(()=>{window.print()},1e3)},z=y(()=>{if(!m.value||!m.value.length)return[];const l=m.value.filter(a=>!["AVISOS À IRMANDADE"].includes(a.title)),t=new Map;for(const a of l||[]){if(!a.date)continue;const d=new Date(a.date),v=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}`,n=d.toLocaleDateString("pt-BR",{month:"long",year:"numeric"});t.has(v)||t.set(v,{month:n,items:[]}),t.get(v).items.push(a)}return Array.from(t.entries()).sort(([a],[d])=>a.localeCompare(d)).map(([a,{month:d,items:v}])=>({month:d,items:v.slice().sort((n,_)=>n.onDate-_.onDate)}))}),M=y(()=>{const l={};return m.value.forEach(t=>{const a=t.title||"Sem título";(l[a]||(l[a]=[])).push(t)}),Object.keys(l).map(t=>({title:t}))}),F=()=>{const l=Array.from(new Set(m.value.map(t=>t.title||"Sem título")));q.value=l},G=()=>{if(!M.value)return;const l=M.value.map(t=>t.title);l.forEach(t=>{t in p||(p[t]=!0)});for(const t in p)l.includes(t)||delete p[t]};U(()=>{F(),G()}),N(m,()=>{F(),G()});const st=l=>{u.value="print",p[l]=!p[l]},I=y(()=>Object.values(p).length>0&&Object.values(p).every(Boolean)),lt=l=>{for(const t in p)p[t]=l},nt=y(()=>Object.values(p).filter(Boolean).length),at=l=>{const t=`https://www.google.com/calendar/event?eid=${l.htmlLink}`;window.open(t,"_blank")};return(l,t)=>{var d,v;const a=ot;return o(),i("div",null,[x(k).loading?(o(),ut(a,{key:0})):(o(),i(g,{key:1},[e("div",gt,[e("nav",kt,[e("span",{id:"tab-filters","aria-selected":u.value==="filters",role:"tab",type:"button",class:A(["tab",{active:u.value==="filters"}]),style:{position:"relative"},onClick:t[0]||(t[0]=n=>u.value="filters")},[e("span",Ct,r(tt.value),1),t[18]||(t[18]=e("i",{class:"la la-filter z-10"},null,-1))],10,_t),e("span",{id:"tab-print","aria-selected":u.value==="print",role:"tab",type:"button",class:A(["tab",{active:u.value==="print"}]),onClick:t[1]||(t[1]=n=>u.value="print")},[e("span",xt,r(nt.value),1),t[19]||(t[19]=e("i",{class:"la la-print"},null,-1))],10,ht),e("span",{id:"tab-lista","aria-selected":u.value==="lista",role:"tab",type:"button",class:A(["tab",{active:u.value==="lista"}]),onClick:t[2]||(t[2]=n=>u.value="lista")}," Calendário ",10,At)])]),e("div",wt,[b(e("div",Lt,[e("div",Dt,[t[20]||(t[20]=e("div",null,"CALENDÁRIO",-1)),s.calendars.length?(o(),i("div",St,[e("b",null,r(s.calendars.map(B).join(", ")),1)])):c("",!0),s.locale?(o(),i("span",Tt,[e("b",null,r(B(s.locale)),1)])):c("",!0),s.date?(o(),i("span",Vt," Data: "+r(V(s.date)),1)):c("",!0),!s.date&&(s.start||s.end)?(o(),i("div",$t," Período: "+r(V(s.start))+" à "+r(V(s.end)),1)):c("",!0),s.search?(o(),i("div",Ot,r(s.search),1)):c("",!0)])],512),[[S,u.value==="lista"]]),b(e("div",jt,[e("div",qt,[e("div",Bt,[e("div",null,[e("div",Et,[t[21]||(t[21]=e("label",{for:"search"},"Pesquisar",-1)),e("div",zt,[b(e("input",{id:"search","onUpdate:modelValue":t[3]||(t[3]=n=>s.search=n),type:"text",placeholder:"Buscar itens..."},null,512),[[w,s.search]]),s.search?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar pesquisa",type:"button",onClick:t[4]||(t[4]=n=>h("search"))}," × ")):c("",!0)])]),e("div",Mt,[t[23]||(t[23]=e("label",{for:"title"},"Título",-1)),e("div",Ft,[b(e("select",{id:"title","onUpdate:modelValue":t[5]||(t[5]=n=>s.title=n)},[t[22]||(t[22]=e("option",{value:""},"Todos os títulos",-1)),(o(!0),i(g,null,C(Q.value,n=>(o(),i("option",{key:n,value:n},r(n),9,Gt))),128))],512),[[H,s.title]]),s.title?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar título",type:"button",onClick:t[6]||(t[6]=n=>h("title"))}," × ")):c("",!0)])]),e("div",It,[t[25]||(t[25]=e("label",{for:"locale"},"Local",-1)),e("div",Rt,[b(e("select",{id:"locale","onUpdate:modelValue":t[7]||(t[7]=n=>s.locale=n)},[t[24]||(t[24]=e("option",{value:""},"Todos os locais",-1)),(o(!0),i(g,null,C(Y.value,n=>(o(),i("option",{key:n,value:n},r(n),9,Ut))),128))],512),[[H,s.locale]]),s.locale?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar local",type:"button",onClick:t[8]||(t[8]=n=>h("locale"))}," × ")):c("",!0)])]),e("div",Nt,[t[26]||(t[26]=e("label",{for:"date"},"Data",-1)),e("div",Ht,[b(e("input",{id:"date","onUpdate:modelValue":t[9]||(t[9]=n=>s.date=n),type:"date"},null,512),[[w,s.date]]),s.date?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar data",type:"button",onClick:t[10]||(t[10]=n=>h("date"))}," × ")):c("",!0)])]),e("div",Pt,[t[27]||(t[27]=e("label",null,"Intervalo de Datas",-1)),e("div",Wt,[b(e("input",{"onUpdate:modelValue":t[11]||(t[11]=n=>s.start=n),type:"date"},null,512),[[w,s.start]]),b(e("input",{"onUpdate:modelValue":t[12]||(t[12]=n=>s.end=n),type:"date"},null,512),[[w,s.end]]),s.start||s.end?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar datas",type:"button",onClick:t[13]||(t[13]=n=>h("date"))}," × ")):c("",!0)])])]),e("div",null,[e("div",Kt,[t[28]||(t[28]=e("label",null,"Agendas",-1)),e("div",null,[(o(!0),i(g,null,C(J.value,n=>(o(),i("div",{key:n},[b(e("input",{id:"cat-"+n,"onUpdate:modelValue":t[14]||(t[14]=_=>s.calendars=_),type:"checkbox",value:n,style:{margin:"5px 5px 0 0"}},null,8,Qt),[[ft,s.calendars]]),e("label",{for:"cat-"+n,style:{"margin-bottom":"0"}},r(n),9,Yt)]))),128))])]),e("div",Jt,[t[29]||(t[29]=e("label",null,null,-1)),e("button",{class:"success",disabled:j.value||x(k).loading,onClick:t[15]||(t[15]=n=>Z())},r(j.value||x(k).loading?"Atualizando...":"Aplicar"),9,Xt)])])]),e("div",Zt,[e("span",null,[t[30]||(t[30]=e("i",{class:"la la-calendar-check"},null,-1)),T(" "+r(((v=(d=x(k))==null?void 0:d.calendars)==null?void 0:v.length)||0),1)]),e("span",null,[t[31]||(t[31]=e("i",{class:"la la-tasks"},null,-1)),T(" "+r(Array.isArray(m.value)?m.value.length:0),1)])])])],512),[[S,u.value==="filters"]]),b(e("div",te,[e("div",{class:"text-center flex col items-center gap-4"},[t[33]||(t[33]=e("b",{class:"mb-4 p"},"Ajustes de impressão:",-1)),e("div",{class:"p"},[e("button",{class:"success",onClick:et},t[32]||(t[32]=[e("i",{class:"la la-print"},null,-1),T(" Imprimir ")]))])]),e("div",ee,[e("div",se,[t[34]||(t[34]=e("b",null,"Tamanho da Fonte",-1)),b(e("input",{type:"range","onUpdate:modelValue":t[16]||(t[16]=n=>L.value=n),min:"0.8",max:"1.6",step:"0.1"},null,512),[[w,L.value]])]),e("div",le,[t[35]||(t[35]=e("b",null,"Lista",-1)),e("div",null,[e("i",{class:A(["la",I.value?"la-toggle-on":"la-toggle-off"]),title:"Ocultar todos",onClick:t[17]||(t[17]=n=>lt(!I.value))},null,2)])]),(o(!0),i(g,null,C(q.value,n=>(o(),i("div",{key:n,class:"settings-list print-hide",onClick:_=>st(n)},[T(r(n)+" ",1),e("i",{class:A(["la",p[n]?"la-toggle-on":"la-toggle-off"]),title:"Alterar visibilidade"},null,2)],8,ne))),128))])],512),[[S,u.value==="print"]])]),z.value.length?(o(),i("div",ae,[(o(!0),i(g,null,C(z.value,({month:n,items:_})=>(o(),i("div",{key:n,class:"month-section"},[e("table",{style:mt(K.value)},[e("thead",null,[e("tr",null,[e("th",oe,r(n),1)])]),e("tbody",null,[(o(!0),i(g,null,C(_,f=>b((o(),i("tr",{key:f.id,onDblclick:ve=>at(f)},[e("td",null,[f.formatDate?(o(),i("span",re,r(f.formatDate.split("/")[0])+" | "+r(f.formatWeek),1)):c("",!0)]),e("td",null,[f.formatTime?(o(),i("span",ue,r(f.formatTime),1)):c("",!0)]),e("td",null,r(f.locale),1),e("td",null,r(f.title),1),e("td",null,[f.desc?(o(),i("span",{key:0,innerHTML:x(bt)(f.desc)},null,8,de)):c("",!0)])],40,ie)),[[S,p[f.title||"Sem título"]]])),128))])],4)]))),128))])):c("",!0)],64))])}}},ye=it(ce,[["__scopeId","data-v-da6b6ea5"]]);export{ye as default};
