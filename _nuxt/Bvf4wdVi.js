import{L as at}from"./mWqJaE0w.js";import{_ as ot,u as it,r as x,y as F,h as m,f as U,z as G,c as i,A as rt,l as h,F as y,a as e,p,n as C,t as r,i as f,v as w,B as A,k,I as N,e as D,g as ut,R as T,m as dt,X as ct,C as pt,o,S as vt,D as ft,E as bt}from"./E2GUTADI.js";import{d as mt}from"./BcZQbp_F.js";const yt={class:"tabs-container print-hide"},gt={class:"tabs justify-end","aria-label":"Tabs",role:"tablist","aria-orientation":"horizontal"},kt=["aria-selected"],_t={class:"badge"},ht=["aria-selected"],Ct={class:"badge"},At=["aria-selected"],St={class:"tab-content"},xt={id:"tab-content-lista",role:"tabpanel"},wt={class:"text-center"},Dt={key:0},Lt={key:1},Vt={key:2},Tt={key:3},$t={key:4},Ot={id:"tab-content-filters",role:"tabpanel"},Et={class:"content"},It={class:"form-inline"},Rt={class:"form-group"},jt={class:"row"},qt={class:"form-group"},zt={class:"row"},Bt=["value"],Mt={class:"form-group"},Ft={class:"row"},Ut=["value"],Gt={class:"form-group"},Nt={class:"flex gap-xs"},Pt={class:"form-group"},Ht={class:"flex gap-xs"},Wt={class:"form-group",style:{"align-items":"flex-start"}},Xt=["id","value"],Yt=["for"],Jt={class:"form-group",style:{"text-align":"right"}},Kt=["disabled"],Qt={class:"form-inline",style:{gap:"1rem","margin-top":"1rem"}},Zt={id:"tab-content-print",role:"tabpanel"},te={class:"a4 print-hide"},ee={class:"settings-list"},se={class:"settings-list"},le=["onClick"],ne={key:0,class:"print-page print-layout"},ae={class:"table-wrapper"},oe={colspan:"5",class:"text-center",style:{"text-transform":"uppercase"}},ie=["onDblclick"],re={key:0,class:"nowrap"},ue={key:0},de=["innerHTML"],ce={__name:"calendar",setup(pe){ct(n=>({"5fa43382":S.value}));const{lista:g}=it(),P=ut(),H=dt(),d=x("lista"),$=x(!1),S=x(1),l=F({search:"",title:"",locale:"",date:"",start:"",end:"",calendars:[]}),v=F({}),O=x([]),W=m(()=>({fontSize:`${S.value}rem`})),E=n=>n?.replace(/-$/,"").trim(),L=n=>{if(!n)return"";const t=n.split("T")[0];return t?t.split("-").reverse().join("/"):""},V=(n,t)=>Array.from(new Set(n.map(a=>a[t]).filter(a=>typeof a=="string"&&a.trim()))),X=m(()=>V(b.value,"title")),Y=m(()=>V(b.value,"locale")),J=m(()=>V(g.allEvents,"list")),K=()=>{const n=P.query||{};["search","title","locale","date","start","end"].forEach(c=>{n[c]!==void 0&&(l[c]=n[c])}),n.calendars&&(l.calendars=Array.isArray(n.calendars)?n.calendars:n.calendars.split(",").filter(Boolean));const{today:a,future:s}=T();l.start||(l.start=a),l.end||(l.end=s)},I=mt(()=>{const n=Object.fromEntries(Object.entries(l).filter(([t,a])=>t==="calendars"?a.length:a!==""&&a!=null).map(([t,a])=>Array.isArray(a)?[t,a.join(",")]:[t,a]));H.replace({query:n})},200),Q=()=>{I()};U(()=>{K()}),G(l,I,{deep:!0});function _(n){if(n==="calendars")l.calendars=[];else if(n==="date"){l.date="";const{today:t,future:a}=T();l.start=t,l.end=a}else if(n==="start"||n==="end"){const{today:t,future:a}=T();l.start=t,l.end=a}else l[n]=""}const b=m(()=>{const n=pt(g.allEvents||[],l);return Array.from(new Set(n.map(a=>a.id))).map(a=>n.find(s=>s.id===a))}),Z=m(()=>{let n=0;return l.search&&n++,l.title&&n++,l.locale&&n++,l.date&&n++,l.calendars&&l.calendars.length>0&&n++,n}),tt=()=>{d.value="lista",setTimeout(()=>{window.print()},1e3)},R=m(()=>{if(!b.value||!b.value.length)return[];const n=b.value.filter(a=>!["AVISOS À IRMANDADE","NOVOS SERVOS PARA O MINISTÉRIO"].includes(a.title)),t=new Map;for(const a of n||[]){if(!a.date)continue;const s=new Date(a.date),c=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}`,u=s.toLocaleDateString("pt-BR",{month:"long",year:"numeric"});t.has(c)||t.set(c,{month:u,items:[]}),t.get(c).items.push(a)}return Array.from(t.entries()).sort(([a],[s])=>a.localeCompare(s)).map(([a,{month:s,items:c}])=>({month:s,items:c.slice().sort((u,M)=>u.onDate-M.onDate)}))}),j=m(()=>{const n={};return b.value.forEach(t=>{const a=t.title||"Sem título";(n[a]||=[]).push(t)}),Object.keys(n).map(t=>({title:t}))}),q=()=>{const n=Array.from(new Set(b.value.map(t=>t.title||"Sem título")));O.value=n},z=()=>{if(!j.value)return;const n=j.value.map(t=>t.title);n.forEach(t=>{t in v||(v[t]=!0)});for(const t in v)n.includes(t)||(v[t]=!1)};U(()=>{q(),z()}),G(b,()=>{q(),z()});const et=n=>{d.value="print",v[n]=!v[n]},B=m(()=>Object.values(v).length>0&&Object.values(v).every(Boolean)),st=n=>{for(const t in v)v[t]=n},lt=m(()=>Object.values(v).filter(Boolean).length),nt=n=>{const t=`https://www.google.com/calendar/event?eid=${n.htmlLink}`;window.open(t,"_blank")};return(n,t)=>{const a=at;return o(),i("div",null,[h(g).loading?(o(),rt(a,{key:0})):(o(),i(y,{key:1},[e("div",yt,[e("nav",gt,[e("span",{id:"tab-filters","aria-selected":d.value==="filters",role:"tab",type:"button",class:C(["tab",{active:d.value==="filters"}]),style:{position:"relative"},onClick:t[0]||(t[0]=s=>d.value="filters")},[e("span",_t,r(Z.value),1),t[18]||(t[18]=e("i",{class:"la la-filter z-10"},null,-1))],10,kt),e("span",{id:"tab-print","aria-selected":d.value==="print",role:"tab",type:"button",class:C(["tab",{active:d.value==="print"}]),onClick:t[1]||(t[1]=s=>d.value="print")},[e("span",Ct,r(lt.value),1),t[19]||(t[19]=e("i",{class:"la la-print"},null,-1))],10,ht),e("span",{id:"tab-lista","aria-selected":d.value==="lista",role:"tab",type:"button",class:C(["tab",{active:d.value==="lista"}]),onClick:t[2]||(t[2]=s=>d.value="lista")}," Calendário ",10,At)])]),e("div",St,[f(e("div",xt,[e("div",wt,[t[20]||(t[20]=e("div",null,"CALENDÁRIO",-1)),l.calendars.length?(o(),i("div",Dt,[e("b",null,r(l.calendars.map(E).join(", ")),1)])):p("",!0),l.locale?(o(),i("span",Lt,[e("b",null,r(E(l.locale)),1)])):p("",!0),l.date?(o(),i("span",Vt," Data: "+r(L(l.date)),1)):p("",!0),!l.date&&(l.start||l.end)?(o(),i("div",Tt," Período: "+r(L(l.start))+" à "+r(L(l.end)),1)):p("",!0),l.search?(o(),i("div",$t,r(l.search),1)):p("",!0)])],512),[[w,d.value==="lista"]]),f(e("div",Ot,[e("div",Et,[e("div",It,[e("div",null,[e("div",Rt,[t[21]||(t[21]=e("label",{for:"search"},"Pesquisar",-1)),e("div",jt,[f(e("input",{id:"search","onUpdate:modelValue":t[3]||(t[3]=s=>l.search=s),type:"text",placeholder:"Buscar itens..."},null,512),[[A,l.search]]),l.search?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar pesquisa",type:"button",onClick:t[4]||(t[4]=s=>_("search"))}," × ")):p("",!0)])]),e("div",qt,[t[23]||(t[23]=e("label",{for:"title"},"Título",-1)),e("div",zt,[f(e("select",{id:"title","onUpdate:modelValue":t[5]||(t[5]=s=>l.title=s)},[t[22]||(t[22]=e("option",{value:""},"Todos os títulos",-1)),(o(!0),i(y,null,k(X.value,s=>(o(),i("option",{key:s,value:s},r(s),9,Bt))),128))],512),[[N,l.title]]),l.title?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar título",type:"button",onClick:t[6]||(t[6]=s=>_("title"))}," × ")):p("",!0)])]),e("div",Mt,[t[25]||(t[25]=e("label",{for:"locale"},"Local",-1)),e("div",Ft,[f(e("select",{id:"locale","onUpdate:modelValue":t[7]||(t[7]=s=>l.locale=s)},[t[24]||(t[24]=e("option",{value:""},"Todos os locais",-1)),(o(!0),i(y,null,k(Y.value,s=>(o(),i("option",{key:s,value:s},r(s),9,Ut))),128))],512),[[N,l.locale]]),l.locale?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar local",type:"button",onClick:t[8]||(t[8]=s=>_("locale"))}," × ")):p("",!0)])]),e("div",Gt,[t[26]||(t[26]=e("label",{for:"date"},"Data",-1)),e("div",Nt,[f(e("input",{id:"date","onUpdate:modelValue":t[9]||(t[9]=s=>l.date=s),type:"date"},null,512),[[A,l.date]]),l.date?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar data",type:"button",onClick:t[10]||(t[10]=s=>_("date"))}," × ")):p("",!0)])]),e("div",Pt,[t[27]||(t[27]=e("label",null,"Intervalo de Datas",-1)),e("div",Ht,[f(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>l.start=s),type:"date"},null,512),[[A,l.start]]),f(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>l.end=s),type:"date"},null,512),[[A,l.end]]),l.start||l.end?(o(),i("button",{key:0,class:"btn-clear","aria-label":"Limpar datas",type:"button",onClick:t[13]||(t[13]=s=>_("date"))}," × ")):p("",!0)])])]),e("div",null,[e("div",Wt,[t[28]||(t[28]=e("label",null,"Agendas",-1)),e("div",null,[(o(!0),i(y,null,k(J.value,s=>(o(),i("div",{key:s},[f(e("input",{id:"cat-"+s,"onUpdate:modelValue":t[14]||(t[14]=c=>l.calendars=c),type:"checkbox",value:s,style:{margin:"5px 5px 0 0"}},null,8,Xt),[[vt,l.calendars]]),e("label",{for:"cat-"+s,style:{"margin-bottom":"0"}},r(s),9,Yt)]))),128))])]),e("div",Jt,[t[29]||(t[29]=e("label",null,null,-1)),e("button",{class:"success",disabled:$.value||h(g).loading,onClick:t[15]||(t[15]=s=>Q())},r($.value||h(g).loading?"Atualizando...":"Aplicar"),9,Kt)])])]),e("div",Qt,[e("span",null,[t[30]||(t[30]=e("i",{class:"la la-calendar-check"},null,-1)),D(" "+r(h(g)?.calendars?.length||0),1)]),e("span",null,[t[31]||(t[31]=e("i",{class:"la la-tasks"},null,-1)),D(" "+r(Array.isArray(b.value)?b.value.length:0),1)])])])],512),[[w,d.value==="filters"]]),f(e("div",Zt,[e("div",{class:"text-center flex col items-center gap-4"},[t[33]||(t[33]=e("b",{class:"mb-4 p"},"Ajustes de impressão:",-1)),e("div",{class:"p"},[e("button",{class:"success",onClick:tt},t[32]||(t[32]=[e("i",{class:"la la-print"},null,-1),D(" Imprimir ",-1)]))])]),e("div",te,[e("div",ee,[t[34]||(t[34]=e("b",null,"Tamanho da Fonte",-1)),f(e("input",{type:"range","onUpdate:modelValue":t[16]||(t[16]=s=>S.value=s),min:"0.8",max:"1.6",step:"0.1"},null,512),[[A,S.value]])]),e("div",se,[t[35]||(t[35]=e("b",null,"Lista",-1)),e("div",null,[e("i",{class:C(["la",B.value?"la-toggle-on":"la-toggle-off"]),title:"Ocultar todos",onClick:t[17]||(t[17]=s=>st(!B.value))},null,2)])]),(o(!0),i(y,null,k(O.value,s=>(o(),i("div",{key:s,class:"settings-list print-hide",onClick:c=>et(s)},[D(r(s)+" ",1),e("i",{class:C(["la",v[s]?"la-toggle-on":"la-toggle-off"]),title:"Alterar visibilidade"},null,2)],8,le))),128))])],512),[[w,d.value==="print"]])]),R.value.length?(o(),i("div",ne,[(o(!0),i(y,null,k(R.value,({month:s,items:c})=>(o(),i("div",{key:s,class:"month-section"},[e("div",ae,[e("table",{style:ft(W.value)},[e("thead",null,[e("tr",null,[e("th",oe,r(s),1)])]),e("tbody",null,[(o(!0),i(y,null,k(c,u=>f((o(),i("tr",{key:u.id,onDblclick:M=>nt(u)},[e("td",null,[u.formatDate?(o(),i("span",re,r(u.formatDate.split("/")[0])+" | "+r(u.formatWeek),1)):p("",!0)]),e("td",null,[u.formatTime?(o(),i("span",ue,r(u.formatTime),1)):p("",!0)]),e("td",null,r(u.locale),1),e("td",null,r(u.title),1),e("td",null,[u.desc?(o(),i("span",{key:0,innerHTML:h(bt)(u.desc)},null,8,de)):p("",!0)])],40,ie)),[[w,v[u.title||"Sem título"]]])),128))])],4)])]))),128))])):p("",!0)],64))])}}},me=ot(ce,[["__scopeId","data-v-fbfe61c2"]]);export{me as default};
